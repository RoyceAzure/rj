2025-01-23 07:26:40.939 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 2
2025-01-23 07:26:45.939 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b2e7bff6 開始消費隊列 full_backtest
2025-01-23 07:26:45.939 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b2e7bff6 線程已啟動
2025-01-23 07:26:45.941 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_1f0f9af5 開始消費隊列 pre_process_stock_data
2025-01-23 07:26:45.941 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_1f0f9af5 線程已啟動
2025-01-23 07:26:45.941 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b2e7bff6 收到消息，開始解析
2025-01-23 07:26:45.942 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_cebac63d 開始消費隊列 back_testing
2025-01-23 07:26:45.942 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_cebac63d 線程已啟動
2025-01-23 07:26:45.944 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b2e7bff6 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-01-23 07:26:45.947 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b2e7bff6 收到消息，開始解析
2025-01-23 07:26:45.949 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b2e7bff6 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-01-23 07:26:45.950 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b2e7bff6 收到消息，開始解析
2025-01-23 07:26:45.952 [INFO] [python_ana_process_manager] id=UUID('ce96b775-43bc-4a05-bfed-7f2e86cdbd05') created_at=datetime.datetime(2025, 1, 23, 7, 22, 22, 464425) updated_at=datetime.datetime(2025, 1, 23, 7, 22, 22, 464425) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:26:45.953 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b2e7bff6 解析後消息為: id=UUID('ce96b775-43bc-4a05-bfed-7f2e86cdbd05') created_at=datetime.datetime(2025, 1, 23, 7, 22, 22, 464425) updated_at=datetime.datetime(2025, 1, 23, 7, 22, 22, 464425) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:26:47.956 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:26:51.005 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:27:01.067 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:27:01.609 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:27:02.900 [INFO] [python_ana_process_manager] Current Spark memory usage: 627.78MB
2025-01-23 07:27:02.900 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:27:02.901 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:27:03.526 [INFO] [python_ana_process_manager] 清理其他資源
2025-01-23 07:27:08.528 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:27:08.528 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:27:11.447 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:27:17.006 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:27:17.510 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:27:17.537 [INFO] [python_ana_process_manager] 提交任務 d5d2ee93-0cff-4659-8b96-fd2809ec5763: _muti_process_run_test
2025-01-23 07:27:23.493 [INFO] [python_ana_trader] 任務 d5d2ee93-0cff-4659-8b96-fd2809ec5763 完成，執行時間: 4.95秒
2025-01-23 07:27:17.543 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b2e7bff6 收到消息，開始解析
2025-01-23 07:27:17.544 [INFO] [python_ana_process_manager] id=UUID('ef067ed2-1e28-4cdb-b6f6-227b18bc4a02') created_at=datetime.datetime(2025, 1, 23, 7, 22, 22, 834242) updated_at=datetime.datetime(2025, 1, 23, 7, 22, 22, 834242) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:27:17.546 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b2e7bff6 解析後消息為: id=UUID('ef067ed2-1e28-4cdb-b6f6-227b18bc4a02') created_at=datetime.datetime(2025, 1, 23, 7, 22, 22, 834242) updated_at=datetime.datetime(2025, 1, 23, 7, 22, 22, 834242) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:27:19.205 [INFO] [python_ana_process_manager] Current Spark memory usage: 438.62MB
2025-01-23 07:27:19.206 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:27:19.206 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:27:19.732 [INFO] [python_ana_process_manager] 清理其他資源
2025-01-23 07:27:23.497 [INFO] [python_ana_process_manager] 任務 d5d2ee93-0cff-4659-8b96-fd2809ec5763 完成
2025-01-23 07:27:23.498 [INFO] [python_ana_process_manager] 任務 d5d2ee93-0cff-4659-8b96-fd2809ec5763 完成，執行時間: 5.96秒
2025-01-23 07:27:24.733 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:27:24.733 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:27:27.901 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:27:38.624 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:27:38.996 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:27:40.280 [INFO] [python_ana_process_manager] Current Spark memory usage: 768.16MB
2025-01-23 07:27:40.281 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:27:40.281 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:27:40.943 [INFO] [python_ana_process_manager] 清理其他資源
2025-01-23 07:27:45.946 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:27:45.946 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:27:48.852 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:27:54.127 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:27:54.367 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:27:54.395 [INFO] [python_ana_process_manager] 提交任務 f3b6b7c6-3d29-4d4c-bcaa-e952e6564ad0: _muti_process_run_test
2025-01-23 07:28:00.314 [INFO] [python_ana_trader] 任務 f3b6b7c6-3d29-4d4c-bcaa-e952e6564ad0 完成，執行時間: 4.94秒
2025-01-23 07:27:54.402 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b2e7bff6 收到消息，開始解析
2025-01-23 07:27:54.404 [INFO] [python_ana_process_manager] id=UUID('d88ded70-041b-42fa-bab1-f0deb507a61d') created_at=datetime.datetime(2025, 1, 23, 7, 22, 52, 577221) updated_at=datetime.datetime(2025, 1, 23, 7, 22, 52, 577221) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:27:54.406 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b2e7bff6 解析後消息為: id=UUID('d88ded70-041b-42fa-bab1-f0deb507a61d') created_at=datetime.datetime(2025, 1, 23, 7, 22, 52, 577221) updated_at=datetime.datetime(2025, 1, 23, 7, 22, 52, 577221) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:27:56.081 [INFO] [python_ana_process_manager] Current Spark memory usage: 526.11MB
2025-01-23 07:27:56.081 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:27:56.082 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:27:56.748 [INFO] [python_ana_process_manager] 清理其他資源
2025-01-23 07:28:00.317 [INFO] [python_ana_process_manager] 任務 f3b6b7c6-3d29-4d4c-bcaa-e952e6564ad0 完成
2025-01-23 07:28:00.318 [INFO] [python_ana_process_manager] 任務 f3b6b7c6-3d29-4d4c-bcaa-e952e6564ad0 完成，執行時間: 5.92秒
2025-01-23 07:28:01.749 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:28:01.749 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:28:04.791 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:28:15.680 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:28:15.820 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:28:17.306 [INFO] [python_ana_process_manager] Current Spark memory usage: 806.24MB
2025-01-23 07:28:17.306 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:28:17.307 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:28:18.060 [INFO] [python_ana_process_manager] 清理其他資源
2025-01-23 07:28:23.062 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:28:23.062 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:28:26.085 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:28:31.505 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:28:32.057 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:28:32.086 [INFO] [python_ana_process_manager] 提交任務 88523eef-7602-4671-8aeb-d79cd90bf1cf: _muti_process_run_test
2025-01-23 07:28:32.097 [INFO] [python_ana_trader] 任務 88523eef-7602-4671-8aeb-d79cd90bf1cf 完成，執行時間: 0.01秒
2025-01-23 07:28:32.100 [INFO] [python_ana_process_manager] 任務 88523eef-7602-4671-8aeb-d79cd90bf1cf 完成
2025-01-23 07:28:32.100 [INFO] [python_ana_process_manager] 任務 88523eef-7602-4671-8aeb-d79cd90bf1cf 完成，執行時間: 0.01秒
2025-01-23 07:30:04.520 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b2e7bff6 收到消息，開始解析
2025-01-23 07:30:04.523 [INFO] [python_ana_process_manager] id=UUID('d93eef97-9403-420c-b832-6997d18cbef4') created_at=datetime.datetime(2025, 1, 23, 7, 30, 4, 516168) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 4, 516168) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:30:04.523 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b2e7bff6 解析後消息為: id=UUID('d93eef97-9403-420c-b832-6997d18cbef4') created_at=datetime.datetime(2025, 1, 23, 7, 30, 4, 516168) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 4, 516168) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:30:05.952 [INFO] [python_ana_process_manager] Current Spark memory usage: 439.88MB
2025-01-23 07:30:05.952 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:30:05.953 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:30:06.523 [INFO] [python_ana_process_manager] 清理其他資源
2025-01-23 07:30:11.526 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:30:11.526 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:30:14.473 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:30:15.989 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_b2e7bff6
2025-01-23 07:30:15.989 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b2e7bff6 正在停止
2025-01-23 07:30:15.989 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b2e7bff6 已完全停止
2025-01-23 07:30:15.989 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_1f0f9af5
2025-01-23 07:30:15.990 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_1f0f9af5 正在停止
2025-01-23 07:30:15.990 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_1f0f9af5 已完全停止
2025-01-23 07:30:15.990 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_cebac63d
2025-01-23 07:30:15.990 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_cebac63d 正在停止
2025-01-23 07:30:15.990 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_cebac63d 已完全停止
2025-01-23 07:30:16.215 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:30:18.238 [ERROR] [python_ana_process_manager] Unexpected error during cleanup: [WinError 10061] 無法連線，因為目標電腦拒絕連線。
2025-01-23 07:30:18.238 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b2e7bff6 任務失敗: Failed to load data: An error occurred while calling o68.jdbc
2025-01-23 07:30:35.929 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-01-23 07:30:40.921 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_584fbdf9 開始消費隊列 full_backtest
2025-01-23 07:30:40.921 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_584fbdf9 線程已啟動
2025-01-23 07:30:40.922 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_50d84266 開始消費隊列 pre_process_stock_data
2025-01-23 07:30:40.922 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_50d84266 線程已啟動
2025-01-23 07:30:40.923 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_c2f43422 開始消費隊列 back_testing
2025-01-23 07:30:40.923 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_c2f43422 線程已啟動
2025-01-23 07:30:45.929 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:30:45.932 [INFO] [python_ana_process_manager] id=UUID('d93eef97-9403-420c-b832-6997d18cbef4') created_at=datetime.datetime(2025, 1, 23, 7, 30, 4, 516168) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 18, 238272) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Failed to load data: An error occurred while calling o68.jdbc' sink_params=None set_params=None
2025-01-23 07:30:45.933 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('d93eef97-9403-420c-b832-6997d18cbef4') created_at=datetime.datetime(2025, 1, 23, 7, 30, 4, 516168) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 18, 238272) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Failed to load data: An error occurred while calling o68.jdbc' sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:30:47.691 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:30:50.571 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:31:00.819 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:31:01.152 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:31:02.749 [INFO] [python_ana_process_manager] Current Spark memory usage: 590.04MB
2025-01-23 07:31:02.750 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:31:02.750 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:31:05.307 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:31:05.307 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:31:05.307 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:31:08.190 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:31:13.856 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:31:14.173 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:31:14.206 [INFO] [python_ana_process_manager] 提交任務 2c616f5c-86c6-40d8-b67a-ec39bb326c03: _muti_process_run_test
2025-01-23 07:31:20.145 [INFO] [python_ana_trader] 任務 2c616f5c-86c6-40d8-b67a-ec39bb326c03 完成，執行時間: 4.95秒
2025-01-23 07:31:14.213 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:31:14.214 [INFO] [python_ana_process_manager] id=UUID('e738d608-771b-4cc2-bf3b-e23a764e2579') created_at=datetime.datetime(2025, 1, 23, 7, 30, 4, 840592) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 4, 840592) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:31:14.216 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('e738d608-771b-4cc2-bf3b-e23a764e2579') created_at=datetime.datetime(2025, 1, 23, 7, 30, 4, 840592) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 4, 840592) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:31:15.689 [INFO] [python_ana_process_manager] Current Spark memory usage: 517.23MB
2025-01-23 07:31:15.689 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:31:15.689 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:31:18.272 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:31:18.273 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:31:18.273 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:31:20.148 [INFO] [python_ana_process_manager] 任務 2c616f5c-86c6-40d8-b67a-ec39bb326c03 完成
2025-01-23 07:31:20.148 [INFO] [python_ana_process_manager] 任務 2c616f5c-86c6-40d8-b67a-ec39bb326c03 完成，執行時間: 5.94秒
2025-01-23 07:31:21.169 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:31:31.256 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:31:31.663 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:31:32.945 [INFO] [python_ana_process_manager] Current Spark memory usage: 710.70MB
2025-01-23 07:31:32.946 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:31:32.946 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:31:35.588 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:31:35.588 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:31:35.588 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:31:38.488 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:31:43.773 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:31:43.954 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:31:43.982 [INFO] [python_ana_process_manager] 提交任務 c46f82d3-56aa-481e-b3c6-e865ea9da581: _muti_process_run_test
2025-01-23 07:31:49.901 [INFO] [python_ana_trader] 任務 c46f82d3-56aa-481e-b3c6-e865ea9da581 完成，執行時間: 4.95秒
2025-01-23 07:31:43.987 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:31:43.988 [INFO] [python_ana_process_manager] id=UUID('afd43bb1-deaa-4e16-9ac5-eed4f7a8b57f') created_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 154514) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 154514) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:31:43.990 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('afd43bb1-deaa-4e16-9ac5-eed4f7a8b57f') created_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 154514) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 154514) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:31:45.315 [INFO] [python_ana_process_manager] Current Spark memory usage: 506.01MB
2025-01-23 07:31:45.315 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:31:45.315 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:31:47.944 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:31:47.944 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:31:47.944 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:31:49.904 [INFO] [python_ana_process_manager] 任務 c46f82d3-56aa-481e-b3c6-e865ea9da581 完成
2025-01-23 07:31:49.904 [INFO] [python_ana_process_manager] 任務 c46f82d3-56aa-481e-b3c6-e865ea9da581 完成，執行時間: 5.92秒
2025-01-23 07:31:50.974 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:32:01.111 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:32:01.449 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:32:02.835 [INFO] [python_ana_process_manager] Current Spark memory usage: 776.02MB
2025-01-23 07:32:02.842 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:32:02.842 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:32:05.484 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:32:05.484 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:32:05.484 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:32:08.364 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:32:13.745 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:32:13.831 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:32:13.858 [INFO] [python_ana_process_manager] 提交任務 e0ebb5e0-dba6-44a9-9d3c-83e033c6872e: _muti_process_run_test
2025-01-23 07:32:19.785 [INFO] [python_ana_trader] 任務 e0ebb5e0-dba6-44a9-9d3c-83e033c6872e 完成，執行時間: 4.96秒
2025-01-23 07:32:13.863 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:32:13.865 [INFO] [python_ana_process_manager] id=UUID('4d583940-a650-46ee-ab25-9204af2638a5') created_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 503783) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 503783) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:32:13.867 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('4d583940-a650-46ee-ab25-9204af2638a5') created_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 503783) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 503783) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:32:15.532 [INFO] [python_ana_process_manager] Current Spark memory usage: 502.02MB
2025-01-23 07:32:15.532 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:32:15.533 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:32:18.069 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:32:18.069 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:32:18.069 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:32:19.788 [INFO] [python_ana_process_manager] 任務 e0ebb5e0-dba6-44a9-9d3c-83e033c6872e 完成
2025-01-23 07:32:19.788 [INFO] [python_ana_process_manager] 任務 e0ebb5e0-dba6-44a9-9d3c-83e033c6872e 完成，執行時間: 5.93秒
2025-01-23 07:32:21.003 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:32:31.076 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:32:31.515 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:32:32.791 [INFO] [python_ana_process_manager] Current Spark memory usage: 588.17MB
2025-01-23 07:32:32.791 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:32:32.792 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:32:35.392 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:32:35.392 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:32:35.392 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:32:38.334 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:32:43.547 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:32:43.811 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:32:43.838 [INFO] [python_ana_process_manager] 提交任務 3e58f916-6e8b-41b7-aaaa-d83674d05592: _muti_process_run_test
2025-01-23 07:32:43.850 [INFO] [python_ana_trader] 任務 3e58f916-6e8b-41b7-aaaa-d83674d05592 完成，執行時間: 0.01秒
2025-01-23 07:32:43.843 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:32:43.845 [INFO] [python_ana_process_manager] id=UUID('57af4cfe-980e-4f63-bc2c-861838acb856') created_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 837996) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 837996) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:32:43.846 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('57af4cfe-980e-4f63-bc2c-861838acb856') created_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 837996) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 5, 837996) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:32:43.884 [INFO] [python_ana_process_manager] 任務 3e58f916-6e8b-41b7-aaaa-d83674d05592 完成
2025-01-23 07:32:43.903 [INFO] [python_ana_process_manager] 任務 3e58f916-6e8b-41b7-aaaa-d83674d05592 完成，執行時間: 0.05秒
2025-01-23 07:32:45.138 [INFO] [python_ana_process_manager] Current Spark memory usage: 508.83MB
2025-01-23 07:32:45.138 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:32:45.139 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:32:47.727 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:32:47.727 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:32:47.727 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:32:50.665 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:33:01.664 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:33:02.183 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:33:03.380 [INFO] [python_ana_process_manager] Current Spark memory usage: 687.53MB
2025-01-23 07:33:03.380 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:33:03.380 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:33:06.066 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:33:06.066 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:33:06.066 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:33:09.106 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:33:14.034 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:33:14.578 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:33:14.606 [INFO] [python_ana_process_manager] 提交任務 71ffe38f-ae10-42dd-9fbb-c5f389f5704c: _muti_process_run_test
2025-01-23 07:33:14.619 [INFO] [python_ana_trader] 任務 71ffe38f-ae10-42dd-9fbb-c5f389f5704c 完成，執行時間: 0.01秒
2025-01-23 07:33:14.611 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:33:14.613 [INFO] [python_ana_process_manager] id=UUID('5818c07e-e95f-4e26-97e1-634f011200fa') created_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 99352) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 99352) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:33:14.615 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('5818c07e-e95f-4e26-97e1-634f011200fa') created_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 99352) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 99352) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:33:14.659 [INFO] [python_ana_process_manager] 任務 71ffe38f-ae10-42dd-9fbb-c5f389f5704c 完成
2025-01-23 07:33:14.687 [INFO] [python_ana_process_manager] 任務 71ffe38f-ae10-42dd-9fbb-c5f389f5704c 完成，執行時間: 0.05秒
2025-01-23 07:33:15.949 [INFO] [python_ana_process_manager] Current Spark memory usage: 522.33MB
2025-01-23 07:33:15.949 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:33:15.950 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:33:18.547 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:33:18.547 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:33:18.547 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:33:21.398 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:33:30.754 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:33:30.913 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:33:31.579 [INFO] [python_ana_process_manager] Current Spark memory usage: 807.98MB
2025-01-23 07:33:31.579 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:33:31.579 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:33:34.034 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:33:34.034 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:33:34.035 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:33:36.972 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:33:41.956 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:33:42.456 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:33:42.482 [INFO] [python_ana_process_manager] 提交任務 900928e7-1f4b-4fd9-bd8e-1a03725c5e28: _muti_process_run_test
2025-01-23 07:33:42.495 [INFO] [python_ana_trader] 任務 900928e7-1f4b-4fd9-bd8e-1a03725c5e28 完成，執行時間: 0.01秒
2025-01-23 07:33:42.488 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:33:42.490 [INFO] [python_ana_process_manager] id=UUID('006be3dd-9b91-445e-807c-8a481b7e05fa') created_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 404508) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 404508) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:33:42.491 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('006be3dd-9b91-445e-807c-8a481b7e05fa') created_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 404508) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 404508) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:33:42.560 [INFO] [python_ana_process_manager] 任務 900928e7-1f4b-4fd9-bd8e-1a03725c5e28 完成
2025-01-23 07:33:42.604 [INFO] [python_ana_process_manager] 任務 900928e7-1f4b-4fd9-bd8e-1a03725c5e28 完成，執行時間: 0.08秒
2025-01-23 07:33:43.778 [INFO] [python_ana_process_manager] Current Spark memory usage: 506.69MB
2025-01-23 07:33:43.778 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:33:43.779 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:33:46.480 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:33:46.480 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:33:46.481 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:33:49.184 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:33:58.418 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:33:58.695 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:33:59.775 [INFO] [python_ana_process_manager] Current Spark memory usage: 739.40MB
2025-01-23 07:33:59.776 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:33:59.776 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:34:02.341 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:34:02.341 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:34:02.341 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:34:05.100 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:34:09.953 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:34:10.071 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:34:10.099 [INFO] [python_ana_process_manager] 提交任務 cac185df-5ab4-47d9-88d4-261606940548: _muti_process_run_test
2025-01-23 07:34:10.112 [INFO] [python_ana_trader] 任務 cac185df-5ab4-47d9-88d4-261606940548 完成，執行時間: 0.01秒
2025-01-23 07:34:10.105 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:34:10.107 [INFO] [python_ana_process_manager] id=UUID('5ac094f7-2293-4128-adef-43c215ee94a8') created_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 686727) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 686727) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:34:10.108 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('5ac094f7-2293-4128-adef-43c215ee94a8') created_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 686727) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 6, 686727) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:34:10.148 [INFO] [python_ana_process_manager] 任務 cac185df-5ab4-47d9-88d4-261606940548 完成
2025-01-23 07:34:10.187 [INFO] [python_ana_process_manager] 任務 cac185df-5ab4-47d9-88d4-261606940548 完成，執行時間: 0.05秒
2025-01-23 07:34:11.364 [INFO] [python_ana_process_manager] Current Spark memory usage: 507.84MB
2025-01-23 07:34:11.364 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:34:11.365 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:34:13.902 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:34:13.902 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:34:13.902 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:34:16.617 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:34:25.850 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:34:26.132 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:34:27.295 [INFO] [python_ana_process_manager] Current Spark memory usage: 796.41MB
2025-01-23 07:34:27.295 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:34:27.295 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:34:29.745 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:34:29.745 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:34:29.745 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:34:32.453 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:34:37.446 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:34:37.913 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:34:37.946 [INFO] [python_ana_process_manager] 提交任務 7b6e16bc-d9a4-4287-9f15-b8a0c8939982: _muti_process_run_test
2025-01-23 07:34:37.958 [INFO] [python_ana_trader] 任務 7b6e16bc-d9a4-4287-9f15-b8a0c8939982 完成，執行時間: 0.01秒
2025-01-23 07:34:37.953 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:34:37.956 [INFO] [python_ana_process_manager] id=UUID('9ae98252-9ba3-4503-9527-520ae68a0f17') created_at=datetime.datetime(2025, 1, 23, 7, 30, 7, 16841) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 7, 16841) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:34:37.957 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('9ae98252-9ba3-4503-9527-520ae68a0f17') created_at=datetime.datetime(2025, 1, 23, 7, 30, 7, 16841) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 7, 16841) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:34:38.022 [INFO] [python_ana_process_manager] 任務 7b6e16bc-d9a4-4287-9f15-b8a0c8939982 完成
2025-01-23 07:34:38.038 [INFO] [python_ana_process_manager] 任務 7b6e16bc-d9a4-4287-9f15-b8a0c8939982 完成，執行時間: 0.08秒
2025-01-23 07:34:38.913 [INFO] [python_ana_process_manager] Current Spark memory usage: 526.55MB
2025-01-23 07:34:38.914 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:34:38.914 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:34:41.396 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:34:41.397 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:34:41.397 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:34:44.111 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:34:53.237 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:34:53.665 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:34:54.862 [INFO] [python_ana_process_manager] Current Spark memory usage: 745.82MB
2025-01-23 07:34:54.863 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:34:54.863 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:34:57.427 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:34:57.427 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:34:57.427 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:35:00.154 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:35:05.043 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:35:05.609 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:35:05.635 [INFO] [python_ana_process_manager] 提交任務 a39d5004-3dcc-4580-b91b-81e1bc00cc9f: _muti_process_run_test
2025-01-23 07:35:05.649 [INFO] [python_ana_trader] 任務 a39d5004-3dcc-4580-b91b-81e1bc00cc9f 完成，執行時間: 0.01秒
2025-01-23 07:35:05.640 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:35:05.642 [INFO] [python_ana_process_manager] id=UUID('d471fa57-1514-453c-a638-e491c4b707b7') created_at=datetime.datetime(2025, 1, 23, 7, 30, 7, 264326) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 7, 264326) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:35:05.643 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('d471fa57-1514-453c-a638-e491c4b707b7') created_at=datetime.datetime(2025, 1, 23, 7, 30, 7, 264326) updated_at=datetime.datetime(2025, 1, 23, 7, 30, 7, 264326) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:35:05.708 [INFO] [python_ana_process_manager] 任務 a39d5004-3dcc-4580-b91b-81e1bc00cc9f 完成
2025-01-23 07:35:05.728 [INFO] [python_ana_process_manager] 任務 a39d5004-3dcc-4580-b91b-81e1bc00cc9f 完成，執行時間: 0.07秒
2025-01-23 07:35:06.143 [INFO] [python_ana_process_manager] Current Spark memory usage: 511.19MB
2025-01-23 07:35:06.144 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:35:06.144 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:35:08.624 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:35:08.624 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:35:08.625 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:35:11.327 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:35:20.524 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:35:20.828 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:35:21.775 [INFO] [python_ana_process_manager] Current Spark memory usage: 731.59MB
2025-01-23 07:35:21.775 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:35:21.776 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:35:24.286 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:35:24.287 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:35:24.287 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:35:27.041 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:35:31.923 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:35:31.997 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:35:32.023 [INFO] [python_ana_process_manager] 提交任務 5c461a72-be58-47b9-b0e5-161d7bd2af0c: _muti_process_run_test
2025-01-23 07:35:32.038 [INFO] [python_ana_trader] 任務 5c461a72-be58-47b9-b0e5-161d7bd2af0c 完成，執行時間: 0.01秒
2025-01-23 07:35:32.041 [INFO] [python_ana_process_manager] 任務 5c461a72-be58-47b9-b0e5-161d7bd2af0c 完成
2025-01-23 07:35:32.042 [INFO] [python_ana_process_manager] 任務 5c461a72-be58-47b9-b0e5-161d7bd2af0c 完成，執行時間: 0.02秒
2025-01-23 07:36:41.303 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:36:41.304 [INFO] [python_ana_process_manager] id=UUID('15fc21a2-0fa2-436b-bf36-d869f03c9e25') created_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 299677) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 299677) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:36:41.306 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('15fc21a2-0fa2-436b-bf36-d869f03c9e25') created_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 299677) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 299677) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:36:42.598 [INFO] [python_ana_process_manager] Current Spark memory usage: 441.57MB
2025-01-23 07:36:42.598 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:36:42.598 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:36:45.119 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:36:45.120 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:36:45.120 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:36:47.954 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:36:57.677 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:36:58.006 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:36:59.303 [INFO] [python_ana_process_manager] Current Spark memory usage: 754.48MB
2025-01-23 07:36:59.304 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:36:59.304 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:37:01.993 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:37:01.993 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:37:01.993 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:37:04.727 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:37:09.706 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:37:10.238 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:37:10.264 [INFO] [python_ana_process_manager] 提交任務 7f498b20-1076-4dc9-8218-920dfe02677d: _muti_process_run_test
2025-01-23 07:37:10.276 [INFO] [python_ana_trader] 任務 7f498b20-1076-4dc9-8218-920dfe02677d 完成，執行時間: 0.01秒
2025-01-23 07:37:10.271 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:37:10.272 [INFO] [python_ana_process_manager] id=UUID('4d5032f6-1746-4744-8ac8-a59ba29ea58e') created_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 648710) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 648710) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:37:10.273 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('4d5032f6-1746-4744-8ac8-a59ba29ea58e') created_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 648710) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 648710) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:37:10.302 [INFO] [python_ana_process_manager] 任務 7f498b20-1076-4dc9-8218-920dfe02677d 完成
2025-01-23 07:37:10.330 [INFO] [python_ana_process_manager] 任務 7f498b20-1076-4dc9-8218-920dfe02677d 完成，執行時間: 0.04秒
2025-01-23 07:37:11.366 [INFO] [python_ana_process_manager] Current Spark memory usage: 518.22MB
2025-01-23 07:37:11.367 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:37:11.367 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:37:13.835 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:37:13.835 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:37:13.835 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:37:16.565 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:37:25.880 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:37:26.162 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:37:27.693 [INFO] [python_ana_process_manager] Current Spark memory usage: 753.61MB
2025-01-23 07:37:27.693 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:37:27.694 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:37:30.469 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:37:30.469 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:37:30.470 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:37:33.530 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:37:38.586 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:37:39.048 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:37:39.075 [INFO] [python_ana_process_manager] 提交任務 b91ba32a-f636-4484-ad8f-bb2579ffafe3: _muti_process_run_test
2025-01-23 07:37:39.086 [INFO] [python_ana_trader] 任務 b91ba32a-f636-4484-ad8f-bb2579ffafe3 完成，執行時間: 0.01秒
2025-01-23 07:37:39.080 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:37:39.082 [INFO] [python_ana_process_manager] id=UUID('2615d3c4-bf79-45fa-9a87-9719a3677b79') created_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 855666) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 855666) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:37:39.083 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('2615d3c4-bf79-45fa-9a87-9719a3677b79') created_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 855666) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 41, 855666) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:37:39.204 [INFO] [python_ana_process_manager] 任務 b91ba32a-f636-4484-ad8f-bb2579ffafe3 完成
2025-01-23 07:37:39.234 [INFO] [python_ana_process_manager] 任務 b91ba32a-f636-4484-ad8f-bb2579ffafe3 完成，執行時間: 0.13秒
2025-01-23 07:37:40.301 [INFO] [python_ana_process_manager] Current Spark memory usage: 498.96MB
2025-01-23 07:37:40.302 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:37:40.302 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:37:42.809 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:37:42.810 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:37:42.810 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:37:45.660 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:37:54.976 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:37:55.322 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:37:56.662 [INFO] [python_ana_process_manager] Current Spark memory usage: 762.02MB
2025-01-23 07:37:56.662 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:37:56.662 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:37:59.319 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:37:59.319 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:37:59.320 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:38:02.078 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:38:07.021 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:38:07.089 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:38:07.116 [INFO] [python_ana_process_manager] 提交任務 2adfb6c1-9b01-4cc5-8d92-b0fc8816cc4b: _muti_process_run_test
2025-01-23 07:38:07.128 [INFO] [python_ana_trader] 任務 2adfb6c1-9b01-4cc5-8d92-b0fc8816cc4b 完成，執行時間: 0.01秒
2025-01-23 07:38:07.124 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:38:07.126 [INFO] [python_ana_process_manager] id=UUID('ff2b4f58-0e48-488f-ae0f-0f50e45cdbbc') created_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 70269) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 70269) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:38:07.127 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('ff2b4f58-0e48-488f-ae0f-0f50e45cdbbc') created_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 70269) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 70269) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:38:07.229 [INFO] [python_ana_process_manager] 任務 2adfb6c1-9b01-4cc5-8d92-b0fc8816cc4b 完成
2025-01-23 07:38:07.274 [INFO] [python_ana_process_manager] 任務 2adfb6c1-9b01-4cc5-8d92-b0fc8816cc4b 完成，執行時間: 0.11秒
2025-01-23 07:38:08.361 [INFO] [python_ana_process_manager] Current Spark memory usage: 511.81MB
2025-01-23 07:38:08.362 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:38:08.362 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:38:10.918 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:38:10.919 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:38:10.920 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:38:13.631 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:38:22.924 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:38:23.228 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:38:24.840 [INFO] [python_ana_process_manager] Current Spark memory usage: 688.73MB
2025-01-23 07:38:24.840 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:38:24.841 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:38:27.606 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:38:27.606 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:38:27.606 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:38:30.388 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:38:35.411 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:38:35.917 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:38:35.944 [INFO] [python_ana_process_manager] 提交任務 fb4395c2-5bc8-4687-a1ab-858ee1bef446: _muti_process_run_test
2025-01-23 07:38:35.956 [INFO] [python_ana_trader] 任務 fb4395c2-5bc8-4687-a1ab-858ee1bef446 完成，執行時間: 0.01秒
2025-01-23 07:38:35.949 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:38:35.951 [INFO] [python_ana_process_manager] id=UUID('f34bb900-8e6e-46de-b127-1c085af0bab7') created_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 321294) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 321294) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:38:35.952 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('f34bb900-8e6e-46de-b127-1c085af0bab7') created_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 321294) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 321294) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:38:36.026 [INFO] [python_ana_process_manager] 任務 fb4395c2-5bc8-4687-a1ab-858ee1bef446 完成
2025-01-23 07:38:36.055 [INFO] [python_ana_process_manager] 任務 fb4395c2-5bc8-4687-a1ab-858ee1bef446 完成，執行時間: 0.08秒
2025-01-23 07:38:37.089 [INFO] [python_ana_process_manager] Current Spark memory usage: 529.81MB
2025-01-23 07:38:37.090 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:38:37.090 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:38:39.555 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:38:39.555 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:38:39.556 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:38:42.287 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:38:51.740 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:38:51.945 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:38:53.354 [INFO] [python_ana_process_manager] Current Spark memory usage: 740.09MB
2025-01-23 07:38:53.355 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:38:53.355 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:38:55.885 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:38:55.885 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:38:55.886 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:38:58.759 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:39:03.851 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:39:04.287 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:39:04.313 [INFO] [python_ana_process_manager] 提交任務 d7b48950-926d-4c62-965c-e2cbbf954fd2: _muti_process_run_test
2025-01-23 07:39:04.325 [INFO] [python_ana_trader] 任務 d7b48950-926d-4c62-965c-e2cbbf954fd2 完成，執行時間: 0.01秒
2025-01-23 07:39:04.317 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:39:04.319 [INFO] [python_ana_process_manager] id=UUID('2c762ca8-42a4-40a5-9fb7-5a5e6767d22c') created_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 548346) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 548346) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:39:04.320 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('2c762ca8-42a4-40a5-9fb7-5a5e6767d22c') created_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 548346) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 548346) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:39:04.412 [INFO] [python_ana_process_manager] 任務 d7b48950-926d-4c62-965c-e2cbbf954fd2 完成
2025-01-23 07:39:04.470 [INFO] [python_ana_process_manager] 任務 d7b48950-926d-4c62-965c-e2cbbf954fd2 完成，執行時間: 0.10秒
2025-01-23 07:39:05.382 [INFO] [python_ana_process_manager] Current Spark memory usage: 504.94MB
2025-01-23 07:39:05.383 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:39:05.383 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:39:07.887 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:39:07.887 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:39:07.887 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:39:10.653 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:39:19.997 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:39:20.266 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:39:21.318 [INFO] [python_ana_process_manager] Current Spark memory usage: 827.61MB
2025-01-23 07:39:21.319 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:39:21.319 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:39:23.904 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:39:23.904 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:39:23.905 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:39:26.739 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:39:31.716 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:39:32.277 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:39:32.301 [INFO] [python_ana_process_manager] 提交任務 a5ea370d-fa87-4e26-b6a6-500381764b90: _muti_process_run_test
2025-01-23 07:39:32.314 [INFO] [python_ana_trader] 任務 a5ea370d-fa87-4e26-b6a6-500381764b90 完成，執行時間: 0.01秒
2025-01-23 07:39:32.308 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:39:32.310 [INFO] [python_ana_process_manager] id=UUID('bbfa225e-e23c-4501-8b6f-c25cd3fb2cdf') created_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 794954) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 794954) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:39:32.311 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('bbfa225e-e23c-4501-8b6f-c25cd3fb2cdf') created_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 794954) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 42, 794954) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:39:32.418 [INFO] [python_ana_process_manager] 任務 a5ea370d-fa87-4e26-b6a6-500381764b90 完成
2025-01-23 07:39:32.453 [INFO] [python_ana_process_manager] 任務 a5ea370d-fa87-4e26-b6a6-500381764b90 完成，執行時間: 0.12秒
2025-01-23 07:39:32.983 [INFO] [python_ana_process_manager] Current Spark memory usage: 512.72MB
2025-01-23 07:39:32.986 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:39:32.986 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:39:35.458 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:39:35.458 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:39:35.459 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:39:38.389 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:39:47.913 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:39:48.490 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:39:49.896 [INFO] [python_ana_process_manager] Current Spark memory usage: 658.03MB
2025-01-23 07:39:49.897 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:39:49.897 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:39:52.897 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:39:52.897 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:39:52.898 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:39:55.779 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:40:01.077 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:40:01.319 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:40:01.350 [INFO] [python_ana_process_manager] 提交任務 aa795800-2c22-45d8-9c7f-cd5556629662: _muti_process_run_test
2025-01-23 07:40:01.365 [INFO] [python_ana_trader] 任務 aa795800-2c22-45d8-9c7f-cd5556629662 完成，執行時間: 0.01秒
2025-01-23 07:40:01.357 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:40:01.359 [INFO] [python_ana_process_manager] id=UUID('9ebfb847-e37b-42d9-88d0-87840b51f849') created_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 25292) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 25292) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:40:01.361 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('9ebfb847-e37b-42d9-88d0-87840b51f849') created_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 25292) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 25292) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:40:01.431 [INFO] [python_ana_process_manager] 任務 aa795800-2c22-45d8-9c7f-cd5556629662 完成
2025-01-23 07:40:01.461 [INFO] [python_ana_process_manager] 任務 aa795800-2c22-45d8-9c7f-cd5556629662 完成，執行時間: 0.08秒
2025-01-23 07:40:03.404 [INFO] [python_ana_process_manager] Current Spark memory usage: 504.43MB
2025-01-23 07:40:03.404 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:40:03.404 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:40:06.056 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:40:06.056 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:40:06.057 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:40:08.888 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:40:18.669 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:40:19.037 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:40:20.354 [INFO] [python_ana_process_manager] Current Spark memory usage: 646.03MB
2025-01-23 07:40:20.354 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:40:20.355 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:40:22.978 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:40:22.979 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:40:22.979 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:40:25.932 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:40:31.518 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:40:31.958 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:40:31.989 [INFO] [python_ana_process_manager] 提交任務 1d708fe8-5921-4489-a588-6957085d1b5b: _muti_process_run_test
2025-01-23 07:40:32.005 [INFO] [python_ana_trader] 任務 1d708fe8-5921-4489-a588-6957085d1b5b 完成，執行時間: 0.01秒
2025-01-23 07:40:31.995 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 收到消息，開始解析
2025-01-23 07:40:31.997 [INFO] [python_ana_process_manager] id=UUID('2c7e3178-fa4f-4755-8d51-2bd3bb747982') created_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 254998) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 254998) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:40:31.998 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_584fbdf9 解析後消息為: id=UUID('2c7e3178-fa4f-4755-8d51-2bd3bb747982') created_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 254998) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 254998) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:40:32.037 [INFO] [python_ana_process_manager] 任務 1d708fe8-5921-4489-a588-6957085d1b5b 完成
2025-01-23 07:40:32.084 [INFO] [python_ana_process_manager] 任務 1d708fe8-5921-4489-a588-6957085d1b5b 完成，執行時間: 0.05秒
2025-01-23 07:40:34.590 [INFO] [python_ana_process_manager] Current Spark memory usage: 433.46MB
2025-01-23 07:40:34.591 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:40:34.592 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:40:37.755 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:40:37.756 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:40:37.756 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:40:40.635 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:40:50.602 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:40:50.769 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:40:52.242 [INFO] [python_ana_process_manager] Current Spark memory usage: 752.50MB
2025-01-23 07:40:52.243 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:40:52.243 [INFO] [python_ana_process_manager] 確保停止所有相關的 Java 進程
2025-01-23 07:40:54.775 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:40:54.776 [INFO] [python_ana_process_manager] SparkContext successfully restarted
2025-01-23 07:40:54.776 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:40:57.676 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:41:02.886 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:41:03.198 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:41:03.224 [INFO] [python_ana_process_manager] 提交任務 102b8498-d6b8-4fb4-b8e6-586867845029: _muti_process_run_test
2025-01-23 07:41:03.236 [INFO] [python_ana_trader] 任務 102b8498-d6b8-4fb4-b8e6-586867845029 完成，執行時間: 0.01秒
2025-01-23 07:41:38.340 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-01-23 07:41:43.336 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_544c1cb2 開始消費隊列 full_backtest
2025-01-23 07:41:43.336 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_544c1cb2 線程已啟動
2025-01-23 07:41:43.338 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bf83ff44 開始消費隊列 pre_process_stock_data
2025-01-23 07:41:43.338 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bf83ff44 線程已啟動
2025-01-23 07:41:43.339 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a46566c6 開始消費隊列 back_testing
2025-01-23 07:41:43.339 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a46566c6 線程已啟動
2025-01-23 07:41:48.331 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_544c1cb2 收到消息，開始解析
2025-01-23 07:41:48.333 [INFO] [python_ana_process_manager] id=UUID('854bfaee-b139-4533-a864-b66f11b1aec0') created_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 477688) updated_at=datetime.datetime(2025, 1, 23, 7, 41, 20, 652033) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:41:48.334 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_544c1cb2 解析後消息為: id=UUID('854bfaee-b139-4533-a864-b66f11b1aec0') created_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 477688) updated_at=datetime.datetime(2025, 1, 23, 7, 41, 20, 652033) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:41:50.196 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:41:52.920 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:42:02.125 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:42:02.532 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:42:03.753 [INFO] [python_ana_process_manager] Current Spark memory usage: 735.94MB
2025-01-23 07:42:03.753 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:42:03.754 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:42:06.303 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 07:42:06.303 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:42:09.050 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:42:14.137 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:42:14.557 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:42:14.585 [INFO] [python_ana_process_manager] 提交任務 c28d9a51-1a0d-46ad-95ed-5640d5cdc89c: _muti_process_run_test
2025-01-23 07:42:20.426 [INFO] [python_ana_trader] 任務 c28d9a51-1a0d-46ad-95ed-5640d5cdc89c 完成，執行時間: 4.95秒
2025-01-23 07:42:14.591 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_544c1cb2 收到消息，開始解析
2025-01-23 07:42:14.593 [INFO] [python_ana_process_manager] id=UUID('00df06c6-4983-4ce5-adec-a0a33a1d759b') created_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 702171) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 702171) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:42:14.594 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_544c1cb2 解析後消息為: id=UUID('00df06c6-4983-4ce5-adec-a0a33a1d759b') created_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 702171) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 702171) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:42:16.090 [INFO] [python_ana_process_manager] Current Spark memory usage: 530.96MB
2025-01-23 07:42:16.091 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:42:16.091 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:42:18.667 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 07:42:18.667 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:42:20.429 [INFO] [python_ana_process_manager] 任務 c28d9a51-1a0d-46ad-95ed-5640d5cdc89c 完成
2025-01-23 07:42:20.429 [INFO] [python_ana_process_manager] 任務 c28d9a51-1a0d-46ad-95ed-5640d5cdc89c 完成，執行時間: 5.84秒
2025-01-23 07:42:21.404 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:42:30.640 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:42:31.038 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:42:32.317 [INFO] [python_ana_process_manager] Current Spark memory usage: 746.45MB
2025-01-23 07:42:32.317 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:42:32.318 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:42:34.839 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 07:42:34.839 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:42:37.686 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:42:42.885 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:42:43.212 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:42:43.237 [INFO] [python_ana_process_manager] 提交任務 0b5a21e2-0003-4164-8ff7-43cf6bd01eb8: _muti_process_run_test
2025-01-23 07:42:49.120 [INFO] [python_ana_trader] 任務 0b5a21e2-0003-4164-8ff7-43cf6bd01eb8 完成，執行時間: 4.96秒
2025-01-23 07:42:43.244 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_544c1cb2 收到消息，開始解析
2025-01-23 07:42:43.246 [INFO] [python_ana_process_manager] id=UUID('f5abc0f8-2492-4830-8402-1b28779b1842') created_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 918408) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 918408) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:42:43.247 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_544c1cb2 解析後消息為: id=UUID('f5abc0f8-2492-4830-8402-1b28779b1842') created_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 918408) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 43, 918408) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:42:44.766 [INFO] [python_ana_process_manager] Current Spark memory usage: 538.00MB
2025-01-23 07:42:44.767 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:42:44.767 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:42:47.450 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 07:42:47.450 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:42:49.123 [INFO] [python_ana_process_manager] 任務 0b5a21e2-0003-4164-8ff7-43cf6bd01eb8 完成
2025-01-23 07:42:49.123 [INFO] [python_ana_process_manager] 任務 0b5a21e2-0003-4164-8ff7-43cf6bd01eb8 完成，執行時間: 5.89秒
2025-01-23 07:42:50.188 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:42:59.727 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:43:00.286 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:43:01.481 [INFO] [python_ana_process_manager] Current Spark memory usage: 705.64MB
2025-01-23 07:43:01.481 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:43:01.482 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:43:04.059 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 07:43:04.059 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:43:06.918 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:43:11.949 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:43:12.426 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:43:12.456 [INFO] [python_ana_process_manager] 提交任務 2cacf9c3-5004-41c1-aafa-1495e9a54746: _muti_process_run_test
2025-01-23 07:43:18.314 [INFO] [python_ana_trader] 任務 2cacf9c3-5004-41c1-aafa-1495e9a54746 完成，執行時間: 4.95秒
2025-01-23 07:43:12.463 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_544c1cb2 收到消息，開始解析
2025-01-23 07:43:12.465 [INFO] [python_ana_process_manager] id=UUID('0cc3c8b6-6b4c-4b2d-adc2-2196b2314350') created_at=datetime.datetime(2025, 1, 23, 7, 36, 44, 146256) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 44, 146256) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:43:12.467 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_544c1cb2 解析後消息為: id=UUID('0cc3c8b6-6b4c-4b2d-adc2-2196b2314350') created_at=datetime.datetime(2025, 1, 23, 7, 36, 44, 146256) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 44, 146256) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:43:14.029 [INFO] [python_ana_process_manager] Current Spark memory usage: 557.98MB
2025-01-23 07:43:14.029 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:43:14.030 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:43:16.680 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 07:43:16.680 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:43:18.317 [INFO] [python_ana_process_manager] 任務 2cacf9c3-5004-41c1-aafa-1495e9a54746 完成
2025-01-23 07:43:18.317 [INFO] [python_ana_process_manager] 任務 2cacf9c3-5004-41c1-aafa-1495e9a54746 完成，執行時間: 5.86秒
2025-01-23 07:43:19.445 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:43:29.399 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:43:29.605 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:43:31.223 [INFO] [python_ana_process_manager] Current Spark memory usage: 620.39MB
2025-01-23 07:43:31.223 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:43:31.223 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:43:33.721 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 07:43:33.721 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:43:36.583 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:43:41.571 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:43:42.073 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:43:42.100 [INFO] [python_ana_process_manager] 提交任務 a39efea2-6dc0-4daa-ad00-7f4886c41022: _muti_process_run_test
2025-01-23 07:43:42.114 [INFO] [python_ana_trader] 任務 a39efea2-6dc0-4daa-ad00-7f4886c41022 完成，執行時間: 0.01秒
2025-01-23 07:43:42.104 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_544c1cb2 收到消息，開始解析
2025-01-23 07:43:42.106 [INFO] [python_ana_process_manager] id=UUID('ed949d8b-ae24-4528-9500-23e3e07ff972') created_at=datetime.datetime(2025, 1, 23, 7, 36, 44, 361265) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 44, 361265) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:43:42.107 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_544c1cb2 解析後消息為: id=UUID('ed949d8b-ae24-4528-9500-23e3e07ff972') created_at=datetime.datetime(2025, 1, 23, 7, 36, 44, 361265) updated_at=datetime.datetime(2025, 1, 23, 7, 36, 44, 361265) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:43:42.150 [INFO] [python_ana_process_manager] 任務 a39efea2-6dc0-4daa-ad00-7f4886c41022 完成
2025-01-23 07:43:42.181 [INFO] [python_ana_process_manager] 任務 a39efea2-6dc0-4daa-ad00-7f4886c41022 完成，執行時間: 0.05秒
2025-01-23 07:43:42.316 [INFO] [python_ana_process_manager] Current Spark memory usage: 509.75MB
2025-01-23 07:43:42.318 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:43:42.318 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:43:44.901 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 07:43:44.901 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:43:47.772 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:43:57.494 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:43:57.903 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:43:58.892 [INFO] [python_ana_process_manager] Current Spark memory usage: 745.54MB
2025-01-23 07:43:58.893 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:43:58.893 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:44:01.487 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 07:44:01.487 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:44:04.215 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:44:09.276 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:44:09.741 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:44:09.767 [INFO] [python_ana_process_manager] 提交任務 b7d62b97-39c1-415a-a95d-c79a97571ba2: _muti_process_run_test
2025-01-23 07:44:09.779 [INFO] [python_ana_trader] 任務 b7d62b97-39c1-415a-a95d-c79a97571ba2 完成，執行時間: 0.01秒
2025-01-23 07:44:09.782 [INFO] [python_ana_process_manager] 任務 b7d62b97-39c1-415a-a95d-c79a97571ba2 完成
2025-01-23 07:44:09.783 [INFO] [python_ana_process_manager] 任務 b7d62b97-39c1-415a-a95d-c79a97571ba2 完成，執行時間: 0.02秒
2025-01-23 07:47:23.826 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_544c1cb2
2025-01-23 07:47:23.826 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_544c1cb2 正在停止
2025-01-23 07:47:23.827 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_544c1cb2 已完全停止
2025-01-23 07:47:23.827 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bf83ff44
2025-01-23 07:47:23.828 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bf83ff44 正在停止
2025-01-23 07:47:23.828 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bf83ff44 已完全停止
2025-01-23 07:47:23.828 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_a46566c6
2025-01-23 07:47:23.829 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a46566c6 正在停止
2025-01-23 07:47:23.829 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a46566c6 已完全停止
2025-01-23 07:48:44.403 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 4
2025-01-23 07:48:49.394 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_9798c7bb 開始消費隊列 full_backtest
2025-01-23 07:48:49.394 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_9798c7bb 線程已啟動
2025-01-23 07:48:49.395 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_7ff6e9a1 開始消費隊列 pre_process_stock_data
2025-01-23 07:48:49.395 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_7ff6e9a1 線程已啟動
2025-01-23 07:48:49.395 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_519138e1 開始消費隊列 back_testing
2025-01-23 07:48:49.395 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_519138e1 線程已啟動
2025-01-23 07:49:06.341 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_9798c7bb 收到消息，開始解析
2025-01-23 07:49:06.344 [INFO] [python_ana_process_manager] id=UUID('101d0206-6f9d-49b3-80d1-5e390b5c2ce3') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 337435) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 337435) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:49:06.345 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_9798c7bb 解析後消息為: id=UUID('101d0206-6f9d-49b3-80d1-5e390b5c2ce3') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 337435) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 337435) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:49:06.349 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:49:06.350 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:49:09.214 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:49:18.676 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:49:18.843 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:49:18.850 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:49:18.850 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:50:53.538 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_9798c7bb
2025-01-23 07:50:53.538 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_9798c7bb 正在停止
2025-01-23 07:50:53.539 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_9798c7bb 已完全停止
2025-01-23 07:50:53.539 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_7ff6e9a1
2025-01-23 07:50:53.539 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_7ff6e9a1 正在停止
2025-01-23 07:50:53.540 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_7ff6e9a1 已完全停止
2025-01-23 07:50:53.540 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_519138e1
2025-01-23 07:50:53.540 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_519138e1 正在停止
2025-01-23 07:50:53.540 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_519138e1 已完全停止
2025-01-23 07:50:53.949 [ERROR] [python_ana_process_manager] Failed to create SparkSession: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext
2025-01-23 07:50:53.950 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_9798c7bb 任務失敗: 讀取數據時發生錯誤: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext code='2317' candle='d1' start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)) end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))
2025-01-23 07:52:37.229 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-01-23 07:52:42.221 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4f299d34 開始消費隊列 full_backtest
2025-01-23 07:52:42.221 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4f299d34 線程已啟動
2025-01-23 07:52:42.222 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_916e4f18 開始消費隊列 pre_process_stock_data
2025-01-23 07:52:42.222 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_916e4f18 線程已啟動
2025-01-23 07:52:42.223 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_3fb3c3b7 開始消費隊列 back_testing
2025-01-23 07:52:42.223 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_3fb3c3b7 線程已啟動
2025-01-23 07:52:47.218 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f299d34 收到消息，開始解析
2025-01-23 07:52:47.220 [INFO] [python_ana_process_manager] id=UUID('101d0206-6f9d-49b3-80d1-5e390b5c2ce3') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 337435) updated_at=datetime.datetime(2025, 1, 23, 7, 50, 53, 950894) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message="讀取數據時發生錯誤: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext code='2317' candle='d1' start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)) end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))" sink_params=None set_params=None
2025-01-23 07:52:47.221 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f299d34 解析後消息為: id=UUID('101d0206-6f9d-49b3-80d1-5e390b5c2ce3') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 337435) updated_at=datetime.datetime(2025, 1, 23, 7, 50, 53, 950894) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message="讀取數據時發生錯誤: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext code='2317' candle='d1' start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)) end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))" sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:52:47.224 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:52:47.224 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:52:50.009 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:52:59.276 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:52:59.612 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:52:59.618 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:52:59.619 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:52:59.764 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:53:01.146 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:53:01.291 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:53:01.316 [INFO] [python_ana_process_manager] 提交任務 e2f5798b-9c57-418a-a126-feb2d1a59e81: _muti_process_run_test
2025-01-23 07:53:01.322 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f299d34 收到消息，開始解析
2025-01-23 07:53:01.324 [INFO] [python_ana_process_manager] id=UUID('8c8d5009-b1e9-4b41-bdb1-65d5e54084e4') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 583415) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 583415) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:53:01.325 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f299d34 解析後消息為: id=UUID('8c8d5009-b1e9-4b41-bdb1-65d5e54084e4') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 583415) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 583415) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:53:01.329 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:53:01.329 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:53:01.468 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:53:04.481 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:53:05.028 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:53:05.035 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:53:05.036 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:53:05.190 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:53:05.856 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:53:06.247 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:53:06.272 [INFO] [python_ana_process_manager] 提交任務 933cba05-4d50-4686-b531-2700fecc2905: _muti_process_run_test
2025-01-23 07:53:07.328 [INFO] [python_ana_trader] 任務 e2f5798b-9c57-418a-a126-feb2d1a59e81 完成，執行時間: 4.95秒
2025-01-23 07:53:12.257 [INFO] [python_ana_trader] 任務 933cba05-4d50-4686-b531-2700fecc2905 完成，執行時間: 4.96秒
2025-01-23 07:53:06.279 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f299d34 收到消息，開始解析
2025-01-23 07:53:06.281 [INFO] [python_ana_process_manager] id=UUID('ca45b7bc-e76c-4aa5-b78d-2880400b570b') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 787957) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 787957) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:53:06.283 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f299d34 解析後消息為: id=UUID('ca45b7bc-e76c-4aa5-b78d-2880400b570b') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 787957) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 787957) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:53:06.286 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:53:06.286 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:53:06.419 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:53:07.331 [INFO] [python_ana_process_manager] 任務 e2f5798b-9c57-418a-a126-feb2d1a59e81 完成
2025-01-23 07:53:07.331 [INFO] [python_ana_process_manager] 任務 e2f5798b-9c57-418a-a126-feb2d1a59e81 完成，執行時間: 6.02秒
2025-01-23 07:53:09.282 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:53:09.480 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:53:09.488 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:53:09.488 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:53:12.259 [INFO] [python_ana_process_manager] 任務 933cba05-4d50-4686-b531-2700fecc2905 完成
2025-01-23 07:53:12.260 [INFO] [python_ana_process_manager] 任務 933cba05-4d50-4686-b531-2700fecc2905 完成，執行時間: 5.99秒
2025-01-23 07:54:37.962 [ERROR] [python_ana_process_manager] Failed to create SparkSession: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext
2025-01-23 07:54:37.962 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4f299d34 任務失敗: 讀取數據時發生錯誤: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext code='2317' candle='d1' start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)) end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))
2025-01-23 07:55:01.161 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 4
2025-01-23 07:55:06.156 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_adb48cc1 開始消費隊列 full_backtest
2025-01-23 07:55:06.157 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_adb48cc1 線程已啟動
2025-01-23 07:55:06.157 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_39f7daaf 開始消費隊列 pre_process_stock_data
2025-01-23 07:55:06.157 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_39f7daaf 線程已啟動
2025-01-23 07:55:06.158 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_d32449c6 開始消費隊列 back_testing
2025-01-23 07:55:06.158 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_d32449c6 線程已啟動
2025-01-23 07:55:11.162 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:55:11.165 [INFO] [python_ana_process_manager] id=UUID('ca45b7bc-e76c-4aa5-b78d-2880400b570b') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 787957) updated_at=datetime.datetime(2025, 1, 23, 7, 54, 37, 963590) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message="讀取數據時發生錯誤: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext code='2317' candle='d1' start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)) end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))" sink_params=None set_params=None
2025-01-23 07:55:11.166 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('ca45b7bc-e76c-4aa5-b78d-2880400b570b') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 787957) updated_at=datetime.datetime(2025, 1, 23, 7, 54, 37, 963590) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message="讀取數據時發生錯誤: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext code='2317' candle='d1' start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)) end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))" sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:55:11.170 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:11.170 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:13.915 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:55:23.192 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:23.461 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:23.468 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:23.468 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:23.607 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:55:24.901 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:25.143 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:25.173 [INFO] [python_ana_process_manager] 提交任務 fbdf3f37-dba4-4ea0-99c8-16d642082f03: _muti_process_run_test
2025-01-23 07:55:25.178 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:55:25.180 [INFO] [python_ana_process_manager] id=UUID('3108681c-5184-46e2-992a-2da011083af5') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 985391) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 985391) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:55:25.182 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('3108681c-5184-46e2-992a-2da011083af5') created_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 985391) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 6, 985391) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:55:25.186 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:25.186 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:25.326 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:55:28.241 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:28.387 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:28.392 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:28.392 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:28.528 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:55:29.197 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:29.541 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:29.565 [INFO] [python_ana_process_manager] 提交任務 8208e4af-91c3-4223-9ca0-5a21da5fe177: _muti_process_run_test
2025-01-23 07:55:29.572 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:55:29.574 [INFO] [python_ana_process_manager] id=UUID('72a0b971-7500-4660-b14f-8239794fc7f5') created_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 188573) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 188573) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:55:29.575 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('72a0b971-7500-4660-b14f-8239794fc7f5') created_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 188573) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 188573) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:55:29.579 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:29.579 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:29.722 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:55:31.108 [INFO] [python_ana_process_manager] 任務 fbdf3f37-dba4-4ea0-99c8-16d642082f03 完成
2025-01-23 07:55:31.108 [INFO] [python_ana_process_manager] 任務 fbdf3f37-dba4-4ea0-99c8-16d642082f03 完成，執行時間: 5.94秒
2025-01-23 07:55:32.339 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:32.774 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:32.782 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:32.782 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:32.909 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:55:33.465 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:33.934 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:33.960 [INFO] [python_ana_process_manager] 提交任務 dbf1e3d0-bd3b-4cfd-bfa1-e75aa28949d2: _muti_process_run_test
2025-01-23 07:55:31.105 [INFO] [python_ana_trader] 任務 fbdf3f37-dba4-4ea0-99c8-16d642082f03 完成，執行時間: 4.96秒
2025-01-23 07:55:33.965 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:55:33.967 [INFO] [python_ana_process_manager] id=UUID('805029d4-2f0d-4e54-8c49-5a9740cd47d5') created_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 408451) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 408451) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:55:33.968 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('805029d4-2f0d-4e54-8c49-5a9740cd47d5') created_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 408451) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 408451) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:55:33.971 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:33.971 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:34.096 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:55:35.549 [INFO] [python_ana_process_manager] 任務 8208e4af-91c3-4223-9ca0-5a21da5fe177 完成
2025-01-23 07:55:35.549 [INFO] [python_ana_process_manager] 任務 8208e4af-91c3-4223-9ca0-5a21da5fe177 完成，執行時間: 5.98秒
2025-01-23 07:55:36.596 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:37.147 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:37.154 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:37.155 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:37.287 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:55:37.984 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:38.295 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:38.320 [INFO] [python_ana_process_manager] 提交任務 07809967-6799-43a8-a731-bbc7e3088f83: _muti_process_run_test
2025-01-23 07:55:35.547 [INFO] [python_ana_trader] 任務 8208e4af-91c3-4223-9ca0-5a21da5fe177 完成，執行時間: 4.95秒
2025-01-23 07:55:38.327 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:55:38.329 [INFO] [python_ana_process_manager] id=UUID('05f2bf44-7824-4bb3-ae9e-a7cabe8aa086') created_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 635287) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 635287) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:55:38.330 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('05f2bf44-7824-4bb3-ae9e-a7cabe8aa086') created_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 635287) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 635287) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:55:38.333 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:38.334 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:38.458 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:55:39.878 [INFO] [python_ana_process_manager] 任務 dbf1e3d0-bd3b-4cfd-bfa1-e75aa28949d2 完成
2025-01-23 07:55:39.878 [INFO] [python_ana_process_manager] 任務 dbf1e3d0-bd3b-4cfd-bfa1-e75aa28949d2 完成，執行時間: 5.92秒
2025-01-23 07:55:40.790 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:40.985 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:40.990 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:40.991 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:41.113 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:55:41.684 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:42.134 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:42.160 [INFO] [python_ana_process_manager] 提交任務 e55d186e-f4d6-4e1f-be64-11f9cdf8f7ac: _muti_process_run_test
2025-01-23 07:55:39.875 [INFO] [python_ana_trader] 任務 dbf1e3d0-bd3b-4cfd-bfa1-e75aa28949d2 完成，執行時間: 4.95秒
2025-01-23 07:55:42.165 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:55:42.167 [INFO] [python_ana_process_manager] id=UUID('5fed0555-c4a4-4f1f-aea8-1f123ed72ab1') created_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 842845) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 842845) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:55:42.168 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('5fed0555-c4a4-4f1f-aea8-1f123ed72ab1') created_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 842845) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 7, 842845) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:55:42.171 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:42.171 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:42.175 [INFO] [python_ana_process_manager] 任務 e55d186e-f4d6-4e1f-be64-11f9cdf8f7ac 完成
2025-01-23 07:55:42.176 [INFO] [python_ana_process_manager] 任務 e55d186e-f4d6-4e1f-be64-11f9cdf8f7ac 完成，執行時間: 0.01秒
2025-01-23 07:55:42.310 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:55:44.215 [INFO] [python_ana_process_manager] 任務 07809967-6799-43a8-a731-bbc7e3088f83 完成
2025-01-23 07:55:44.215 [INFO] [python_ana_process_manager] 任務 07809967-6799-43a8-a731-bbc7e3088f83 完成，執行時間: 5.90秒
2025-01-23 07:55:44.572 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:44.838 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:44.846 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:44.847 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:44.975 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:55:45.584 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:45.985 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:46.011 [INFO] [python_ana_process_manager] 提交任務 a1796003-04a2-47d9-a604-c5ccfaa13011: _muti_process_run_test
2025-01-23 07:55:42.172 [INFO] [python_ana_trader] 任務 e55d186e-f4d6-4e1f-be64-11f9cdf8f7ac 完成，執行時間: 0.01秒
2025-01-23 07:55:44.212 [INFO] [python_ana_trader] 任務 07809967-6799-43a8-a731-bbc7e3088f83 完成，執行時間: 4.96秒
2025-01-23 07:55:46.016 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:55:46.017 [INFO] [python_ana_process_manager] id=UUID('5749953d-a2af-407e-8d15-4e38202e8218') created_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 67635) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 67635) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:55:46.019 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('5749953d-a2af-407e-8d15-4e38202e8218') created_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 67635) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 67635) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:55:46.022 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:46.022 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:46.025 [INFO] [python_ana_process_manager] 任務 a1796003-04a2-47d9-a604-c5ccfaa13011 完成
2025-01-23 07:55:46.026 [INFO] [python_ana_process_manager] 任務 a1796003-04a2-47d9-a604-c5ccfaa13011 完成，執行時間: 0.01秒
2025-01-23 07:55:46.153 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:55:48.480 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:48.681 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:48.687 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:48.687 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:48.806 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:55:49.322 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:49.827 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:49.852 [INFO] [python_ana_process_manager] 提交任務 24690b1f-7fc4-4ec1-a2b9-01f3d140964f: _muti_process_run_test
2025-01-23 07:55:46.022 [INFO] [python_ana_trader] 任務 a1796003-04a2-47d9-a604-c5ccfaa13011 完成，執行時間: 0.01秒
2025-01-23 07:55:49.858 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:55:49.859 [INFO] [python_ana_process_manager] id=UUID('a9334de8-f8d5-4ee9-be68-9e9de78e8733') created_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 276775) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 276775) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:55:49.860 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('a9334de8-f8d5-4ee9-be68-9e9de78e8733') created_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 276775) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 276775) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:55:49.863 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:49.864 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:49.868 [INFO] [python_ana_process_manager] 任務 24690b1f-7fc4-4ec1-a2b9-01f3d140964f 完成
2025-01-23 07:55:49.869 [INFO] [python_ana_process_manager] 任務 24690b1f-7fc4-4ec1-a2b9-01f3d140964f 完成，執行時間: 0.02秒
2025-01-23 07:55:49.997 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:55:52.250 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:52.547 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:52.553 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:52.553 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:52.676 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:55:53.237 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:53.699 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:53.724 [INFO] [python_ana_process_manager] 提交任務 6a673518-89d4-4bbc-845a-8af79c1a534e: _muti_process_run_test
2025-01-23 07:55:49.865 [INFO] [python_ana_trader] 任務 24690b1f-7fc4-4ec1-a2b9-01f3d140964f 完成，執行時間: 0.01秒
2025-01-23 07:55:53.736 [INFO] [python_ana_trader] 任務 6a673518-89d4-4bbc-845a-8af79c1a534e 完成，執行時間: 0.01秒
2025-01-23 07:55:53.732 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:55:53.733 [INFO] [python_ana_process_manager] id=UUID('d72ef114-45be-472d-a9e2-ee75e7902fe7') created_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 518342) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 518342) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:55:53.734 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('d72ef114-45be-472d-a9e2-ee75e7902fe7') created_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 518342) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 518342) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:55:53.737 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:53.738 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:53.740 [INFO] [python_ana_process_manager] 任務 6a673518-89d4-4bbc-845a-8af79c1a534e 完成
2025-01-23 07:55:53.740 [INFO] [python_ana_process_manager] 任務 6a673518-89d4-4bbc-845a-8af79c1a534e 完成，執行時間: 0.02秒
2025-01-23 07:55:53.874 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:55:56.234 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:56.421 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:56.427 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:56.428 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:56.543 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:55:57.066 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:55:57.574 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:55:57.601 [INFO] [python_ana_process_manager] 提交任務 305968fa-906e-41e4-b5f7-753ae1c08823: _muti_process_run_test
2025-01-23 07:55:57.612 [INFO] [python_ana_trader] 任務 305968fa-906e-41e4-b5f7-753ae1c08823 完成，執行時間: 0.01秒
2025-01-23 07:55:57.607 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:55:57.609 [INFO] [python_ana_process_manager] id=UUID('fad5b121-2a6b-4983-9140-59faf372d0f5') created_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 743975) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 743975) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:55:57.610 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('fad5b121-2a6b-4983-9140-59faf372d0f5') created_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 743975) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 743975) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:55:57.613 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:55:57.613 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:55:57.615 [INFO] [python_ana_process_manager] 任務 305968fa-906e-41e4-b5f7-753ae1c08823 完成
2025-01-23 07:55:57.615 [INFO] [python_ana_process_manager] 任務 305968fa-906e-41e4-b5f7-753ae1c08823 完成，執行時間: 0.02秒
2025-01-23 07:55:57.742 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:55:59.904 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:00.278 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:00.284 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:00.285 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:00.408 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:00.946 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:01.431 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:01.457 [INFO] [python_ana_process_manager] 提交任務 16d05a2c-fc9b-4148-b16e-0c93cc5880f0: _muti_process_run_test
2025-01-23 07:56:01.461 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:01.463 [INFO] [python_ana_process_manager] id=UUID('b446a3bf-062a-4caf-a278-49a5e7690085') created_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 968120) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 968120) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:01.465 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('b446a3bf-062a-4caf-a278-49a5e7690085') created_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 968120) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 8, 968120) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:01.467 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:01.468 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:01.470 [INFO] [python_ana_process_manager] 任務 16d05a2c-fc9b-4148-b16e-0c93cc5880f0 完成
2025-01-23 07:56:01.471 [INFO] [python_ana_process_manager] 任務 16d05a2c-fc9b-4148-b16e-0c93cc5880f0 完成，執行時間: 0.01秒
2025-01-23 07:56:01.593 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:56:03.678 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:04.120 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:04.128 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:04.128 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:04.242 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:04.830 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:05.257 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:05.282 [INFO] [python_ana_process_manager] 提交任務 db57a2c8-9b04-475e-b8b0-94e9e1daea8b: _muti_process_run_test
2025-01-23 07:56:01.468 [INFO] [python_ana_trader] 任務 16d05a2c-fc9b-4148-b16e-0c93cc5880f0 完成，執行時間: 0.01秒
2025-01-23 07:56:05.287 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:05.290 [INFO] [python_ana_process_manager] id=UUID('5bbee4d5-f380-4c87-93b5-f5fbab485a4a') created_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 181920) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 181920) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:05.291 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('5bbee4d5-f380-4c87-93b5-f5fbab485a4a') created_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 181920) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 181920) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:05.294 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:05.296 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:05.298 [INFO] [python_ana_process_manager] 任務 db57a2c8-9b04-475e-b8b0-94e9e1daea8b 完成
2025-01-23 07:56:05.299 [INFO] [python_ana_process_manager] 任務 db57a2c8-9b04-475e-b8b0-94e9e1daea8b 完成，執行時間: 0.02秒
2025-01-23 07:56:05.437 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:56:07.572 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:07.987 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:07.993 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:07.993 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:08.119 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:08.650 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:09.122 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:09.147 [INFO] [python_ana_process_manager] 提交任務 c0fc016b-d964-4529-8549-c804b3bb0a4e: _muti_process_run_test
2025-01-23 07:56:05.296 [INFO] [python_ana_trader] 任務 db57a2c8-9b04-475e-b8b0-94e9e1daea8b 完成，執行時間: 0.01秒
2025-01-23 07:56:09.159 [INFO] [python_ana_trader] 任務 c0fc016b-d964-4529-8549-c804b3bb0a4e 完成，執行時間: 0.01秒
2025-01-23 07:56:09.153 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:09.154 [INFO] [python_ana_process_manager] id=UUID('a11789fc-767a-401a-a8bb-429f85a96127') created_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 401198) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 401198) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:09.156 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('a11789fc-767a-401a-a8bb-429f85a96127') created_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 401198) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 401198) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:09.159 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:09.159 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:09.162 [INFO] [python_ana_process_manager] 任務 c0fc016b-d964-4529-8549-c804b3bb0a4e 完成
2025-01-23 07:56:09.162 [INFO] [python_ana_process_manager] 任務 c0fc016b-d964-4529-8549-c804b3bb0a4e 完成，執行時間: 0.01秒
2025-01-23 07:56:09.285 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:56:11.406 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:11.817 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:11.823 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:11.823 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:11.940 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:12.434 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:12.952 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:12.978 [INFO] [python_ana_process_manager] 提交任務 1b44ef01-88b3-4109-9313-2c448154ff58: _muti_process_run_test
2025-01-23 07:56:12.990 [INFO] [python_ana_trader] 任務 1b44ef01-88b3-4109-9313-2c448154ff58 完成，執行時間: 0.01秒
2025-01-23 07:56:12.983 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:12.985 [INFO] [python_ana_process_manager] id=UUID('84d0f591-9094-4078-9788-266d36783f5f') created_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 639471) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 639471) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:12.986 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('84d0f591-9094-4078-9788-266d36783f5f') created_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 639471) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 639471) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:12.990 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:12.990 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:12.993 [INFO] [python_ana_process_manager] 任務 1b44ef01-88b3-4109-9313-2c448154ff58 完成
2025-01-23 07:56:12.994 [INFO] [python_ana_process_manager] 任務 1b44ef01-88b3-4109-9313-2c448154ff58 完成，執行時間: 0.01秒
2025-01-23 07:56:13.129 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:56:15.224 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:15.663 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:15.671 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:15.672 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:15.801 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:16.318 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:16.814 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:16.840 [INFO] [python_ana_process_manager] 提交任務 f6f0a3b7-e6d8-468c-8bb1-f90609fe4c3d: _muti_process_run_test
2025-01-23 07:56:16.851 [INFO] [python_ana_trader] 任務 f6f0a3b7-e6d8-468c-8bb1-f90609fe4c3d 完成，執行時間: 0.01秒
2025-01-23 07:56:16.844 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:16.846 [INFO] [python_ana_process_manager] id=UUID('0fd0f091-2cdd-403a-ab2e-27c099fe7df3') created_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 895884) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 895884) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:16.847 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('0fd0f091-2cdd-403a-ab2e-27c099fe7df3') created_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 895884) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 9, 895884) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:16.850 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:16.850 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:16.853 [INFO] [python_ana_process_manager] 任務 f6f0a3b7-e6d8-468c-8bb1-f90609fe4c3d 完成
2025-01-23 07:56:16.854 [INFO] [python_ana_process_manager] 任務 f6f0a3b7-e6d8-468c-8bb1-f90609fe4c3d 完成，執行時間: 0.01秒
2025-01-23 07:56:16.978 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:56:19.056 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:19.518 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:19.524 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:19.524 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:19.639 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:20.147 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:20.654 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:20.679 [INFO] [python_ana_process_manager] 提交任務 21666d60-f525-4fec-8fa4-e1843d2894de: _muti_process_run_test
2025-01-23 07:56:20.684 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:20.687 [INFO] [python_ana_process_manager] id=UUID('35ea50d6-8e06-4cc1-90c2-fce339059fdb') created_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 131794) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 131794) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:20.688 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('35ea50d6-8e06-4cc1-90c2-fce339059fdb') created_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 131794) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 131794) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:20.691 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:20.691 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:20.696 [INFO] [python_ana_process_manager] 任務 21666d60-f525-4fec-8fa4-e1843d2894de 完成
2025-01-23 07:56:20.696 [INFO] [python_ana_process_manager] 任務 21666d60-f525-4fec-8fa4-e1843d2894de 完成，執行時間: 0.02秒
2025-01-23 07:56:20.825 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:56:23.038 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:23.371 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:23.378 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:23.378 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:23.502 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:24.038 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:24.538 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:24.563 [INFO] [python_ana_process_manager] 提交任務 af440e12-fcbb-447c-ae13-52ee3c294040: _muti_process_run_test
2025-01-23 07:56:20.692 [INFO] [python_ana_trader] 任務 21666d60-f525-4fec-8fa4-e1843d2894de 完成，執行時間: 0.01秒
2025-01-23 07:56:24.574 [INFO] [python_ana_trader] 任務 af440e12-fcbb-447c-ae13-52ee3c294040 完成，執行時間: 0.01秒
2025-01-23 07:56:24.568 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:24.569 [INFO] [python_ana_process_manager] id=UUID('aedd2c62-7676-40e3-83da-ef4a06e12614') created_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 363821) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 363821) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:24.570 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('aedd2c62-7676-40e3-83da-ef4a06e12614') created_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 363821) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 363821) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:24.573 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:24.574 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:24.577 [INFO] [python_ana_process_manager] 任務 af440e12-fcbb-447c-ae13-52ee3c294040 完成
2025-01-23 07:56:24.578 [INFO] [python_ana_process_manager] 任務 af440e12-fcbb-447c-ae13-52ee3c294040 完成，執行時間: 0.01秒
2025-01-23 07:56:24.706 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:56:26.793 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:27.254 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:27.260 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:27.260 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:27.378 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:27.917 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:28.401 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:28.428 [INFO] [python_ana_process_manager] 提交任務 e43ea264-1eac-41a2-b542-766c63fa7809: _muti_process_run_test
2025-01-23 07:56:28.438 [INFO] [python_ana_trader] 任務 e43ea264-1eac-41a2-b542-766c63fa7809 完成，執行時間: 0.01秒
2025-01-23 07:56:28.433 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:28.434 [INFO] [python_ana_process_manager] id=UUID('ea98cab6-932c-4ceb-95cf-cc4dc1080f13') created_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 585682) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 585682) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:28.435 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('ea98cab6-932c-4ceb-95cf-cc4dc1080f13') created_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 585682) updated_at=datetime.datetime(2025, 1, 23, 7, 49, 10, 585682) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:28.438 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:28.438 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:28.442 [INFO] [python_ana_process_manager] 任務 e43ea264-1eac-41a2-b542-766c63fa7809 完成
2025-01-23 07:56:28.442 [INFO] [python_ana_process_manager] 任務 e43ea264-1eac-41a2-b542-766c63fa7809 完成，執行時間: 0.01秒
2025-01-23 07:56:28.562 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:56:30.587 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:31.094 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:31.100 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:31.100 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:31.215 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:31.712 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:32.229 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:32.255 [INFO] [python_ana_process_manager] 提交任務 bb446ce1-1c19-4d50-a0ab-bc1213ee0ca1: _muti_process_run_test
2025-01-23 07:56:32.266 [INFO] [python_ana_trader] 任務 bb446ce1-1c19-4d50-a0ab-bc1213ee0ca1 完成，執行時間: 0.01秒
2025-01-23 07:56:32.268 [INFO] [python_ana_process_manager] 任務 bb446ce1-1c19-4d50-a0ab-bc1213ee0ca1 完成
2025-01-23 07:56:32.269 [INFO] [python_ana_process_manager] 任務 bb446ce1-1c19-4d50-a0ab-bc1213ee0ca1 完成，執行時間: 0.01秒
2025-01-23 07:56:51.100 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:51.102 [INFO] [python_ana_process_manager] id=UUID('503cca09-aeb7-4df4-a81d-f8adb0c06885') created_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 93772) updated_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 93772) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:51.103 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('503cca09-aeb7-4df4-a81d-f8adb0c06885') created_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 93772) updated_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 93772) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:51.106 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:51.107 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:51.240 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:56:53.380 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:53.782 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:53.788 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:53.789 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:53.905 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:54.391 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:54.916 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:54.943 [INFO] [python_ana_process_manager] 提交任務 ae25e1b4-d3f1-421c-84be-8e73eb9cf5d0: _muti_process_run_test
2025-01-23 07:56:54.948 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:54.950 [INFO] [python_ana_process_manager] id=UUID('96b466f3-a26e-4468-96da-295066330f83') created_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 321562) updated_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 321562) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:54.951 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('96b466f3-a26e-4468-96da-295066330f83') created_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 321562) updated_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 321562) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:54.954 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:54.955 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:54.958 [INFO] [python_ana_process_manager] 任務 ae25e1b4-d3f1-421c-84be-8e73eb9cf5d0 完成
2025-01-23 07:56:54.959 [INFO] [python_ana_process_manager] 任務 ae25e1b4-d3f1-421c-84be-8e73eb9cf5d0 完成，執行時間: 0.01秒
2025-01-23 07:56:55.083 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:56:57.137 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:57.636 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:57.641 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:57.642 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:57.759 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:56:58.332 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:56:58.785 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:56:58.811 [INFO] [python_ana_process_manager] 提交任務 8192fa17-f8e3-4b68-b349-01073c638a9e: _muti_process_run_test
2025-01-23 07:56:54.955 [INFO] [python_ana_trader] 任務 ae25e1b4-d3f1-421c-84be-8e73eb9cf5d0 完成，執行時間: 0.01秒
2025-01-23 07:56:58.823 [INFO] [python_ana_trader] 任務 8192fa17-f8e3-4b68-b349-01073c638a9e 完成，執行時間: 0.01秒
2025-01-23 07:56:58.816 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:56:58.817 [INFO] [python_ana_process_manager] id=UUID('d2cd0fc0-6f1a-40e3-acc5-0d2909a06ca4') created_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 572045) updated_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 572045) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:56:58.818 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('d2cd0fc0-6f1a-40e3-acc5-0d2909a06ca4') created_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 572045) updated_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 572045) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:56:58.821 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:56:58.821 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:56:58.826 [INFO] [python_ana_process_manager] 任務 8192fa17-f8e3-4b68-b349-01073c638a9e 完成
2025-01-23 07:56:58.826 [INFO] [python_ana_process_manager] 任務 8192fa17-f8e3-4b68-b349-01073c638a9e 完成，執行時間: 0.01秒
2025-01-23 07:56:58.946 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:57:01.010 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:57:01.497 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:57:01.503 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:57:01.503 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:57:01.631 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:57:02.151 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:57:02.633 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:57:02.657 [INFO] [python_ana_process_manager] 提交任務 e04796fc-46d2-4cb1-9523-86c5971a3429: _muti_process_run_test
2025-01-23 07:57:02.669 [INFO] [python_ana_trader] 任務 e04796fc-46d2-4cb1-9523-86c5971a3429 完成，執行時間: 0.01秒
2025-01-23 07:57:02.663 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:57:02.666 [INFO] [python_ana_process_manager] id=UUID('5858a7de-b44d-4e9f-b9af-7242fe0a6543') created_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 811069) updated_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 811069) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:57:02.667 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('5858a7de-b44d-4e9f-b9af-7242fe0a6543') created_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 811069) updated_at=datetime.datetime(2025, 1, 23, 7, 56, 51, 811069) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:57:02.671 [INFO] [python_ana_process_manager] 任務 e04796fc-46d2-4cb1-9523-86c5971a3429 完成
2025-01-23 07:57:02.672 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:57:02.672 [INFO] [python_ana_process_manager] 任務 e04796fc-46d2-4cb1-9523-86c5971a3429 完成，執行時間: 0.01秒
2025-01-23 07:57:02.672 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:57:02.800 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:57:04.818 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:57:05.342 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:57:05.347 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:57:05.348 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:57:05.462 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:57:05.990 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:57:06.490 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:57:06.515 [INFO] [python_ana_process_manager] 提交任務 66af4e94-c157-42fc-aec6-db8a85e2e7b9: _muti_process_run_test
2025-01-23 07:57:06.521 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 收到消息，開始解析
2025-01-23 07:57:06.522 [INFO] [python_ana_process_manager] id=UUID('fc821a23-76b7-4023-b188-c8e14e71352a') created_at=datetime.datetime(2025, 1, 23, 7, 56, 52, 30994) updated_at=datetime.datetime(2025, 1, 23, 7, 56, 52, 30994) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:57:06.523 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_adb48cc1 解析後消息為: id=UUID('fc821a23-76b7-4023-b188-c8e14e71352a') created_at=datetime.datetime(2025, 1, 23, 7, 56, 52, 30994) updated_at=datetime.datetime(2025, 1, 23, 7, 56, 52, 30994) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:57:06.526 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:57:06.527 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:57:06.532 [INFO] [python_ana_process_manager] 任務 66af4e94-c157-42fc-aec6-db8a85e2e7b9 完成
2025-01-23 07:57:06.532 [INFO] [python_ana_process_manager] 任務 66af4e94-c157-42fc-aec6-db8a85e2e7b9 完成，執行時間: 0.02秒
2025-01-23 07:57:06.664 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:57:08.672 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:57:09.207 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:57:09.212 [WARNING] [python_ana_process_manager] Cannot restart: 1024 active sessions
2025-01-23 07:57:09.212 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:57:09.323 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:57:09.852 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:57:10.344 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:57:10.369 [INFO] [python_ana_process_manager] 提交任務 483bbe2b-1296-4b2d-9f85-51ca183f4173: _muti_process_run_test
2025-01-23 07:57:06.529 [INFO] [python_ana_trader] 任務 66af4e94-c157-42fc-aec6-db8a85e2e7b9 完成，執行時間: 0.01秒
2025-01-23 07:57:10.380 [INFO] [python_ana_trader] 任務 483bbe2b-1296-4b2d-9f85-51ca183f4173 完成，執行時間: 0.01秒
2025-01-23 07:57:10.383 [INFO] [python_ana_process_manager] 任務 483bbe2b-1296-4b2d-9f85-51ca183f4173 完成
2025-01-23 07:57:10.384 [INFO] [python_ana_process_manager] 任務 483bbe2b-1296-4b2d-9f85-51ca183f4173 完成，執行時間: 0.01秒
2025-01-23 07:58:07.435 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-01-23 07:58:12.428 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_f5e5f946 開始消費隊列 full_backtest
2025-01-23 07:58:12.428 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_f5e5f946 線程已啟動
2025-01-23 07:58:12.429 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4e6f6ee3 開始消費隊列 pre_process_stock_data
2025-01-23 07:58:12.429 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4e6f6ee3 線程已啟動
2025-01-23 07:58:12.430 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_8171cbe5 開始消費隊列 back_testing
2025-01-23 07:58:12.430 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_8171cbe5 線程已啟動
2025-01-23 07:58:23.142 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:58:23.145 [INFO] [python_ana_process_manager] id=UUID('f9568a13-fe42-40bd-9151-1ef14b794e17') created_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 137984) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 137984) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:58:23.146 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('f9568a13-fe42-40bd-9151-1ef14b794e17') created_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 137984) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 137984) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:58:24.705 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:58:27.470 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:58:36.681 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:58:37.094 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:58:38.081 [INFO] [python_ana_process_manager] Current Spark memory usage: 744.89MB
2025-01-23 07:58:38.081 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:58:38.233 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:58:39.498 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:58:39.744 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:58:39.768 [INFO] [python_ana_process_manager] 提交任務 32ef44c8-f115-4c79-8ea7-802792d44639: _muti_process_run_test
2025-01-23 07:58:39.775 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:58:39.777 [INFO] [python_ana_process_manager] id=UUID('d9e9f642-dfaa-432e-80f3-7418bbd6d1e3') created_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 412791) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 412791) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:58:39.778 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('d9e9f642-dfaa-432e-80f3-7418bbd6d1e3') created_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 412791) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 412791) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:58:41.136 [INFO] [python_ana_process_manager] Current Spark memory usage: 727.12MB
2025-01-23 07:58:41.137 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:58:41.272 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:58:44.060 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:58:44.317 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:58:45.473 [INFO] [python_ana_process_manager] Current Spark memory usage: 764.70MB
2025-01-23 07:58:45.473 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:58:45.618 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:58:45.635 [INFO] [python_ana_process_manager] 任務 32ef44c8-f115-4c79-8ea7-802792d44639 完成
2025-01-23 07:58:45.636 [INFO] [python_ana_process_manager] 任務 32ef44c8-f115-4c79-8ea7-802792d44639 完成，執行時間: 5.87秒
2025-01-23 07:58:46.302 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:58:46.617 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:58:46.641 [INFO] [python_ana_process_manager] 提交任務 a416ac66-caf5-4d8d-9ff8-f1df884cf5e1: _muti_process_run_test
2025-01-23 07:58:45.632 [INFO] [python_ana_trader] 任務 32ef44c8-f115-4c79-8ea7-802792d44639 完成，執行時間: 4.96秒
2025-01-23 07:58:46.646 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:58:46.648 [INFO] [python_ana_process_manager] id=UUID('592d1a62-6372-4d67-87fd-f2cd0fcfb587') created_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 691593) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 691593) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:58:46.650 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('592d1a62-6372-4d67-87fd-f2cd0fcfb587') created_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 691593) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 691593) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:58:48.054 [INFO] [python_ana_process_manager] Current Spark memory usage: 791.84MB
2025-01-23 07:58:48.054 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:58:48.182 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:58:50.782 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:58:51.230 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:58:52.176 [INFO] [python_ana_process_manager] Current Spark memory usage: 807.34MB
2025-01-23 07:58:52.177 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:58:52.311 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:58:52.537 [INFO] [python_ana_process_manager] 任務 a416ac66-caf5-4d8d-9ff8-f1df884cf5e1 完成
2025-01-23 07:58:52.537 [INFO] [python_ana_process_manager] 任務 a416ac66-caf5-4d8d-9ff8-f1df884cf5e1 完成，執行時間: 5.90秒
2025-01-23 07:58:52.970 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:58:53.322 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:58:53.354 [INFO] [python_ana_process_manager] 提交任務 1d1aec6f-39cd-4106-a0e2-dc67048173e8: _muti_process_run_test
2025-01-23 07:58:52.534 [INFO] [python_ana_trader] 任務 a416ac66-caf5-4d8d-9ff8-f1df884cf5e1 完成，執行時間: 4.97秒
2025-01-23 07:58:53.360 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:58:53.363 [INFO] [python_ana_process_manager] id=UUID('bdab7283-eea4-441b-ad51-0e0fac7851a0') created_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 976441) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 976441) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:58:53.364 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('bdab7283-eea4-441b-ad51-0e0fac7851a0') created_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 976441) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 23, 976441) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:58:55.250 [INFO] [python_ana_process_manager] Current Spark memory usage: 822.04MB
2025-01-23 07:58:55.251 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:58:55.443 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:58:57.981 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:58:58.498 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:58:59.310 [INFO] [python_ana_process_manager] 任務 1d1aec6f-39cd-4106-a0e2-dc67048173e8 完成
2025-01-23 07:58:59.341 [INFO] [python_ana_process_manager] 任務 1d1aec6f-39cd-4106-a0e2-dc67048173e8 完成，執行時間: 5.96秒
2025-01-23 07:58:59.771 [INFO] [python_ana_process_manager] Current Spark memory usage: 844.73MB
2025-01-23 07:58:59.772 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:58:59.898 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:59:00.474 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:00.928 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:00.950 [INFO] [python_ana_process_manager] 提交任務 6e1b107e-a3fb-4ade-a86b-d6e485c6d212: _muti_process_run_test
2025-01-23 07:58:59.271 [INFO] [python_ana_trader] 任務 1d1aec6f-39cd-4106-a0e2-dc67048173e8 完成，執行時間: 4.96秒
2025-01-23 07:59:00.962 [INFO] [python_ana_trader] 任務 6e1b107e-a3fb-4ade-a86b-d6e485c6d212 完成，執行時間: 0.01秒
2025-01-23 07:59:00.957 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:59:00.959 [INFO] [python_ana_process_manager] id=UUID('5d9e90d3-470b-436a-a722-a55fb9c57d35') created_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 243213) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 243213) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:59:00.961 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('5d9e90d3-470b-436a-a722-a55fb9c57d35') created_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 243213) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 243213) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:59:01.038 [INFO] [python_ana_process_manager] 任務 6e1b107e-a3fb-4ade-a86b-d6e485c6d212 完成
2025-01-23 07:59:01.099 [INFO] [python_ana_process_manager] 任務 6e1b107e-a3fb-4ade-a86b-d6e485c6d212 完成，執行時間: 0.09秒
2025-01-23 07:59:02.132 [INFO] [python_ana_process_manager] Current Spark memory usage: 776.62MB
2025-01-23 07:59:02.133 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:02.260 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:59:04.777 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:05.329 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:06.386 [INFO] [python_ana_process_manager] Current Spark memory usage: 838.07MB
2025-01-23 07:59:06.387 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:06.514 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:59:07.103 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:07.526 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:07.551 [INFO] [python_ana_process_manager] 提交任務 6be915bb-a5b8-4130-84e1-34529ad6a2e7: _muti_process_run_test
2025-01-23 07:59:07.565 [INFO] [python_ana_trader] 任務 6be915bb-a5b8-4130-84e1-34529ad6a2e7 完成，執行時間: 0.01秒
2025-01-23 07:59:07.556 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:59:07.559 [INFO] [python_ana_process_manager] id=UUID('aeb133a6-a483-4224-9118-69a08f4ca439') created_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 477331) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 477331) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:59:07.560 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('aeb133a6-a483-4224-9118-69a08f4ca439') created_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 477331) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 477331) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:59:07.604 [INFO] [python_ana_process_manager] 任務 6be915bb-a5b8-4130-84e1-34529ad6a2e7 完成
2025-01-23 07:59:07.633 [INFO] [python_ana_process_manager] 任務 6be915bb-a5b8-4130-84e1-34529ad6a2e7 完成，執行時間: 0.05秒
2025-01-23 07:59:08.637 [INFO] [python_ana_process_manager] Current Spark memory usage: 940.32MB
2025-01-23 07:59:08.638 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:08.756 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:59:11.243 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:11.817 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:13.462 [INFO] [python_ana_process_manager] Current Spark memory usage: 941.63MB
2025-01-23 07:59:13.463 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:13.592 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:59:14.189 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:14.604 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:14.630 [INFO] [python_ana_process_manager] 提交任務 a17d25c9-e465-41a1-b21b-4e8217efc536: _muti_process_run_test
2025-01-23 07:59:14.641 [INFO] [python_ana_trader] 任務 a17d25c9-e465-41a1-b21b-4e8217efc536 完成，執行時間: 0.01秒
2025-01-23 07:59:14.635 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:59:14.636 [INFO] [python_ana_process_manager] id=UUID('e1927293-2f12-4175-b12c-9b73a2b9b8c8') created_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 720538) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 720538) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:59:14.638 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('e1927293-2f12-4175-b12c-9b73a2b9b8c8') created_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 720538) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 720538) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:59:14.669 [INFO] [python_ana_process_manager] 任務 a17d25c9-e465-41a1-b21b-4e8217efc536 完成
2025-01-23 07:59:14.712 [INFO] [python_ana_process_manager] 任務 a17d25c9-e465-41a1-b21b-4e8217efc536 完成，執行時間: 0.04秒
2025-01-23 07:59:15.883 [INFO] [python_ana_process_manager] Current Spark memory usage: 946.51MB
2025-01-23 07:59:15.883 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:16.011 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:59:18.369 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:18.531 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:19.749 [INFO] [python_ana_process_manager] Current Spark memory usage: 946.40MB
2025-01-23 07:59:19.749 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:19.883 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:59:20.557 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:20.894 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:20.936 [INFO] [python_ana_process_manager] 提交任務 f26cfb6d-b123-4c01-8aff-45783dbfde9e: _muti_process_run_test
2025-01-23 07:59:20.956 [INFO] [python_ana_trader] 任務 f26cfb6d-b123-4c01-8aff-45783dbfde9e 完成，執行時間: 0.01秒
2025-01-23 07:59:20.944 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:59:20.947 [INFO] [python_ana_process_manager] id=UUID('a6c1516d-8aa1-4ebe-acfd-9c68228dd904') created_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 967425) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 967425) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:59:20.949 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('a6c1516d-8aa1-4ebe-acfd-9c68228dd904') created_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 967425) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 24, 967425) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:59:21.022 [INFO] [python_ana_process_manager] 任務 f26cfb6d-b123-4c01-8aff-45783dbfde9e 完成
2025-01-23 07:59:21.054 [INFO] [python_ana_process_manager] 任務 f26cfb6d-b123-4c01-8aff-45783dbfde9e 完成，執行時間: 0.09秒
2025-01-23 07:59:23.146 [INFO] [python_ana_process_manager] Current Spark memory usage: 895.99MB
2025-01-23 07:59:23.147 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:23.281 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:59:25.563 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:25.809 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:26.997 [INFO] [python_ana_process_manager] Current Spark memory usage: 895.85MB
2025-01-23 07:59:26.997 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:27.119 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:59:27.656 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:28.152 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:28.178 [INFO] [python_ana_process_manager] 提交任務 e6a47276-65f4-42eb-b0fa-5a15c604c007: _muti_process_run_test
2025-01-23 07:59:28.190 [INFO] [python_ana_trader] 任務 e6a47276-65f4-42eb-b0fa-5a15c604c007 完成，執行時間: 0.01秒
2025-01-23 07:59:28.184 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:59:28.185 [INFO] [python_ana_process_manager] id=UUID('4b1f9442-07cf-4c0f-ab11-996b1aca282b') created_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 226473) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 226473) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:59:28.187 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('4b1f9442-07cf-4c0f-ab11-996b1aca282b') created_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 226473) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 226473) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:59:28.276 [INFO] [python_ana_process_manager] 任務 e6a47276-65f4-42eb-b0fa-5a15c604c007 完成
2025-01-23 07:59:28.306 [INFO] [python_ana_process_manager] 任務 e6a47276-65f4-42eb-b0fa-5a15c604c007 完成，執行時間: 0.10秒
2025-01-23 07:59:29.317 [INFO] [python_ana_process_manager] Current Spark memory usage: 942.18MB
2025-01-23 07:59:29.317 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:29.435 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:59:31.592 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:31.973 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:33.500 [INFO] [python_ana_process_manager] Current Spark memory usage: 958.41MB
2025-01-23 07:59:33.501 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:33.634 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:59:34.197 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:34.666 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:34.696 [INFO] [python_ana_process_manager] 提交任務 324a88a0-51b2-43a5-893b-c0423f48c561: _muti_process_run_test
2025-01-23 07:59:34.709 [INFO] [python_ana_trader] 任務 324a88a0-51b2-43a5-893b-c0423f48c561 完成，執行時間: 0.01秒
2025-01-23 07:59:34.701 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:59:34.703 [INFO] [python_ana_process_manager] id=UUID('3497f46a-761e-4439-b29c-0456abaf9755') created_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 481864) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 481864) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:59:34.704 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('3497f46a-761e-4439-b29c-0456abaf9755') created_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 481864) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 481864) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:59:34.775 [INFO] [python_ana_process_manager] 任務 324a88a0-51b2-43a5-893b-c0423f48c561 完成
2025-01-23 07:59:34.806 [INFO] [python_ana_process_manager] 任務 324a88a0-51b2-43a5-893b-c0423f48c561 完成，執行時間: 0.08秒
2025-01-23 07:59:36.115 [INFO] [python_ana_process_manager] Current Spark memory usage: 964.26MB
2025-01-23 07:59:36.116 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:36.234 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:59:38.493 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:38.786 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:41.112 [INFO] [python_ana_process_manager] Current Spark memory usage: 1018.20MB
2025-01-23 07:59:41.113 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:41.243 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 07:59:41.953 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:42.264 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 07:59:42.304 [INFO] [python_ana_process_manager] 提交任務 8abc2448-328f-420c-b961-b8883e879b94: _muti_process_run_test
2025-01-23 07:59:42.319 [INFO] [python_ana_trader] 任務 8abc2448-328f-420c-b961-b8883e879b94 完成，執行時間: 0.01秒
2025-01-23 07:59:42.311 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 07:59:42.313 [INFO] [python_ana_process_manager] id=UUID('4aec2514-f2e0-47b5-b992-c963c68c3de3') created_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 722338) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 722338) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 07:59:42.315 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('4aec2514-f2e0-47b5-b992-c963c68c3de3') created_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 722338) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 722338) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 07:59:42.377 [INFO] [python_ana_process_manager] 任務 8abc2448-328f-420c-b961-b8883e879b94 完成
2025-01-23 07:59:42.413 [INFO] [python_ana_process_manager] 任務 8abc2448-328f-420c-b961-b8883e879b94 完成，執行時間: 0.07秒
2025-01-23 07:59:44.295 [INFO] [python_ana_process_manager] Current Spark memory usage: 1039.57MB
2025-01-23 07:59:44.295 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 07:59:44.296 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 07:59:47.179 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 07:59:47.179 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 07:59:50.203 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 07:59:59.560 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 07:59:59.787 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:00:00.929 [INFO] [python_ana_process_manager] Current Spark memory usage: 590.58MB
2025-01-23 08:00:00.929 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:00:01.065 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:00:02.198 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:00:02.596 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:00:02.622 [INFO] [python_ana_process_manager] 提交任務 4c714a81-3d0a-41a9-aec4-b9eb8f55e2a5: _muti_process_run_test
2025-01-23 08:00:02.636 [INFO] [python_ana_trader] 任務 4c714a81-3d0a-41a9-aec4-b9eb8f55e2a5 完成，執行時間: 0.01秒
2025-01-23 08:00:02.628 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:00:02.630 [INFO] [python_ana_process_manager] id=UUID('87dee772-d09e-42ce-803d-806867eb4de7') created_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 969800) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 969800) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:00:02.632 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('87dee772-d09e-42ce-803d-806867eb4de7') created_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 969800) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 25, 969800) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:00:02.724 [INFO] [python_ana_process_manager] 任務 4c714a81-3d0a-41a9-aec4-b9eb8f55e2a5 完成
2025-01-23 08:00:02.749 [INFO] [python_ana_process_manager] 任務 4c714a81-3d0a-41a9-aec4-b9eb8f55e2a5 完成，執行時間: 0.10秒
2025-01-23 08:00:05.379 [INFO] [python_ana_process_manager] Current Spark memory usage: 553.02MB
2025-01-23 08:00:05.380 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:00:05.523 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:00:09.198 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:00:09.601 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:00:11.940 [INFO] [python_ana_process_manager] Current Spark memory usage: 692.62MB
2025-01-23 08:00:11.941 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:00:12.081 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:00:12.794 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:00:13.084 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:00:13.122 [INFO] [python_ana_process_manager] 提交任務 eb16cdba-abec-47d9-8f85-e4e508323841: _muti_process_run_test
2025-01-23 08:00:13.138 [INFO] [python_ana_trader] 任務 eb16cdba-abec-47d9-8f85-e4e508323841 完成，執行時間: 0.01秒
2025-01-23 08:00:13.129 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:00:13.132 [INFO] [python_ana_process_manager] id=UUID('a4f40678-6532-4335-a8c1-91a465f46aa5') created_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 216816) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 216816) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:00:13.134 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('a4f40678-6532-4335-a8c1-91a465f46aa5') created_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 216816) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 216816) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:00:13.224 [INFO] [python_ana_process_manager] 任務 eb16cdba-abec-47d9-8f85-e4e508323841 完成
2025-01-23 08:00:13.269 [INFO] [python_ana_process_manager] 任務 eb16cdba-abec-47d9-8f85-e4e508323841 完成，執行時間: 0.10秒
2025-01-23 08:00:14.410 [INFO] [python_ana_process_manager] Current Spark memory usage: 633.88MB
2025-01-23 08:00:14.410 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:00:14.536 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:00:17.501 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:00:17.598 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:00:19.671 [INFO] [python_ana_process_manager] Current Spark memory usage: 816.52MB
2025-01-23 08:00:19.672 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:00:19.814 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:00:20.480 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:00:20.840 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:00:20.865 [INFO] [python_ana_process_manager] 提交任務 4bb7eb85-75cf-4e61-a0bd-1edc7284f9a4: _muti_process_run_test
2025-01-23 08:00:20.878 [INFO] [python_ana_trader] 任務 4bb7eb85-75cf-4e61-a0bd-1edc7284f9a4 完成，執行時間: 0.01秒
2025-01-23 08:00:20.873 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:00:20.877 [INFO] [python_ana_process_manager] id=UUID('0c5e3f76-5026-44ee-a42a-9d19270d6c41') created_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 442135) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 442135) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:00:20.878 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('0c5e3f76-5026-44ee-a42a-9d19270d6c41') created_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 442135) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 442135) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:00:20.881 [INFO] [python_ana_process_manager] 任務 4bb7eb85-75cf-4e61-a0bd-1edc7284f9a4 完成
2025-01-23 08:00:20.915 [INFO] [python_ana_process_manager] 任務 4bb7eb85-75cf-4e61-a0bd-1edc7284f9a4 完成，執行時間: 0.02秒
2025-01-23 08:00:22.108 [INFO] [python_ana_process_manager] Current Spark memory usage: 848.59MB
2025-01-23 08:00:22.108 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:00:22.232 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:00:24.754 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:00:25.272 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:00:26.661 [INFO] [python_ana_process_manager] Current Spark memory usage: 881.45MB
2025-01-23 08:00:26.661 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:00:26.790 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:00:27.359 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:00:27.805 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:00:27.831 [INFO] [python_ana_process_manager] 提交任務 8d7d5004-18a2-47e8-9877-fe90fec55cfa: _muti_process_run_test
2025-01-23 08:00:27.846 [INFO] [python_ana_trader] 任務 8d7d5004-18a2-47e8-9877-fe90fec55cfa 完成，執行時間: 0.01秒
2025-01-23 08:00:27.838 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:00:27.840 [INFO] [python_ana_process_manager] id=UUID('2de36342-7fbd-46c7-b314-797cfca8781c') created_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 673594) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 673594) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:00:27.842 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('2de36342-7fbd-46c7-b314-797cfca8781c') created_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 673594) updated_at=datetime.datetime(2025, 1, 23, 7, 58, 26, 673594) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:00:27.915 [INFO] [python_ana_process_manager] 任務 8d7d5004-18a2-47e8-9877-fe90fec55cfa 完成
2025-01-23 08:00:27.950 [INFO] [python_ana_process_manager] 任務 8d7d5004-18a2-47e8-9877-fe90fec55cfa 完成，執行時間: 0.08秒
2025-01-23 08:00:29.179 [INFO] [python_ana_process_manager] Current Spark memory usage: 820.54MB
2025-01-23 08:00:29.180 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:00:29.304 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:00:31.718 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:00:31.863 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:00:33.210 [INFO] [python_ana_process_manager] Current Spark memory usage: 878.56MB
2025-01-23 08:00:33.211 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:00:33.334 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:00:33.962 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:00:34.341 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:00:34.369 [INFO] [python_ana_process_manager] 提交任務 88ad1952-19ef-4178-9040-132969d04b09: _muti_process_run_test
2025-01-23 08:00:34.382 [INFO] [python_ana_trader] 任務 88ad1952-19ef-4178-9040-132969d04b09 完成，執行時間: 0.01秒
2025-01-23 08:00:34.386 [INFO] [python_ana_process_manager] 任務 88ad1952-19ef-4178-9040-132969d04b09 完成
2025-01-23 08:00:34.386 [INFO] [python_ana_process_manager] 任務 88ad1952-19ef-4178-9040-132969d04b09 完成，執行時間: 0.02秒
2025-01-23 08:01:45.505 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:01:45.508 [INFO] [python_ana_process_manager] id=UUID('46d34f7e-dccb-4a6a-9754-7cd83eb0c8ad') created_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 502703) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 502703) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:01:45.510 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('46d34f7e-dccb-4a6a-9754-7cd83eb0c8ad') created_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 502703) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 502703) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:01:46.685 [INFO] [python_ana_process_manager] Current Spark memory usage: 825.29MB
2025-01-23 08:01:46.686 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:01:46.812 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:01:49.157 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:01:49.370 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:01:50.655 [INFO] [python_ana_process_manager] Current Spark memory usage: 856.39MB
2025-01-23 08:01:50.655 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:01:50.774 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:01:51.395 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:01:51.785 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:01:51.811 [INFO] [python_ana_process_manager] 提交任務 fc873272-f99b-445d-92fe-f4e0625a34b4: _muti_process_run_test
2025-01-23 08:01:51.822 [INFO] [python_ana_trader] 任務 fc873272-f99b-445d-92fe-f4e0625a34b4 完成，執行時間: 0.01秒
2025-01-23 08:01:51.816 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:01:51.817 [INFO] [python_ana_process_manager] id=UUID('698f351a-633f-4841-b44d-fd9259273828') created_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 755573) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 755573) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:01:51.818 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('698f351a-633f-4841-b44d-fd9259273828') created_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 755573) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 755573) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:01:51.926 [INFO] [python_ana_process_manager] 任務 fc873272-f99b-445d-92fe-f4e0625a34b4 完成
2025-01-23 08:01:51.954 [INFO] [python_ana_process_manager] 任務 fc873272-f99b-445d-92fe-f4e0625a34b4 完成，執行時間: 0.12秒
2025-01-23 08:01:52.852 [INFO] [python_ana_process_manager] Current Spark memory usage: 876.99MB
2025-01-23 08:01:52.853 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:01:52.969 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:01:55.222 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:01:55.492 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:01:56.551 [INFO] [python_ana_process_manager] Current Spark memory usage: 915.67MB
2025-01-23 08:01:56.552 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:01:56.669 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:01:57.223 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:01:57.723 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:01:57.749 [INFO] [python_ana_process_manager] 提交任務 4b2f5e38-83b9-4aac-b6f8-0ff7fd1067af: _muti_process_run_test
2025-01-23 08:01:57.761 [INFO] [python_ana_trader] 任務 4b2f5e38-83b9-4aac-b6f8-0ff7fd1067af 完成，執行時間: 0.01秒
2025-01-23 08:01:57.755 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:01:57.757 [INFO] [python_ana_process_manager] id=UUID('ecdc7bf1-cf3c-4140-8b3c-58bbfeeb2172') created_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 952974) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 952974) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:01:57.758 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('ecdc7bf1-cf3c-4140-8b3c-58bbfeeb2172') created_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 952974) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 45, 952974) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:01:57.833 [INFO] [python_ana_process_manager] 任務 4b2f5e38-83b9-4aac-b6f8-0ff7fd1067af 完成
2025-01-23 08:01:57.892 [INFO] [python_ana_process_manager] 任務 4b2f5e38-83b9-4aac-b6f8-0ff7fd1067af 完成，執行時間: 0.08秒
2025-01-23 08:01:58.964 [INFO] [python_ana_process_manager] Current Spark memory usage: 917.39MB
2025-01-23 08:01:58.965 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:01:59.081 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:02:01.316 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:01.640 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:02.903 [INFO] [python_ana_process_manager] Current Spark memory usage: 898.11MB
2025-01-23 08:02:02.904 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:03.029 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:02:03.651 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:04.042 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:04.086 [INFO] [python_ana_process_manager] 提交任務 ce48358c-c5ac-4788-8745-d0131164faea: _muti_process_run_test
2025-01-23 08:02:04.099 [INFO] [python_ana_trader] 任務 ce48358c-c5ac-4788-8745-d0131164faea 完成，執行時間: 0.01秒
2025-01-23 08:02:04.090 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:02:04.092 [INFO] [python_ana_process_manager] id=UUID('30a56b91-3a1a-447f-972e-a7376b33cfb2') created_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 142741) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 142741) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:02:04.094 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('30a56b91-3a1a-447f-972e-a7376b33cfb2') created_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 142741) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 142741) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:02:04.164 [INFO] [python_ana_process_manager] 任務 ce48358c-c5ac-4788-8745-d0131164faea 完成
2025-01-23 08:02:04.211 [INFO] [python_ana_process_manager] 任務 ce48358c-c5ac-4788-8745-d0131164faea 完成，執行時間: 0.08秒
2025-01-23 08:02:05.954 [INFO] [python_ana_process_manager] Current Spark memory usage: 843.50MB
2025-01-23 08:02:05.955 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:06.085 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:02:08.482 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:08.628 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:10.042 [INFO] [python_ana_process_manager] Current Spark memory usage: 890.43MB
2025-01-23 08:02:10.043 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:10.164 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:02:10.795 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:11.175 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:11.201 [INFO] [python_ana_process_manager] 提交任務 070995c9-ab77-45f8-9cc3-f4452c256ca1: _muti_process_run_test
2025-01-23 08:02:11.211 [INFO] [python_ana_trader] 任務 070995c9-ab77-45f8-9cc3-f4452c256ca1 完成，執行時間: 0.01秒
2025-01-23 08:02:11.206 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:02:11.208 [INFO] [python_ana_process_manager] id=UUID('e35682e0-0b33-4452-83ed-4ed45c384ca1') created_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 339762) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 339762) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:02:11.209 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('e35682e0-0b33-4452-83ed-4ed45c384ca1') created_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 339762) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 339762) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:02:11.284 [INFO] [python_ana_process_manager] 任務 070995c9-ab77-45f8-9cc3-f4452c256ca1 完成
2025-01-23 08:02:11.315 [INFO] [python_ana_process_manager] 任務 070995c9-ab77-45f8-9cc3-f4452c256ca1 完成，執行時間: 0.08秒
2025-01-23 08:02:12.290 [INFO] [python_ana_process_manager] Current Spark memory usage: 900.03MB
2025-01-23 08:02:12.290 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:12.406 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:02:14.852 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:14.960 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:16.197 [INFO] [python_ana_process_manager] Current Spark memory usage: 887.90MB
2025-01-23 08:02:16.197 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:16.314 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:02:16.901 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:17.338 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:17.364 [INFO] [python_ana_process_manager] 提交任務 fac340e1-cfb2-4699-8165-bd2902c1baf3: _muti_process_run_test
2025-01-23 08:02:17.377 [INFO] [python_ana_trader] 任務 fac340e1-cfb2-4699-8165-bd2902c1baf3 完成，執行時間: 0.01秒
2025-01-23 08:02:17.369 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:02:17.371 [INFO] [python_ana_process_manager] id=UUID('3b75110e-4d3a-44b4-90bc-91d07290e5c3') created_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 521126) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 521126) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:02:17.372 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('3b75110e-4d3a-44b4-90bc-91d07290e5c3') created_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 521126) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 521126) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:02:17.433 [INFO] [python_ana_process_manager] 任務 fac340e1-cfb2-4699-8165-bd2902c1baf3 完成
2025-01-23 08:02:17.480 [INFO] [python_ana_process_manager] 任務 fac340e1-cfb2-4699-8165-bd2902c1baf3 完成，執行時間: 0.07秒
2025-01-23 08:02:18.603 [INFO] [python_ana_process_manager] Current Spark memory usage: 906.58MB
2025-01-23 08:02:18.603 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:18.721 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:02:21.044 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:21.244 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:22.340 [INFO] [python_ana_process_manager] Current Spark memory usage: 1020.34MB
2025-01-23 08:02:22.340 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:22.455 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:02:23.041 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:23.485 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:23.512 [INFO] [python_ana_process_manager] 提交任務 f59605a8-0452-44cb-b2ac-c0e746fc9020: _muti_process_run_test
2025-01-23 08:02:23.524 [INFO] [python_ana_trader] 任務 f59605a8-0452-44cb-b2ac-c0e746fc9020 完成，執行時間: 0.01秒
2025-01-23 08:02:23.517 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:02:23.518 [INFO] [python_ana_process_manager] id=UUID('737b537f-de8d-4eb1-af76-1a18edb9b6d0') created_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 744760) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 744760) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:02:23.520 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('737b537f-de8d-4eb1-af76-1a18edb9b6d0') created_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 744760) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 744760) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:02:23.578 [INFO] [python_ana_process_manager] 任務 f59605a8-0452-44cb-b2ac-c0e746fc9020 完成
2025-01-23 08:02:23.611 [INFO] [python_ana_process_manager] 任務 f59605a8-0452-44cb-b2ac-c0e746fc9020 完成，執行時間: 0.07秒
2025-01-23 08:02:24.751 [INFO] [python_ana_process_manager] Current Spark memory usage: 1012.63MB
2025-01-23 08:02:24.752 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:24.869 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:02:27.063 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:27.419 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:28.578 [INFO] [python_ana_process_manager] Current Spark memory usage: 1071.00MB
2025-01-23 08:02:28.579 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:02:28.579 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:02:31.088 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:02:31.088 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:33.837 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:02:38.839 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:39.346 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:39.374 [INFO] [python_ana_process_manager] 提交任務 bb6cf711-08ec-4a0e-9b7a-e859aa111e4e: _muti_process_run_test
2025-01-23 08:02:39.387 [INFO] [python_ana_trader] 任務 bb6cf711-08ec-4a0e-9b7a-e859aa111e4e 完成，執行時間: 0.01秒
2025-01-23 08:02:39.379 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 收到消息，開始解析
2025-01-23 08:02:39.381 [INFO] [python_ana_process_manager] id=UUID('113dbc56-847a-477a-9946-04c5a31b1725') created_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 952527) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 952527) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:02:39.382 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f5e5f946 解析後消息為: id=UUID('113dbc56-847a-477a-9946-04c5a31b1725') created_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 952527) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 46, 952527) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:02:39.533 [INFO] [python_ana_process_manager] 任務 bb6cf711-08ec-4a0e-9b7a-e859aa111e4e 完成
2025-01-23 08:02:39.565 [INFO] [python_ana_process_manager] 任務 bb6cf711-08ec-4a0e-9b7a-e859aa111e4e 完成，執行時間: 0.16秒
2025-01-23 08:02:40.628 [INFO] [python_ana_process_manager] Current Spark memory usage: 536.50MB
2025-01-23 08:02:40.629 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:40.771 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:02:46.381 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:46.892 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:48.240 [INFO] [python_ana_process_manager] Current Spark memory usage: 688.49MB
2025-01-23 08:02:48.240 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:02:48.370 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:02:49.164 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:02:49.382 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:02:49.409 [INFO] [python_ana_process_manager] 提交任務 e6a1b126-bee7-42c0-bb92-92a234d4ceb3: _muti_process_run_test
2025-01-23 08:02:49.421 [INFO] [python_ana_trader] 任務 e6a1b126-bee7-42c0-bb92-92a234d4ceb3 完成，執行時間: 0.01秒
2025-01-23 08:06:51.719 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-01-23 08:06:56.735 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_16fd2bbb 開始消費隊列 full_backtest
2025-01-23 08:06:56.735 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_16fd2bbb 線程已啟動
2025-01-23 08:06:56.736 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_9db27d6b 開始消費隊列 pre_process_stock_data
2025-01-23 08:06:56.736 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_9db27d6b 線程已啟動
2025-01-23 08:06:56.737 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_51e5e214 開始消費隊列 back_testing
2025-01-23 08:06:56.737 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_51e5e214 線程已啟動
2025-01-23 08:07:01.727 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 收到消息，開始解析
2025-01-23 08:07:01.730 [INFO] [python_ana_process_manager] id=UUID('a50a73b7-f892-4511-88b7-f27d0b46eb90') created_at=datetime.datetime(2025, 1, 23, 8, 1, 47, 167576) updated_at=datetime.datetime(2025, 1, 23, 8, 6, 30, 495162) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message="讀取數據時發生錯誤: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext code='2317' candle='d1' start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)) end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))" sink_params=None set_params=None
2025-01-23 08:07:01.731 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 解析後消息為: id=UUID('a50a73b7-f892-4511-88b7-f27d0b46eb90') created_at=datetime.datetime(2025, 1, 23, 8, 1, 47, 167576) updated_at=datetime.datetime(2025, 1, 23, 8, 6, 30, 495162) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message="讀取數據時發生錯誤: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext code='2317' candle='d1' start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)) end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))" sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:07:04.422 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:07.394 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:07:16.985 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:17.516 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:18.935 [INFO] [python_ana_process_manager] Current Spark memory usage: 654.96MB
2025-01-23 08:07:18.936 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:19.083 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:07:20.463 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:20.614 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:20.640 [INFO] [python_ana_process_manager] 提交任務 fc1999a0-21b2-423b-a3d5-2b24c5cc004e: _muti_process_run_test
2025-01-23 08:07:20.646 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 收到消息，開始解析
2025-01-23 08:07:20.648 [INFO] [python_ana_process_manager] id=UUID('28a96296-d761-415d-bf7e-feae53796fd1') created_at=datetime.datetime(2025, 1, 23, 8, 1, 47, 425760) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 47, 425760) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:07:20.650 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 解析後消息為: id=UUID('28a96296-d761-415d-bf7e-feae53796fd1') created_at=datetime.datetime(2025, 1, 23, 8, 1, 47, 425760) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 47, 425760) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:07:22.237 [INFO] [python_ana_process_manager] Current Spark memory usage: 649.01MB
2025-01-23 08:07:22.238 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:22.376 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:07:25.454 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:25.937 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:26.578 [INFO] [python_ana_process_manager] 任務 fc1999a0-21b2-423b-a3d5-2b24c5cc004e 完成
2025-01-23 08:07:26.655 [INFO] [python_ana_process_manager] 任務 fc1999a0-21b2-423b-a3d5-2b24c5cc004e 完成，執行時間: 5.94秒
2025-01-23 08:07:27.430 [INFO] [python_ana_process_manager] Current Spark memory usage: 702.22MB
2025-01-23 08:07:27.431 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:27.562 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:07:28.240 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:28.579 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:28.607 [INFO] [python_ana_process_manager] 提交任務 49321714-94cc-4d01-afa3-09513d789b85: _muti_process_run_test
2025-01-23 08:07:26.524 [INFO] [python_ana_trader] 任務 fc1999a0-21b2-423b-a3d5-2b24c5cc004e 完成，執行時間: 4.95秒
2025-01-23 08:07:28.612 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 收到消息，開始解析
2025-01-23 08:07:28.613 [INFO] [python_ana_process_manager] id=UUID('df4d4b5e-f69c-4bc6-8820-7f61ccc97580') created_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 379990) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 379990) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:07:28.615 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 解析後消息為: id=UUID('df4d4b5e-f69c-4bc6-8820-7f61ccc97580') created_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 379990) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 379990) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:07:30.264 [INFO] [python_ana_process_manager] Current Spark memory usage: 697.60MB
2025-01-23 08:07:30.264 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:30.402 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:07:33.255 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:33.444 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:34.549 [INFO] [python_ana_process_manager] 任務 49321714-94cc-4d01-afa3-09513d789b85 完成
2025-01-23 08:07:34.581 [INFO] [python_ana_process_manager] 任務 49321714-94cc-4d01-afa3-09513d789b85 完成，執行時間: 5.94秒
2025-01-23 08:07:34.806 [INFO] [python_ana_process_manager] Current Spark memory usage: 868.27MB
2025-01-23 08:07:34.806 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:34.940 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:07:35.561 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:35.966 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:35.993 [INFO] [python_ana_process_manager] 提交任務 4fa83853-0a75-4a3c-a630-e50716544bab: _muti_process_run_test
2025-01-23 08:07:34.511 [INFO] [python_ana_trader] 任務 49321714-94cc-4d01-afa3-09513d789b85 完成，執行時間: 4.96秒
2025-01-23 08:07:35.999 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 收到消息，開始解析
2025-01-23 08:07:36.001 [INFO] [python_ana_process_manager] id=UUID('bee7c6c5-3a21-4636-aec2-9cc7be2f085f') created_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 576887) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 576887) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:07:36.002 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 解析後消息為: id=UUID('bee7c6c5-3a21-4636-aec2-9cc7be2f085f') created_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 576887) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 576887) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:07:37.638 [INFO] [python_ana_process_manager] Current Spark memory usage: 845.72MB
2025-01-23 08:07:37.638 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:37.770 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:07:40.185 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:40.304 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:41.671 [INFO] [python_ana_process_manager] Current Spark memory usage: 827.66MB
2025-01-23 08:07:41.672 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:41.805 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:07:41.914 [INFO] [python_ana_process_manager] 任務 4fa83853-0a75-4a3c-a630-e50716544bab 完成
2025-01-23 08:07:41.914 [INFO] [python_ana_process_manager] 任務 4fa83853-0a75-4a3c-a630-e50716544bab 完成，執行時間: 5.92秒
2025-01-23 08:07:42.423 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:42.838 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:42.864 [INFO] [python_ana_process_manager] 提交任務 2ac31784-589a-4ed2-a178-af94ecd22fc1: _muti_process_run_test
2025-01-23 08:07:42.876 [INFO] [python_ana_trader] 任務 2ac31784-589a-4ed2-a178-af94ecd22fc1 完成，執行時間: 0.01秒
2025-01-23 08:07:41.911 [INFO] [python_ana_trader] 任務 4fa83853-0a75-4a3c-a630-e50716544bab 完成，執行時間: 4.94秒
2025-01-23 08:07:42.870 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 收到消息，開始解析
2025-01-23 08:07:42.872 [INFO] [python_ana_process_manager] id=UUID('bcf27b69-ba86-4e97-a4de-83a9f0d1e8d3') created_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 828886) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 828886) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:07:42.873 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 解析後消息為: id=UUID('bcf27b69-ba86-4e97-a4de-83a9f0d1e8d3') created_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 828886) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 48, 828886) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:07:42.966 [INFO] [python_ana_process_manager] 任務 2ac31784-589a-4ed2-a178-af94ecd22fc1 完成
2025-01-23 08:07:43.010 [INFO] [python_ana_process_manager] 任務 2ac31784-589a-4ed2-a178-af94ecd22fc1 完成，執行時間: 0.10秒
2025-01-23 08:07:44.307 [INFO] [python_ana_process_manager] Current Spark memory usage: 878.71MB
2025-01-23 08:07:44.307 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:44.430 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:07:46.804 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:46.963 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:48.476 [INFO] [python_ana_process_manager] Current Spark memory usage: 894.85MB
2025-01-23 08:07:48.477 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:48.606 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:07:49.204 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:49.617 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:49.643 [INFO] [python_ana_process_manager] 提交任務 ffcd9ff2-9fac-4b7b-b528-55dededef8cb: _muti_process_run_test
2025-01-23 08:07:49.655 [INFO] [python_ana_trader] 任務 ffcd9ff2-9fac-4b7b-b528-55dededef8cb 完成，執行時間: 0.01秒
2025-01-23 08:07:49.648 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 收到消息，開始解析
2025-01-23 08:07:49.650 [INFO] [python_ana_process_manager] id=UUID('05020608-a459-4921-a674-34b23b2907b2') created_at=datetime.datetime(2025, 1, 23, 8, 1, 49, 61020) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 49, 61020) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:07:49.651 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 解析後消息為: id=UUID('05020608-a459-4921-a674-34b23b2907b2') created_at=datetime.datetime(2025, 1, 23, 8, 1, 49, 61020) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 49, 61020) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:07:49.713 [INFO] [python_ana_process_manager] 任務 ffcd9ff2-9fac-4b7b-b528-55dededef8cb 完成
2025-01-23 08:07:49.758 [INFO] [python_ana_process_manager] 任務 ffcd9ff2-9fac-4b7b-b528-55dededef8cb 完成，執行時間: 0.07秒
2025-01-23 08:07:51.164 [INFO] [python_ana_process_manager] Current Spark memory usage: 838.79MB
2025-01-23 08:07:51.165 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:07:51.292 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:07:53.640 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:07:53.836 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:07:55.191 [INFO] [python_ana_process_manager] Current Spark memory usage: 1043.62MB
2025-01-23 08:07:55.191 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:07:55.192 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:07:57.923 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:07:57.923 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:08:00.713 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:08:05.796 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:08:06.235 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:08:06.261 [INFO] [python_ana_process_manager] 提交任務 18f1bf10-ee0d-40b6-9344-bf041087ec21: _muti_process_run_test
2025-01-23 08:08:06.274 [INFO] [python_ana_trader] 任務 18f1bf10-ee0d-40b6-9344-bf041087ec21 完成，執行時間: 0.01秒
2025-01-23 08:08:06.267 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 收到消息，開始解析
2025-01-23 08:08:06.268 [INFO] [python_ana_process_manager] id=UUID('f093d02e-ec99-46e8-9a98-dfbf22b301ad') created_at=datetime.datetime(2025, 1, 23, 8, 1, 49, 303770) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 49, 303770) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:08:06.269 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_16fd2bbb 解析後消息為: id=UUID('f093d02e-ec99-46e8-9a98-dfbf22b301ad') created_at=datetime.datetime(2025, 1, 23, 8, 1, 49, 303770) updated_at=datetime.datetime(2025, 1, 23, 8, 1, 49, 303770) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:08:06.358 [INFO] [python_ana_process_manager] 任務 18f1bf10-ee0d-40b6-9344-bf041087ec21 完成
2025-01-23 08:08:06.389 [INFO] [python_ana_process_manager] 任務 18f1bf10-ee0d-40b6-9344-bf041087ec21 完成，執行時間: 0.10秒
2025-01-23 08:08:07.420 [INFO] [python_ana_process_manager] Current Spark memory usage: 508.58MB
2025-01-23 08:08:07.421 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:08:07.588 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:08:13.427 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:08:13.685 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:08:14.719 [INFO] [python_ana_process_manager] Current Spark memory usage: 550.81MB
2025-01-23 08:08:14.720 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:08:14.853 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:08:15.640 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:08:15.868 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:08:15.894 [INFO] [python_ana_process_manager] 提交任務 a1e8e7ec-e138-407f-a3df-2779916bbfc4: _muti_process_run_test
2025-01-23 08:08:15.905 [INFO] [python_ana_trader] 任務 a1e8e7ec-e138-407f-a3df-2779916bbfc4 完成，執行時間: 0.01秒
2025-01-23 08:08:15.908 [INFO] [python_ana_process_manager] 任務 a1e8e7ec-e138-407f-a3df-2779916bbfc4 完成
2025-01-23 08:08:15.908 [INFO] [python_ana_process_manager] 任務 a1e8e7ec-e138-407f-a3df-2779916bbfc4 完成，執行時間: 0.01秒
2025-01-23 08:08:35.937 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_16fd2bbb
2025-01-23 08:08:35.938 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_16fd2bbb 正在停止
2025-01-23 08:08:35.938 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_16fd2bbb 已完全停止
2025-01-23 08:08:35.939 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_9db27d6b
2025-01-23 08:08:35.940 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_9db27d6b 正在停止
2025-01-23 08:08:35.940 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_9db27d6b 已完全停止
2025-01-23 08:08:35.941 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_51e5e214
2025-01-23 08:08:35.941 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_51e5e214 正在停止
2025-01-23 08:08:35.941 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_51e5e214 已完全停止
2025-01-23 08:09:08.878 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 2
2025-01-23 08:09:13.881 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_789c9426 開始消費隊列 full_backtest
2025-01-23 08:09:13.881 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_789c9426 線程已啟動
2025-01-23 08:09:13.882 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_3a48e25c 開始消費隊列 pre_process_stock_data
2025-01-23 08:09:13.882 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_3a48e25c 線程已啟動
2025-01-23 08:09:13.883 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_c7a2c26c 開始消費隊列 back_testing
2025-01-23 08:09:13.883 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_c7a2c26c 線程已啟動
2025-01-23 08:09:20.127 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 收到消息，開始解析
2025-01-23 08:09:20.129 [INFO] [python_ana_process_manager] id=UUID('f994b18b-0c2a-45d7-ae2a-dafd0896d6ba') created_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 122624) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 122624) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:09:20.131 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 解析後消息為: id=UUID('f994b18b-0c2a-45d7-ae2a-dafd0896d6ba') created_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 122624) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 122624) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:09:22.228 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:09:25.080 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:09:34.347 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:09:34.671 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:09:36.156 [INFO] [python_ana_process_manager] Current Spark memory usage: 765.39MB
2025-01-23 08:09:36.156 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:09:36.157 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:09:38.703 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:09:38.703 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:09:41.431 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:09:46.602 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:09:46.948 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:09:46.975 [INFO] [python_ana_process_manager] 提交任務 3098f9f2-cbed-4619-b586-694316ee9170: _muti_process_run_test
2025-01-23 08:09:52.834 [INFO] [python_ana_trader] 任務 3098f9f2-cbed-4619-b586-694316ee9170 完成，執行時間: 4.96秒
2025-01-23 08:09:46.982 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 收到消息，開始解析
2025-01-23 08:09:46.983 [INFO] [python_ana_process_manager] id=UUID('33c0a8b0-3778-47dd-b5e1-d562b7213475') created_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 487007) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 487007) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:09:46.985 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 解析後消息為: id=UUID('33c0a8b0-3778-47dd-b5e1-d562b7213475') created_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 487007) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 487007) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:09:47.145 [INFO] [python_ana_process_manager] Current Spark memory usage: 553.04MB
2025-01-23 08:09:47.145 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:09:47.145 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:09:49.794 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:09:49.794 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:09:52.519 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:09:52.837 [INFO] [python_ana_process_manager] 任務 3098f9f2-cbed-4619-b586-694316ee9170 完成
2025-01-23 08:09:52.837 [INFO] [python_ana_process_manager] 任務 3098f9f2-cbed-4619-b586-694316ee9170 完成，執行時間: 5.86秒
2025-01-23 08:10:01.910 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:10:02.184 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:10:03.325 [INFO] [python_ana_process_manager] Current Spark memory usage: 683.45MB
2025-01-23 08:10:03.326 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:10:03.326 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:10:05.843 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:10:05.843 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:10:08.571 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:10:13.528 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:10:14.087 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:10:14.114 [INFO] [python_ana_process_manager] 提交任務 c4e249ff-3bdc-4bd5-bb16-5e2f32775e55: _muti_process_run_test
2025-01-23 08:10:19.975 [INFO] [python_ana_trader] 任務 c4e249ff-3bdc-4bd5-bb16-5e2f32775e55 完成，執行時間: 4.96秒
2025-01-23 08:10:14.120 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 收到消息，開始解析
2025-01-23 08:10:14.122 [INFO] [python_ana_process_manager] id=UUID('f7fb0731-57e8-4487-9e01-96306541b089') created_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 788078) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 788078) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:10:14.123 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 解析後消息為: id=UUID('f7fb0731-57e8-4487-9e01-96306541b089') created_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 788078) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 20, 788078) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:10:15.555 [INFO] [python_ana_process_manager] Current Spark memory usage: 517.66MB
2025-01-23 08:10:15.555 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:10:15.556 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:10:18.169 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:10:18.169 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:10:19.978 [INFO] [python_ana_process_manager] 任務 c4e249ff-3bdc-4bd5-bb16-5e2f32775e55 完成
2025-01-23 08:10:19.978 [INFO] [python_ana_process_manager] 任務 c4e249ff-3bdc-4bd5-bb16-5e2f32775e55 完成，執行時間: 5.86秒
2025-01-23 08:10:20.954 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:10:30.469 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:10:30.576 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:10:31.499 [INFO] [python_ana_process_manager] Current Spark memory usage: 708.35MB
2025-01-23 08:10:31.499 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:10:31.500 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:10:34.068 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:10:34.068 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:10:36.861 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:10:41.849 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:10:42.384 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:10:42.413 [INFO] [python_ana_process_manager] 提交任務 56f7c505-648c-418f-b6f0-f3e7d9680fc8: _muti_process_run_test
2025-01-23 08:10:42.429 [INFO] [python_ana_trader] 任務 56f7c505-648c-418f-b6f0-f3e7d9680fc8 完成，執行時間: 0.01秒
2025-01-23 08:10:42.419 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 收到消息，開始解析
2025-01-23 08:10:42.422 [INFO] [python_ana_process_manager] id=UUID('80359633-c9d7-4c69-93a6-7e791bab5b6d') created_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 102300) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 102300) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:10:42.424 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 解析後消息為: id=UUID('80359633-c9d7-4c69-93a6-7e791bab5b6d') created_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 102300) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 102300) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:10:42.433 [INFO] [python_ana_process_manager] 任務 56f7c505-648c-418f-b6f0-f3e7d9680fc8 完成
2025-01-23 08:10:42.474 [INFO] [python_ana_process_manager] 任務 56f7c505-648c-418f-b6f0-f3e7d9680fc8 完成，執行時間: 0.02秒
2025-01-23 08:10:43.597 [INFO] [python_ana_process_manager] Current Spark memory usage: 527.13MB
2025-01-23 08:10:43.598 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:10:43.598 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:10:46.141 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:10:46.141 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:10:48.901 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:10:58.130 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:10:58.473 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:10:59.690 [INFO] [python_ana_process_manager] Current Spark memory usage: 728.61MB
2025-01-23 08:10:59.690 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:10:59.691 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:11:02.200 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:11:02.201 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:11:04.928 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:11:09.875 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:11:09.959 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:11:09.986 [INFO] [python_ana_process_manager] 提交任務 7f68268a-fc33-41af-b1ac-ff611243911a: _muti_process_run_test
2025-01-23 08:11:10.000 [INFO] [python_ana_trader] 任務 7f68268a-fc33-41af-b1ac-ff611243911a 完成，執行時間: 0.01秒
2025-01-23 08:11:09.993 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 收到消息，開始解析
2025-01-23 08:11:09.995 [INFO] [python_ana_process_manager] id=UUID('763829dd-1c88-43e5-8d92-4e181817ee92') created_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 384728) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 384728) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:11:09.996 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 解析後消息為: id=UUID('763829dd-1c88-43e5-8d92-4e181817ee92') created_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 384728) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 384728) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:11:10.085 [INFO] [python_ana_process_manager] 任務 7f68268a-fc33-41af-b1ac-ff611243911a 完成
2025-01-23 08:11:10.115 [INFO] [python_ana_process_manager] 任務 7f68268a-fc33-41af-b1ac-ff611243911a 完成，執行時間: 0.10秒
2025-01-23 08:11:11.229 [INFO] [python_ana_process_manager] Current Spark memory usage: 533.46MB
2025-01-23 08:11:11.230 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:11:11.230 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:11:13.782 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:11:13.782 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:11:16.540 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:11:25.759 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:11:26.159 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:11:27.283 [INFO] [python_ana_process_manager] Current Spark memory usage: 745.12MB
2025-01-23 08:11:27.283 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:11:27.284 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:11:29.841 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:11:29.841 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:11:32.569 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:11:37.710 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:11:38.113 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:11:38.142 [INFO] [python_ana_process_manager] 提交任務 dfc561ed-5807-4d5f-ac75-4105c4bd702d: _muti_process_run_test
2025-01-23 08:11:38.156 [INFO] [python_ana_trader] 任務 dfc561ed-5807-4d5f-ac75-4105c4bd702d 完成，執行時間: 0.01秒
2025-01-23 08:11:38.148 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 收到消息，開始解析
2025-01-23 08:11:38.150 [INFO] [python_ana_process_manager] id=UUID('d9955c1f-ed43-45ca-b145-cc458e21fdc7') created_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 669614) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 669614) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:11:38.151 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 解析後消息為: id=UUID('d9955c1f-ed43-45ca-b145-cc458e21fdc7') created_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 669614) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 669614) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:11:38.206 [INFO] [python_ana_process_manager] 任務 dfc561ed-5807-4d5f-ac75-4105c4bd702d 完成
2025-01-23 08:11:38.236 [INFO] [python_ana_process_manager] 任務 dfc561ed-5807-4d5f-ac75-4105c4bd702d 完成，執行時間: 0.06秒
2025-01-23 08:11:39.745 [INFO] [python_ana_process_manager] Current Spark memory usage: 528.34MB
2025-01-23 08:11:39.746 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:11:39.747 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:11:42.318 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:11:42.318 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:11:45.227 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:11:54.450 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:11:54.814 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:11:55.695 [INFO] [python_ana_process_manager] Current Spark memory usage: 782.34MB
2025-01-23 08:11:55.695 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:11:55.696 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:11:58.469 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:11:58.469 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:12:01.316 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:12:06.293 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:12:06.817 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:12:06.843 [INFO] [python_ana_process_manager] 提交任務 53319539-0d78-4ffe-bba4-5bd0f8395f0b: _muti_process_run_test
2025-01-23 08:12:06.855 [INFO] [python_ana_trader] 任務 53319539-0d78-4ffe-bba4-5bd0f8395f0b 完成，執行時間: 0.01秒
2025-01-23 08:12:06.851 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 收到消息，開始解析
2025-01-23 08:12:06.853 [INFO] [python_ana_process_manager] id=UUID('7ce803d4-549a-4e2d-878e-9d6227ffcaeb') created_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 965882) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 965882) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:12:06.854 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 解析後消息為: id=UUID('7ce803d4-549a-4e2d-878e-9d6227ffcaeb') created_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 965882) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 21, 965882) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:12:06.880 [INFO] [python_ana_process_manager] 任務 53319539-0d78-4ffe-bba4-5bd0f8395f0b 完成
2025-01-23 08:12:06.910 [INFO] [python_ana_process_manager] 任務 53319539-0d78-4ffe-bba4-5bd0f8395f0b 完成，執行時間: 0.04秒
2025-01-23 08:12:08.120 [INFO] [python_ana_process_manager] Current Spark memory usage: 522.97MB
2025-01-23 08:12:08.121 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:12:08.121 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:12:10.745 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:12:10.745 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:12:13.467 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:12:23.199 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:12:23.569 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:12:25.412 [INFO] [python_ana_process_manager] Current Spark memory usage: 729.86MB
2025-01-23 08:12:25.413 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:12:25.413 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:12:28.229 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:12:28.229 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:12:31.149 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:12:36.081 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:12:36.170 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:12:36.198 [INFO] [python_ana_process_manager] 提交任務 e219a81b-e4fb-409a-90ea-8b85dac3062d: _muti_process_run_test
2025-01-23 08:12:36.211 [INFO] [python_ana_trader] 任務 e219a81b-e4fb-409a-90ea-8b85dac3062d 完成，執行時間: 0.01秒
2025-01-23 08:12:36.204 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 收到消息，開始解析
2025-01-23 08:12:36.206 [INFO] [python_ana_process_manager] id=UUID('d7a5c06f-2d6b-41bd-ae36-47ae0124eec4') created_at=datetime.datetime(2025, 1, 23, 8, 9, 22, 703724) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 22, 703724) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:12:36.207 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_789c9426 解析後消息為: id=UUID('d7a5c06f-2d6b-41bd-ae36-47ae0124eec4') created_at=datetime.datetime(2025, 1, 23, 8, 9, 22, 703724) updated_at=datetime.datetime(2025, 1, 23, 8, 9, 22, 703724) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:12:36.308 [INFO] [python_ana_process_manager] 任務 e219a81b-e4fb-409a-90ea-8b85dac3062d 完成
2025-01-23 08:12:36.316 [INFO] [python_ana_process_manager] Current Spark memory usage: 503.30MB
2025-01-23 08:12:36.317 [INFO] [python_ana_process_manager] 任務 e219a81b-e4fb-409a-90ea-8b85dac3062d 完成，執行時間: 0.11秒
2025-01-23 08:12:36.317 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:12:36.318 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:12:38.826 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:12:38.826 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:12:41.710 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:12:51.237 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:12:51.342 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:12:52.869 [INFO] [python_ana_process_manager] Current Spark memory usage: 742.30MB
2025-01-23 08:12:52.869 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:12:52.869 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:12:55.639 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:12:55.639 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:12:58.682 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:13:03.777 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:13:04.188 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:13:04.214 [INFO] [python_ana_process_manager] 提交任務 a2928221-5116-400c-bdb0-dc7ce0be0e37: _muti_process_run_test
2025-01-23 08:13:04.226 [INFO] [python_ana_trader] 任務 a2928221-5116-400c-bdb0-dc7ce0be0e37 完成，執行時間: 0.01秒
2025-01-23 08:13:04.229 [INFO] [python_ana_process_manager] 任務 a2928221-5116-400c-bdb0-dc7ce0be0e37 完成
2025-01-23 08:13:04.230 [INFO] [python_ana_process_manager] 任務 a2928221-5116-400c-bdb0-dc7ce0be0e37 完成，執行時間: 0.02秒
2025-01-23 08:14:22.125 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_789c9426
2025-01-23 08:14:22.125 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_789c9426 正在停止
2025-01-23 08:14:22.126 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_789c9426 已完全停止
2025-01-23 08:14:22.126 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_3a48e25c
2025-01-23 08:14:22.126 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_3a48e25c 正在停止
2025-01-23 08:14:22.127 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_3a48e25c 已完全停止
2025-01-23 08:14:22.127 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_c7a2c26c
2025-01-23 08:14:22.127 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_c7a2c26c 正在停止
2025-01-23 08:14:22.128 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_c7a2c26c 已完全停止
2025-01-23 08:15:10.777 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 2
2025-01-23 08:15:15.775 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_bed87a85 開始消費隊列 full_backtest
2025-01-23 08:15:15.775 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_bed87a85 線程已啟動
2025-01-23 08:15:15.775 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_171accfd 開始消費隊列 pre_process_stock_data
2025-01-23 08:15:15.775 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_171accfd 線程已啟動
2025-01-23 08:15:15.776 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_1f79672d 開始消費隊列 back_testing
2025-01-23 08:15:15.776 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_1f79672d 線程已啟動
2025-01-23 08:15:20.774 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:15:20.776 [INFO] [python_ana_process_manager] id=UUID('4d416599-b7e5-412e-8008-f670326c9404') created_at=datetime.datetime(2025, 1, 23, 8, 15, 17, 929102) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 17, 929102) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:15:20.777 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('4d416599-b7e5-412e-8008-f670326c9404') created_at=datetime.datetime(2025, 1, 23, 8, 15, 17, 929102) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 17, 929102) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:15:22.671 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:15:25.386 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:15:34.336 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:15:34.507 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:15:35.648 [INFO] [python_ana_process_manager] Current Spark memory usage: 759.66MB
2025-01-23 08:15:35.649 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:15:35.784 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:15:37.064 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:15:37.305 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:15:37.331 [INFO] [python_ana_process_manager] 提交任務 fa069e7e-a34a-4592-9858-6bde17c66902: _muti_process_run_test
2025-01-23 08:15:37.336 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:15:37.338 [INFO] [python_ana_process_manager] id=UUID('993f928d-9ab2-46f4-b697-a8b12c478423') created_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 263282) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 263282) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:15:37.340 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('993f928d-9ab2-46f4-b697-a8b12c478423') created_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 263282) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 263282) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:15:38.597 [INFO] [python_ana_process_manager] Current Spark memory usage: 726.72MB
2025-01-23 08:15:38.598 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:15:38.734 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:15:41.484 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:15:41.772 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:15:42.823 [INFO] [python_ana_process_manager] Current Spark memory usage: 776.91MB
2025-01-23 08:15:42.823 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:15:42.954 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:15:43.171 [INFO] [python_ana_process_manager] 任務 fa069e7e-a34a-4592-9858-6bde17c66902 完成
2025-01-23 08:15:43.172 [INFO] [python_ana_process_manager] 任務 fa069e7e-a34a-4592-9858-6bde17c66902 完成，執行時間: 5.84秒
2025-01-23 08:15:43.536 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:15:43.980 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:15:44.003 [INFO] [python_ana_process_manager] 提交任務 6b070450-4a41-453e-955d-8e7cbacab317: _muti_process_run_test
2025-01-23 08:15:43.168 [INFO] [python_ana_trader] 任務 fa069e7e-a34a-4592-9858-6bde17c66902 完成，執行時間: 4.96秒
2025-01-23 08:15:44.010 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:15:44.013 [INFO] [python_ana_process_manager] id=UUID('ccce5e58-ffaf-42ef-a034-34477eb9bf3d') created_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 553147) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 553147) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:15:44.014 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('ccce5e58-ffaf-42ef-a034-34477eb9bf3d') created_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 553147) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 553147) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:15:45.280 [INFO] [python_ana_process_manager] Current Spark memory usage: 751.57MB
2025-01-23 08:15:45.281 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:15:45.411 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:15:47.932 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:15:48.475 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:15:49.606 [INFO] [python_ana_process_manager] Current Spark memory usage: 766.63MB
2025-01-23 08:15:49.606 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:15:49.728 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:15:49.858 [INFO] [python_ana_process_manager] 任務 6b070450-4a41-453e-955d-8e7cbacab317 完成
2025-01-23 08:15:49.858 [INFO] [python_ana_process_manager] 任務 6b070450-4a41-453e-955d-8e7cbacab317 完成，執行時間: 5.86秒
2025-01-23 08:15:50.335 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:15:50.749 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:15:50.775 [INFO] [python_ana_process_manager] 提交任務 4d2326f2-1a5f-462d-9f4d-24d96a723096: _muti_process_run_test
2025-01-23 08:15:50.786 [INFO] [python_ana_trader] 任務 4d2326f2-1a5f-462d-9f4d-24d96a723096 完成，執行時間: 0.01秒
2025-01-23 08:15:49.856 [INFO] [python_ana_trader] 任務 6b070450-4a41-453e-955d-8e7cbacab317 完成，執行時間: 4.96秒
2025-01-23 08:15:50.781 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:15:50.782 [INFO] [python_ana_process_manager] id=UUID('ab2754c0-6638-4bbf-b1e5-348435deb132') created_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 804540) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 804540) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:15:50.784 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('ab2754c0-6638-4bbf-b1e5-348435deb132') created_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 804540) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 18, 804540) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:15:50.813 [INFO] [python_ana_process_manager] 任務 4d2326f2-1a5f-462d-9f4d-24d96a723096 完成
2025-01-23 08:15:50.857 [INFO] [python_ana_process_manager] 任務 4d2326f2-1a5f-462d-9f4d-24d96a723096 完成，執行時間: 0.04秒
2025-01-23 08:15:51.954 [INFO] [python_ana_process_manager] Current Spark memory usage: 800.30MB
2025-01-23 08:15:51.955 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:15:52.076 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:15:54.370 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:15:54.619 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:15:55.838 [INFO] [python_ana_process_manager] Current Spark memory usage: 824.24MB
2025-01-23 08:15:55.838 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:15:55.967 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:15:56.566 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:15:56.976 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:15:57.008 [INFO] [python_ana_process_manager] 提交任務 70f689d5-5bd1-49f8-8858-7fa9484352cd: _muti_process_run_test
2025-01-23 08:15:57.020 [INFO] [python_ana_trader] 任務 70f689d5-5bd1-49f8-8858-7fa9484352cd 完成，執行時間: 0.01秒
2025-01-23 08:15:57.014 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:15:57.016 [INFO] [python_ana_process_manager] id=UUID('4811d528-63a1-47f8-9aa6-58f377668058') created_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 53381) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 53381) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:15:57.017 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('4811d528-63a1-47f8-9aa6-58f377668058') created_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 53381) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 53381) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:15:57.101 [INFO] [python_ana_process_manager] 任務 70f689d5-5bd1-49f8-8858-7fa9484352cd 完成
2025-01-23 08:15:57.131 [INFO] [python_ana_process_manager] 任務 70f689d5-5bd1-49f8-8858-7fa9484352cd 完成，執行時間: 0.09秒
2025-01-23 08:15:58.145 [INFO] [python_ana_process_manager] Current Spark memory usage: 835.77MB
2025-01-23 08:15:58.146 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:15:58.269 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:16:00.572 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:00.813 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:01.923 [INFO] [python_ana_process_manager] Current Spark memory usage: 932.04MB
2025-01-23 08:16:01.924 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:02.043 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:16:02.634 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:03.057 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:03.082 [INFO] [python_ana_process_manager] 提交任務 c51acba5-c7ab-466e-9d65-46a9533b968b: _muti_process_run_test
2025-01-23 08:16:03.093 [INFO] [python_ana_trader] 任務 c51acba5-c7ab-466e-9d65-46a9533b968b 完成，執行時間: 0.01秒
2025-01-23 08:16:03.088 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:16:03.089 [INFO] [python_ana_process_manager] id=UUID('06fd46ac-1ad6-4d37-a182-d8c653ca4201') created_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 304595) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 304595) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:16:03.090 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('06fd46ac-1ad6-4d37-a182-d8c653ca4201') created_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 304595) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 304595) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:16:03.150 [INFO] [python_ana_process_manager] 任務 c51acba5-c7ab-466e-9d65-46a9533b968b 完成
2025-01-23 08:16:03.183 [INFO] [python_ana_process_manager] 任務 c51acba5-c7ab-466e-9d65-46a9533b968b 完成，執行時間: 0.07秒
2025-01-23 08:16:04.212 [INFO] [python_ana_process_manager] Current Spark memory usage: 879.68MB
2025-01-23 08:16:04.212 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:04.328 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:16:06.593 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:06.867 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:07.898 [INFO] [python_ana_process_manager] Current Spark memory usage: 974.62MB
2025-01-23 08:16:07.899 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:08.019 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:16:08.683 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:09.048 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:09.073 [INFO] [python_ana_process_manager] 提交任務 a9089eb3-13fc-48e8-8a99-476560c1cb0d: _muti_process_run_test
2025-01-23 08:16:09.086 [INFO] [python_ana_trader] 任務 a9089eb3-13fc-48e8-8a99-476560c1cb0d 完成，執行時間: 0.01秒
2025-01-23 08:16:09.081 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:16:09.082 [INFO] [python_ana_process_manager] id=UUID('67bd2c76-6000-47fa-93c4-db7344286418') created_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 554397) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 554397) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:16:09.083 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('67bd2c76-6000-47fa-93c4-db7344286418') created_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 554397) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 554397) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:16:09.159 [INFO] [python_ana_process_manager] 任務 a9089eb3-13fc-48e8-8a99-476560c1cb0d 完成
2025-01-23 08:16:09.237 [INFO] [python_ana_process_manager] 任務 a9089eb3-13fc-48e8-8a99-476560c1cb0d 完成，執行時間: 0.09秒
2025-01-23 08:16:10.224 [INFO] [python_ana_process_manager] Current Spark memory usage: 951.91MB
2025-01-23 08:16:10.225 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:10.346 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:16:12.505 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:12.879 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:13.947 [INFO] [python_ana_process_manager] Current Spark memory usage: 964.99MB
2025-01-23 08:16:13.948 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:14.071 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:16:14.635 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:15.101 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:15.130 [INFO] [python_ana_process_manager] 提交任務 cd151768-1149-4afe-8140-dcb576f737d3: _muti_process_run_test
2025-01-23 08:16:15.141 [INFO] [python_ana_trader] 任務 cd151768-1149-4afe-8140-dcb576f737d3 完成，執行時間: 0.01秒
2025-01-23 08:16:15.136 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:16:15.137 [INFO] [python_ana_process_manager] id=UUID('73ca3460-cdea-4f3b-87a3-b01c6cebd74c') created_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 817673) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 817673) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:16:15.139 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('73ca3460-cdea-4f3b-87a3-b01c6cebd74c') created_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 817673) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 19, 817673) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:16:15.210 [INFO] [python_ana_process_manager] 任務 cd151768-1149-4afe-8140-dcb576f737d3 完成
2025-01-23 08:16:15.242 [INFO] [python_ana_process_manager] 任務 cd151768-1149-4afe-8140-dcb576f737d3 完成，執行時間: 0.08秒
2025-01-23 08:16:16.433 [INFO] [python_ana_process_manager] Current Spark memory usage: 1010.70MB
2025-01-23 08:16:16.434 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:16.553 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:16:18.676 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:19.083 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:20.177 [INFO] [python_ana_process_manager] Current Spark memory usage: 969.31MB
2025-01-23 08:16:20.178 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:20.305 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:16:20.854 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:21.328 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:21.355 [INFO] [python_ana_process_manager] 提交任務 5b563c33-7ae9-4574-abc7-5e1ce0fe9f57: _muti_process_run_test
2025-01-23 08:16:21.368 [INFO] [python_ana_trader] 任務 5b563c33-7ae9-4574-abc7-5e1ce0fe9f57 完成，執行時間: 0.01秒
2025-01-23 08:16:21.360 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:16:21.362 [INFO] [python_ana_process_manager] id=UUID('39587783-1454-48b7-bb9e-a8ba50184d1b') created_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 56438) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 56438) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:16:21.363 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('39587783-1454-48b7-bb9e-a8ba50184d1b') created_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 56438) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 56438) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:16:21.385 [INFO] [python_ana_process_manager] 任務 5b563c33-7ae9-4574-abc7-5e1ce0fe9f57 完成
2025-01-23 08:16:21.386 [INFO] [python_ana_process_manager] 任務 5b563c33-7ae9-4574-abc7-5e1ce0fe9f57 完成，執行時間: 0.03秒
2025-01-23 08:16:22.433 [INFO] [python_ana_process_manager] Current Spark memory usage: 1018.30MB
2025-01-23 08:16:22.433 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:22.553 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:16:24.676 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:25.103 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:26.238 [INFO] [python_ana_process_manager] Current Spark memory usage: 1004.86MB
2025-01-23 08:16:26.238 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:26.359 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:16:26.929 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:27.392 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:27.418 [INFO] [python_ana_process_manager] 提交任務 b8cae049-2089-4214-8a49-351759ad26cb: _muti_process_run_test
2025-01-23 08:16:27.430 [INFO] [python_ana_trader] 任務 b8cae049-2089-4214-8a49-351759ad26cb 完成，執行時間: 0.01秒
2025-01-23 08:16:27.424 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:16:27.426 [INFO] [python_ana_process_manager] id=UUID('da20c089-3aac-46df-9d63-5c03dbc7431f') created_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 317760) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 317760) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:16:27.427 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('da20c089-3aac-46df-9d63-5c03dbc7431f') created_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 317760) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 317760) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:16:27.472 [INFO] [python_ana_process_manager] 任務 b8cae049-2089-4214-8a49-351759ad26cb 完成
2025-01-23 08:16:27.503 [INFO] [python_ana_process_manager] 任務 b8cae049-2089-4214-8a49-351759ad26cb 完成，執行時間: 0.05秒
2025-01-23 08:16:28.572 [INFO] [python_ana_process_manager] Current Spark memory usage: 1023.08MB
2025-01-23 08:16:28.572 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:28.688 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:16:30.818 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:31.223 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:32.239 [INFO] [python_ana_process_manager] Current Spark memory usage: 1034.42MB
2025-01-23 08:16:32.239 [INFO] [python_ana_process_manager] Starting restart spark
2025-01-23 08:16:32.240 [INFO] [python_ana_process_manager] 清理Python資源
2025-01-23 08:16:34.762 [INFO] [python_ana_process_manager] Restart completed
2025-01-23 08:16:34.762 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:37.498 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:16:42.285 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:42.527 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:42.552 [INFO] [python_ana_process_manager] 提交任務 85029340-eb14-4e7f-8675-4ab6b39102b2: _muti_process_run_test
2025-01-23 08:16:42.565 [INFO] [python_ana_trader] 任務 85029340-eb14-4e7f-8675-4ab6b39102b2 完成，執行時間: 0.01秒
2025-01-23 08:16:42.558 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:16:42.560 [INFO] [python_ana_process_manager] id=UUID('76f45f6b-6e60-4132-a797-155efd71a334') created_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 638319) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 638319) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:16:42.561 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('76f45f6b-6e60-4132-a797-155efd71a334') created_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 638319) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 638319) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:16:42.605 [INFO] [python_ana_process_manager] 任務 85029340-eb14-4e7f-8675-4ab6b39102b2 完成
2025-01-23 08:16:42.637 [INFO] [python_ana_process_manager] 任務 85029340-eb14-4e7f-8675-4ab6b39102b2 完成，執行時間: 0.05秒
2025-01-23 08:16:43.217 [INFO] [python_ana_process_manager] Current Spark memory usage: 519.42MB
2025-01-23 08:16:43.217 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:43.359 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:16:48.914 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:49.446 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:50.125 [INFO] [python_ana_process_manager] Current Spark memory usage: 839.98MB
2025-01-23 08:16:50.125 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:50.262 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:16:51.028 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:51.275 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:51.302 [INFO] [python_ana_process_manager] 提交任務 26f84b7c-2049-4b4a-908e-cb0664a3bf03: _muti_process_run_test
2025-01-23 08:16:51.314 [INFO] [python_ana_trader] 任務 26f84b7c-2049-4b4a-908e-cb0664a3bf03 完成，執行時間: 0.01秒
2025-01-23 08:16:51.308 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 收到消息，開始解析
2025-01-23 08:16:51.310 [INFO] [python_ana_process_manager] id=UUID('a71d02fc-7a62-433b-9bb4-8bdc9975970e') created_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 935956) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 935956) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-23 08:16:51.311 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bed87a85 解析後消息為: id=UUID('a71d02fc-7a62-433b-9bb4-8bdc9975970e') created_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 935956) updated_at=datetime.datetime(2025, 1, 23, 8, 15, 20, 935956) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='guru' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 1, 1, 0, 0, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 12, 31, 23, 59, 59, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-01-01', 'end_time': '2024-12-31'}, 準備開始fullbacktest處理任務
2025-01-23 08:16:51.352 [INFO] [python_ana_process_manager] 任務 26f84b7c-2049-4b4a-908e-cb0664a3bf03 完成
2025-01-23 08:16:51.384 [INFO] [python_ana_process_manager] 任務 26f84b7c-2049-4b4a-908e-cb0664a3bf03 完成，執行時間: 0.05秒
2025-01-23 08:16:52.003 [INFO] [python_ana_process_manager] Current Spark memory usage: 799.48MB
2025-01-23 08:16:52.004 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:52.131 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-23 08:16:55.027 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:55.168 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:55.792 [INFO] [python_ana_process_manager] Current Spark memory usage: 745.62MB
2025-01-23 08:16:55.792 [INFO] [python_ana_process_manager] Starting session creating
2025-01-23 08:16:55.917 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-01-23 08:16:56.606 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-23 08:16:56.923 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-23 08:16:56.949 [INFO] [python_ana_process_manager] 提交任務 ff5463cb-7412-420e-9e5c-a2876c402d95: _muti_process_run_test
2025-01-23 08:16:56.960 [INFO] [python_ana_trader] 任務 ff5463cb-7412-420e-9e5c-a2876c402d95 完成，執行時間: 0.01秒
2025-01-23 08:16:56.962 [INFO] [python_ana_process_manager] 任務 ff5463cb-7412-420e-9e5c-a2876c402d95 完成
2025-01-23 08:16:56.963 [INFO] [python_ana_process_manager] 任務 ff5463cb-7412-420e-9e5c-a2876c402d95 完成，執行時間: 0.01秒
2025-01-23 08:18:56.158 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_bed87a85
2025-01-23 08:18:56.158 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_bed87a85 正在停止
2025-01-23 08:18:56.159 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_bed87a85 已完全停止
2025-01-23 08:18:56.159 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_171accfd
2025-01-23 08:18:56.159 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_171accfd 正在停止
2025-01-23 08:18:56.160 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_171accfd 已完全停止
2025-01-23 08:18:56.160 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_1f79672d
2025-01-23 08:18:56.160 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_1f79672d 正在停止
2025-01-23 08:18:56.161 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_1f79672d 已完全停止
2025-01-24 09:20:41.598 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 2
2025-01-24 09:20:46.581 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b117c7e5 開始消費隊列 full_backtest
2025-01-24 09:20:46.581 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b117c7e5 線程已啟動
2025-01-24 09:20:46.582 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_b09895a2 開始消費隊列 pre_process_stock_data
2025-01-24 09:20:46.582 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_b09895a2 線程已啟動
2025-01-24 09:20:46.582 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a5cd3b55 開始消費隊列 back_testing
2025-01-24 09:20:46.582 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a5cd3b55 線程已啟動
2025-01-24 09:36:12.241 [INFO] taskid : d2189d7a-5586-4fb9-9cc8-1145cac6633c, task name : full_backtest publish msg to processer
2025-01-24 09:36:12.195 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b117c7e5 收到消息，開始解析
2025-01-24 09:36:12.201 [INFO] [python_ana_process_manager] id=UUID('d2189d7a-5586-4fb9-9cc8-1145cac6633c') created_at=datetime.datetime(2025, 1, 24, 9, 36, 8, 931415) updated_at=datetime.datetime(2025, 1, 24, 9, 36, 8, 931415) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 1, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2024, 10, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-01-24 09:36:12.204 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b117c7e5 解析後消息為: id=UUID('d2189d7a-5586-4fb9-9cc8-1145cac6633c') created_at=datetime.datetime(2025, 1, 24, 9, 36, 8, 931415) updated_at=datetime.datetime(2025, 1, 24, 9, 36, 8, 931415) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 1, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2024, 10, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-01-24', 'end_time': '2024-10-24'}, 準備開始fullbacktest處理任務
2025-01-24 09:36:14.143 [INFO] [python_ana_process_manager] Starting session creating
2025-01-24 09:36:23.398 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-24 09:36:26.544 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-24 09:36:26.867 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-24 09:36:26.867 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b117c7e5 任務失敗: Failed to load data: empty data set
2025-01-24 09:37:03.538 [INFO] taskid : 0a7e0bec-3db4-4881-96eb-89863eee7f58, task name : full_backtest publish msg to processer
2025-01-24 09:38:02.836 [INFO] taskid : e379de4a-afbe-4713-8b31-022826867173, task name : full_backtest publish msg to processer
2025-01-24 09:40:20.503 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_b117c7e5
2025-01-24 09:40:20.503 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b117c7e5 正在停止
2025-01-24 09:40:20.504 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b117c7e5 已完全停止
2025-01-24 09:40:20.504 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_b09895a2
2025-01-24 09:40:20.504 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_b09895a2 正在停止
2025-01-24 09:40:20.505 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_b09895a2 已完全停止
2025-01-24 09:40:20.505 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_a5cd3b55
2025-01-24 09:40:20.505 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a5cd3b55 正在停止
2025-01-24 09:40:20.506 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a5cd3b55 已完全停止
2025-01-24 09:40:34.912 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 2
2025-01-24 09:40:39.910 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_bf8f1b66 開始消費隊列 full_backtest
2025-01-24 09:40:39.911 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_bf8f1b66 線程已啟動
2025-01-24 09:40:39.912 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_ee146bcb 開始消費隊列 pre_process_stock_data
2025-01-24 09:40:39.912 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_ee146bcb 線程已啟動
2025-01-24 09:40:39.913 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_5a5cbc0e 開始消費隊列 back_testing
2025-01-24 09:40:39.913 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bf8f1b66 收到消息，開始解析
2025-01-24 09:40:39.913 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_5a5cbc0e 線程已啟動
2025-01-24 09:40:39.916 [INFO] [python_ana_process_manager] id=UUID('d2189d7a-5586-4fb9-9cc8-1145cac6633c') created_at=datetime.datetime(2025, 1, 24, 9, 36, 8, 931415) updated_at=datetime.datetime(2025, 1, 24, 9, 36, 26, 867638) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 1, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2024, 10, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Failed to load data: empty data set' sink_params=None set_params=None
2025-01-24 09:40:39.917 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_bf8f1b66 解析後消息為: id=UUID('d2189d7a-5586-4fb9-9cc8-1145cac6633c') created_at=datetime.datetime(2025, 1, 24, 9, 36, 8, 931415) updated_at=datetime.datetime(2025, 1, 24, 9, 36, 26, 867638) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 1, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2024, 10, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Failed to load data: empty data set' sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-01-24', 'end_time': '2024-10-24'}, 準備開始fullbacktest處理任務
2025-01-24 09:40:41.696 [INFO] [python_ana_process_manager] Starting session creating
2025-01-24 09:40:44.428 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-24 09:40:46.839 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-24 09:40:47.383 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-24 09:40:47.383 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_bf8f1b66 任務失敗: Failed to load data: empty data set
2025-01-24 09:42:01.678 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_bf8f1b66
2025-01-24 09:42:01.678 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_bf8f1b66 正在停止
2025-01-24 09:42:01.679 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_bf8f1b66 已完全停止
2025-01-24 09:42:01.679 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_ee146bcb
2025-01-24 09:42:01.679 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_ee146bcb 正在停止
2025-01-24 09:42:01.680 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_ee146bcb 已完全停止
2025-01-24 09:42:01.680 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_5a5cbc0e
2025-01-24 09:42:01.680 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_5a5cbc0e 正在停止
2025-01-24 09:42:01.681 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_5a5cbc0e 已完全停止
2025-01-24 09:45:26.446 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 1
2025-01-24 09:45:31.438 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_73e25145 線程已啟動
2025-01-24 09:45:31.438 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_73e25145 開始消費隊列 full_backtest
2025-01-24 09:45:31.439 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_f66044c8 線程已啟動
2025-01-24 09:45:31.440 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_f66044c8 開始消費隊列 pre_process_stock_data
2025-01-24 09:45:31.441 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_34cc9987 線程已啟動
2025-01-24 09:45:31.441 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_34cc9987 開始消費隊列 back_testing
2025-01-24 09:45:36.447 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_73e25145 收到消息，開始解析
2025-01-24 09:45:36.451 [INFO] [python_ana_process_manager] id=UUID('d2189d7a-5586-4fb9-9cc8-1145cac6633c') created_at=datetime.datetime(2025, 1, 24, 9, 36, 8, 931415) updated_at=datetime.datetime(2025, 1, 24, 9, 40, 47, 383323) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 1, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2024, 10, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Failed to load data: empty data set' sink_params=None set_params=None
2025-01-24 09:45:36.453 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_73e25145 解析後消息為: id=UUID('d2189d7a-5586-4fb9-9cc8-1145cac6633c') created_at=datetime.datetime(2025, 1, 24, 9, 36, 8, 931415) updated_at=datetime.datetime(2025, 1, 24, 9, 40, 47, 383323) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 1, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2024, 10, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Failed to load data: empty data set' sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-01-24', 'end_time': '2024-10-24'}, 準備開始fullbacktest處理任務
2025-01-24 09:45:38.405 [INFO] [python_ana_process_manager] Starting session creating
2025-01-24 09:45:41.251 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-24 09:45:44.148 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-24 09:45:44.228 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-24 09:45:44.229 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_73e25145 任務失敗: Failed to load data: empty data set
2025-01-24 09:46:02.086 [INFO] taskid : dd29c6b8-182e-4180-9b7f-daf4ff2c3360, task name : full_backtest publish msg to processer
2025-01-24 09:47:02.754 [INFO] taskid : b52374e8-d272-4fd7-8479-912fc2368e19, task name : full_backtest publish msg to processer
2025-01-24 09:47:23.897 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 1
2025-01-24 09:47:28.898 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_e6d3aea7 線程已啟動
2025-01-24 09:47:28.899 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_e6d3aea7 開始消費隊列 full_backtest
2025-01-24 09:47:28.900 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_249b8084 線程已啟動
2025-01-24 09:47:28.900 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_249b8084 開始消費隊列 pre_process_stock_data
2025-01-24 09:47:28.901 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_9a2d5fef 線程已啟動
2025-01-24 09:47:28.901 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_9a2d5fef 開始消費隊列 back_testing
2025-01-24 09:47:33.890 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_e6d3aea7 收到消息，開始解析
2025-01-24 09:47:33.893 [INFO] [python_ana_process_manager] id=UUID('d2189d7a-5586-4fb9-9cc8-1145cac6633c') created_at=datetime.datetime(2025, 1, 24, 9, 36, 8, 931415) updated_at=datetime.datetime(2025, 1, 24, 9, 45, 44, 229534) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 1, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2024, 10, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Failed to load data: empty data set' sink_params=None set_params=None
2025-01-24 09:47:33.895 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_e6d3aea7 解析後消息為: id=UUID('d2189d7a-5586-4fb9-9cc8-1145cac6633c') created_at=datetime.datetime(2025, 1, 24, 9, 36, 8, 931415) updated_at=datetime.datetime(2025, 1, 24, 9, 45, 44, 229534) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 1, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2024, 10, 24, 17, 35, 10, 124158, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Failed to load data: empty data set' sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-01-24', 'end_time': '2024-10-24'}, 準備開始fullbacktest處理任務
2025-01-24 09:47:36.052 [INFO] [python_ana_process_manager] Starting session creating
2025-01-24 09:47:38.788 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-01-24 09:47:59.674 [INFO] [python_ana_process_manager] Starting session cleanup
2025-01-24 09:48:00.140 [INFO] [python_ana_process_manager] ending session cleanup
2025-01-24 09:48:07.033 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_e6d3aea7 任務失敗: Failed to load data: empty data set
2025-02-01 07:03:50.127 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 1
2025-02-01 07:03:55.129 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b3490d00 開始消費隊列 full_backtest
2025-02-01 07:03:55.129 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b3490d00 線程已啟動
2025-02-01 07:03:55.131 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_2dc04df2 開始消費隊列 pre_process_stock_data
2025-02-01 07:03:55.131 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_2dc04df2 線程已啟動
2025-02-01 07:03:55.132 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_19b351bc 開始消費隊列 back_testing
2025-02-01 07:03:55.132 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_19b351bc 線程已啟動
2025-02-01 07:06:00.089 [INFO] taskid : bd5683e8-b10f-417d-aa0f-189c14a964a6, task name : full_backtest publish msg to processer
2025-02-01 07:06:00.040 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b3490d00 收到消息，開始解析
2025-02-01 07:06:00.048 [INFO] [python_ana_process_manager] id=UUID('bd5683e8-b10f-417d-aa0f-189c14a964a6') created_at=datetime.datetime(2025, 2, 1, 7, 6, 0, 21332) updated_at=datetime.datetime(2025, 2, 1, 7, 6, 0, 21332) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 1, 15, 5, 13, 421004, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2024, 11, 1, 15, 5, 13, 421004, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 07:06:00.051 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_b3490d00 解析後消息為: id=UUID('bd5683e8-b10f-417d-aa0f-189c14a964a6') created_at=datetime.datetime(2025, 2, 1, 7, 6, 0, 21332) updated_at=datetime.datetime(2025, 2, 1, 7, 6, 0, 21332) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 1, 15, 5, 13, 421004, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2024, 11, 1, 15, 5, 13, 421004, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-02-01', 'end_time': '2024-11-01'}, 準備開始fullbacktest處理任務
2025-02-01 07:06:01.825 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 07:06:11.902 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 07:06:14.927 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 07:06:15.344 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 07:06:15.344 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_b3490d00 任務失敗: Failed to load data: empty data set
2025-02-01 07:07:00.048 [INFO] taskid : 186dc0b1-4979-450b-af7c-37812bf045c9, task name : full_backtest publish msg to processer
2025-02-01 07:08:00.056 [INFO] taskid : 68fbf2ad-e1d7-41da-bba0-f20c0011df65, task name : full_backtest publish msg to processer
2025-02-01 07:12:18.818 [INFO] taskid : d8250ed1-d5e2-477c-a12e-ab6940c03ac1, task name : full_backtest publish msg to processer
2025-02-01 07:15:00.017 [INFO] task : b481ee6d-bfda-4952-8391-45e3c690aadd start download raw data stage
2025-02-01 07:15:00.019 [INFO] 執行 Sync Taiwan Stock Service, date : 20250101, code : 2317
2025-02-01 07:15:00.378 [INFO] 執行 Sync Taiwan Stock Service, date : 20250201, code : 2317
2025-02-01 07:18:26.822 [INFO] task : f44876e7-0b36-4ed5-9d70-ccd6d42666e7 start download raw data stage
2025-02-01 07:23:00.015 [INFO] task : ab1f8c3a-7d20-41a2-bc88-a37f09d738d9 start download raw data stage
2025-02-01 07:23:00.017 [INFO] 執行 Sync Taiwan Stock Service, date : 20241001, code : 2317
2025-02-01 07:23:00.153 [ERROR] task : ab1f8c3a-7d20-41a2-bc88-a37f09d738d9 failed at download raw data stage
2025-02-01 07:32:03.426 [INFO] task : 40f518ed-7c02-4b1e-806f-62358d1baf65 start download raw data stage
2025-02-01 07:32:07.245 [INFO] 執行 Sync Taiwan Stock Service, date : 20241001, code : 2317
2025-02-01 07:32:07.394 [ERROR] task : 40f518ed-7c02-4b1e-806f-62358d1baf65 failed at download raw data stage
2025-02-01 07:46:00.048 [INFO] task : 101c3ac5-78d7-45ba-afcb-188135491a6c start download raw data stage
2025-02-01 07:46:00.050 [INFO] 執行 Sync Taiwan Stock Service, date : 20241001, code : 2317
2025-02-01 07:46:00.197 [ERROR] task : 101c3ac5-78d7-45ba-afcb-188135491a6c failed at download raw data stage
2025-02-01 08:33:00.078 [INFO] taskid : a2ccccd8-945f-465a-9d50-6d19883c8b6f, task name : full_backtest publish msg to processer
2025-02-01 08:34:00.046 [INFO] taskid : 86763c67-2d80-41e8-b794-4296c7de9511, task name : full_backtest publish msg to processer
2025-02-01 08:35:00.054 [INFO] taskid : 80d8f302-71ac-4cd0-8457-e9f3de30ab96, task name : full_backtest publish msg to processer
2025-02-01 08:37:12.869 [INFO] taskid : 975123c7-8600-4739-bd9d-4ba405cb349c, task name : full_backtest publish msg to processer
2025-02-01 08:40:00.063 [INFO] taskid : 2b7a2f50-09d8-42ed-91a4-c531a3df089e, task name : full_backtest publish msg to processer
2025-02-01 08:40:35.234 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 4
2025-02-01 08:40:40.226 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 開始消費隊列 full_backtest
2025-02-01 08:40:40.226 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 線程已啟動
2025-02-01 08:40:40.227 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_9907258e 開始消費隊列 pre_process_stock_data
2025-02-01 08:40:40.228 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_9907258e 線程已啟動
2025-02-01 08:40:40.228 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.228 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_7f7a52fb 開始消費隊列 back_testing
2025-02-01 08:40:40.228 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_7f7a52fb 線程已啟動
2025-02-01 08:40:40.230 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.233 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.234 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.235 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.235 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.236 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.237 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.239 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.239 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.240 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.241 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.242 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.243 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.244 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.245 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.247 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.248 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.249 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.250 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.251 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.252 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.271 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.272 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.274 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.275 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:40:40.276 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 收到消息，開始解析
2025-02-01 08:40:40.277 [INFO] [python_ana_process_manager] id=UUID('86763c67-2d80-41e8-b794-4296c7de9511') created_at=datetime.datetime(2025, 2, 1, 8, 34, 0, 1637) updated_at=datetime.datetime(2025, 2, 1, 8, 34, 0, 1637) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 08:40:40.278 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4e3ef14f 解析後消息為: id=UUID('86763c67-2d80-41e8-b794-4296c7de9511') created_at=datetime.datetime(2025, 2, 1, 8, 34, 0, 1637) updated_at=datetime.datetime(2025, 2, 1, 8, 34, 0, 1637) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 08:40:41.911 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 08:40:45.074 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 08:40:54.444 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 08:40:54.633 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 08:40:55.653 [INFO] [python_ana_process_manager] Current Spark memory usage: 678.80MB
2025-02-01 08:40:55.654 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 08:40:55.814 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 08:40:58.703 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 08:40:58.873 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 08:40:58.908 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 08:41:00.051 [INFO] taskid : ae0630e9-5de0-4e4d-b2d5-b6890bc30715, task name : full_backtest publish msg to processer
2025-02-01 08:42:00.049 [INFO] taskid : 6a8d33e4-8c3b-4ffd-9735-3b8873efe132, task name : full_backtest publish msg to processer
2025-02-01 08:46:32.598 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 1
2025-02-01 08:46:37.588 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_0f82941a 線程已啟動
2025-02-01 08:46:37.589 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_0f82941a 開始消費隊列 full_backtest
2025-02-01 08:46:37.590 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_8896af94 線程已啟動
2025-02-01 08:46:37.590 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_8896af94 開始消費隊列 pre_process_stock_data
2025-02-01 08:46:37.592 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_bf08e106 線程已啟動
2025-02-01 08:46:37.592 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_bf08e106 開始消費隊列 back_testing
2025-02-01 08:46:42.588 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_0f82941a 收到消息，開始解析
2025-02-01 08:46:46.591 [INFO] [python_ana_process_manager] id=UUID('80d8f302-71ac-4cd0-8457-e9f3de30ab96') created_at=datetime.datetime(2025, 2, 1, 8, 35, 0, 1696) updated_at=datetime.datetime(2025, 2, 1, 8, 35, 0, 1696) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 08:46:47.022 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_0f82941a 解析後消息為: id=UUID('80d8f302-71ac-4cd0-8457-e9f3de30ab96') created_at=datetime.datetime(2025, 2, 1, 8, 35, 0, 1696) updated_at=datetime.datetime(2025, 2, 1, 8, 35, 0, 1696) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 08:46:51.816 [INFO] [python_ana_process_manager] Current Spark memory usage: 705.36MB
2025-02-01 08:46:51.817 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 08:46:54.737 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 08:47:17.684 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 08:47:18.184 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 08:47:24.574 [INFO] [python_ana_process_manager] Current Spark memory usage: 631.42MB
2025-02-01 08:47:24.575 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 08:47:24.750 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 08:47:26.647 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 08:47:26.778 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 08:47:28.265 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_0f82941a 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 08:57:11.904 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 1
2025-02-01 08:57:16.896 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_c23d487d 線程已啟動
2025-02-01 08:57:16.896 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_c23d487d 開始消費隊列 full_backtest
2025-02-01 08:57:16.899 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_7f04b7c4 線程已啟動
2025-02-01 08:57:16.899 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_7f04b7c4 開始消費隊列 pre_process_stock_data
2025-02-01 08:57:16.900 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_0e990c7d 線程已啟動
2025-02-01 08:57:16.901 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_0e990c7d 開始消費隊列 back_testing
2025-02-01 08:57:21.913 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_c23d487d 收到消息，開始解析
2025-02-01 08:57:25.008 [INFO] [python_ana_process_manager] id=UUID('80d8f302-71ac-4cd0-8457-e9f3de30ab96') created_at=datetime.datetime(2025, 2, 1, 8, 35, 0, 1696) updated_at=datetime.datetime(2025, 2, 1, 8, 47, 30, 511935) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Cannot set a DataFrame with multiple columns to the single column TP' sink_params=None set_params=None
2025-02-01 08:57:25.010 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_c23d487d 解析後消息為: id=UUID('80d8f302-71ac-4cd0-8457-e9f3de30ab96') created_at=datetime.datetime(2025, 2, 1, 8, 35, 0, 1696) updated_at=datetime.datetime(2025, 2, 1, 8, 47, 30, 511935) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 16, 32, 26, 179845, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Cannot set a DataFrame with multiple columns to the single column TP' sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 08:57:26.563 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 08:57:26.564 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 08:57:29.379 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 08:57:40.928 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 08:57:41.463 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 08:57:46.429 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 08:57:46.429 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 08:57:46.581 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 08:57:48.252 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 08:57:48.638 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 08:58:05.558 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_c23d487d 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 08:59:39.643 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 1
2025-02-01 08:59:44.647 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_59ad40ef 線程已啟動
2025-02-01 08:59:44.648 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_59ad40ef 開始消費隊列 full_backtest
2025-02-01 08:59:44.649 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_8279c192 線程已啟動
2025-02-01 08:59:44.649 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_8279c192 開始消費隊列 pre_process_stock_data
2025-02-01 08:59:44.650 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_8b0e928f 線程已啟動
2025-02-01 08:59:44.650 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_8b0e928f 開始消費隊列 back_testing
2025-02-01 08:59:49.645 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_59ad40ef 收到消息，開始解析
2025-02-01 08:59:52.388 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_59ad40ef 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 08:59:55.830 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_59ad40ef 收到消息，開始解析
2025-02-01 08:59:58.924 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_59ad40ef 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:00:00.153 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_59ad40ef 收到消息，開始解析
2025-02-01 09:00:01.598 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_59ad40ef 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:00:04.670 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_59ad40ef 收到消息，開始解析
2025-02-01 09:00:05.907 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_59ad40ef 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:00:06.539 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_59ad40ef 收到消息，開始解析
2025-02-01 09:00:07.771 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_59ad40ef 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:01:00.058 [INFO] taskid : 4eacdd18-5c20-497e-8562-552f6e89282b, task name : full_backtest publish msg to processer
2025-02-01 09:01:00.016 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_59ad40ef 收到消息，開始解析
2025-02-01 09:01:02.718 [INFO] [python_ana_process_manager] id=UUID('4eacdd18-5c20-497e-8562-552f6e89282b') created_at=datetime.datetime(2025, 2, 1, 9, 1, 0, 11414) updated_at=datetime.datetime(2025, 2, 1, 9, 1, 0, 11414) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:01:02.720 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_59ad40ef 解析後消息為: id=UUID('4eacdd18-5c20-497e-8562-552f6e89282b') created_at=datetime.datetime(2025, 2, 1, 9, 1, 0, 11414) updated_at=datetime.datetime(2025, 2, 1, 9, 1, 0, 11414) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:01:04.262 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:01:04.263 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:01:07.025 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:01:15.838 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:01:16.128 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:01:18.587 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:01:18.587 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:01:18.730 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:01:20.318 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:01:20.779 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:01:22.877 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_59ad40ef 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:02:00.046 [INFO] taskid : 3bfd2930-efbd-4294-a26f-117378d1046b, task name : full_backtest publish msg to processer
2025-02-01 09:03:00.054 [INFO] taskid : 7a195b85-474b-4d2e-9736-c8c9d5096094, task name : full_backtest publish msg to processer
2025-02-01 09:03:12.704 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 1
2025-02-01 09:03:17.708 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_f9b0c518 線程已啟動
2025-02-01 09:03:17.708 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_f9b0c518 開始消費隊列 full_backtest
2025-02-01 09:03:17.709 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_0f206837 線程已啟動
2025-02-01 09:03:17.710 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_0f206837 開始消費隊列 pre_process_stock_data
2025-02-01 09:03:17.711 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_7e07831e 線程已啟動
2025-02-01 09:03:17.711 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_7e07831e 開始消費隊列 back_testing
2025-02-01 09:03:22.696 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f9b0c518 收到消息，開始解析
2025-02-01 09:03:24.340 [INFO] [python_ana_process_manager] id=UUID('4eacdd18-5c20-497e-8562-552f6e89282b') created_at=datetime.datetime(2025, 2, 1, 9, 1, 0, 11414) updated_at=datetime.datetime(2025, 2, 1, 9, 1, 27, 821400) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Cannot set a DataFrame with multiple columns to the single column TP' sink_params=None set_params=None
2025-02-01 09:03:24.341 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f9b0c518 解析後消息為: id=UUID('4eacdd18-5c20-497e-8562-552f6e89282b') created_at=datetime.datetime(2025, 2, 1, 9, 1, 0, 11414) updated_at=datetime.datetime(2025, 2, 1, 9, 1, 27, 821400) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Cannot set a DataFrame with multiple columns to the single column TP' sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:03:25.939 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:03:25.939 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:03:28.707 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:03:37.213 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:03:37.804 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:03:40.350 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:03:40.350 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:03:40.494 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:03:42.223 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:03:42.523 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:03:43.608 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_f9b0c518 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:03:45.473 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f9b0c518 收到消息，開始解析
2025-02-01 09:03:46.307 [INFO] [python_ana_process_manager] id=UUID('3bfd2930-efbd-4294-a26f-117378d1046b') created_at=datetime.datetime(2025, 2, 1, 9, 2, 0, 1246) updated_at=datetime.datetime(2025, 2, 1, 9, 2, 0, 1246) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:03:46.309 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f9b0c518 解析後消息為: id=UUID('3bfd2930-efbd-4294-a26f-117378d1046b') created_at=datetime.datetime(2025, 2, 1, 9, 2, 0, 1246) updated_at=datetime.datetime(2025, 2, 1, 9, 2, 0, 1246) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:03:47.606 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:03:47.607 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:03:47.751 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:03:50.472 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:03:50.806 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:03:53.084 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:03:53.085 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:03:53.227 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:03:53.987 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:03:54.247 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:03:55.099 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_f9b0c518 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:03:56.756 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f9b0c518 收到消息，開始解析
2025-02-01 09:03:57.602 [INFO] [python_ana_process_manager] id=UUID('7a195b85-474b-4d2e-9736-c8c9d5096094') created_at=datetime.datetime(2025, 2, 1, 9, 3, 0, 1418) updated_at=datetime.datetime(2025, 2, 1, 9, 3, 0, 1418) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:03:57.604 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f9b0c518 解析後消息為: id=UUID('7a195b85-474b-4d2e-9736-c8c9d5096094') created_at=datetime.datetime(2025, 2, 1, 9, 3, 0, 1418) updated_at=datetime.datetime(2025, 2, 1, 9, 3, 0, 1418) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:03:58.866 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:03:58.867 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:03:59.005 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:04:01.541 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:04:02.057 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:04:04.128 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:04:04.129 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:04:04.265 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:04:05.011 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:04:05.274 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:04:06.127 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_f9b0c518 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:04:07.991 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f9b0c518 收到消息，開始解析
2025-02-01 09:04:08.637 [INFO] [python_ana_process_manager] id=UUID('cce5a701-26aa-4514-9112-51e339eb81d3') created_at=datetime.datetime(2025, 2, 1, 9, 4, 0, 1597) updated_at=datetime.datetime(2025, 2, 1, 9, 4, 0, 1597) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:04:08.639 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f9b0c518 解析後消息為: id=UUID('cce5a701-26aa-4514-9112-51e339eb81d3') created_at=datetime.datetime(2025, 2, 1, 9, 4, 0, 1597) updated_at=datetime.datetime(2025, 2, 1, 9, 4, 0, 1597) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:04:10.021 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:04:10.022 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:04:10.158 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:04:12.465 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:04:12.699 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:04:14.825 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:04:14.826 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:04:14.961 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:04:15.671 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:04:15.977 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:04:16.626 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_f9b0c518 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:05:00.010 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f9b0c518 收到消息，開始解析
2025-02-01 09:05:01.460 [INFO] [python_ana_process_manager] id=UUID('4ec8145f-db66-4438-b1d8-90ac6821057a') created_at=datetime.datetime(2025, 2, 1, 9, 5, 0, 2309) updated_at=datetime.datetime(2025, 2, 1, 9, 5, 0, 2309) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:05:01.462 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_f9b0c518 解析後消息為: id=UUID('4ec8145f-db66-4438-b1d8-90ac6821057a') created_at=datetime.datetime(2025, 2, 1, 9, 5, 0, 2309) updated_at=datetime.datetime(2025, 2, 1, 9, 5, 0, 2309) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 0, 37, 979326, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:05:02.616 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:05:02.617 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:05:02.759 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:05:04.973 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:05:05.272 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:05:07.837 [INFO] [python_ana_process_manager] Current Spark memory usage: 704.88MB
2025-02-01 09:05:07.838 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:05:07.974 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:05:08.655 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:05:08.975 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:05:13.253 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_f9b0c518 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:13:09.736 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f
2025-02-01 09:13:09.736 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 正在停止
2025-02-01 09:13:09.737 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4e3ef14f 已完全停止
2025-02-01 09:13:09.737 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_9907258e
2025-02-01 09:13:09.737 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_9907258e 正在停止
2025-02-01 09:13:09.738 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_9907258e 已完全停止
2025-02-01 09:13:09.738 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_7f7a52fb
2025-02-01 09:13:09.738 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_7f7a52fb 正在停止
2025-02-01 09:13:09.739 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_7f7a52fb 已完全停止
2025-02-01 09:13:28.086 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 4
2025-02-01 09:13:33.090 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_cde85983 開始消費隊列 full_backtest
2025-02-01 09:13:33.090 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_cde85983 線程已啟動
2025-02-01 09:13:33.091 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_99daf1f6 開始消費隊列 pre_process_stock_data
2025-02-01 09:13:33.091 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_99daf1f6 線程已啟動
2025-02-01 09:13:33.091 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_be0b974e 開始消費隊列 back_testing
2025-02-01 09:13:33.092 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_be0b974e 線程已啟動
2025-02-01 09:13:33.092 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_cde85983 收到消息，開始解析
2025-02-01 09:13:33.094 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_cde85983 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:14:00.061 [INFO] taskid : 1a290091-8962-495f-933c-ab0fbdf2abfb, task name : full_backtest publish msg to processer
2025-02-01 09:14:00.020 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_cde85983 收到消息，開始解析
2025-02-01 09:14:00.022 [INFO] [python_ana_process_manager] id=UUID('1a290091-8962-495f-933c-ab0fbdf2abfb') created_at=datetime.datetime(2025, 2, 1, 9, 14, 0, 13916) updated_at=datetime.datetime(2025, 2, 1, 9, 14, 0, 13916) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:14:00.023 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_cde85983 解析後消息為: id=UUID('1a290091-8962-495f-933c-ab0fbdf2abfb') created_at=datetime.datetime(2025, 2, 1, 9, 14, 0, 13916) updated_at=datetime.datetime(2025, 2, 1, 9, 14, 0, 13916) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:14:02.125 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:14:04.976 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:14:14.126 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:14:14.584 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:14:16.149 [INFO] [python_ana_process_manager] Current Spark memory usage: 689.29MB
2025-02-01 09:14:16.149 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:14:16.291 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:14:17.711 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:14:17.809 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:14:17.831 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_cde85983 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:14:50.827 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_cde85983
2025-02-01 09:14:50.827 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_cde85983 正在停止
2025-02-01 09:14:50.828 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_cde85983 已完全停止
2025-02-01 09:14:50.828 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_99daf1f6
2025-02-01 09:14:50.828 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_99daf1f6 正在停止
2025-02-01 09:14:50.829 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_99daf1f6 已完全停止
2025-02-01 09:14:50.829 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_be0b974e
2025-02-01 09:14:50.829 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_be0b974e 正在停止
2025-02-01 09:14:50.830 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_be0b974e 已完全停止
2025-02-01 09:15:00.049 [INFO] taskid : 2a7cf56e-1d0c-4af2-a188-ace4fb8b62e9, task name : full_backtest publish msg to processer
2025-02-01 09:15:05.113 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-01 09:15:10.126 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4f957c4f 線程已啟動
2025-02-01 09:15:10.128 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4f957c4f 開始消費隊列 full_backtest
2025-02-01 09:15:10.129 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_784f8545 線程已啟動
2025-02-01 09:15:10.130 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_784f8545 開始消費隊列 pre_process_stock_data
2025-02-01 09:15:10.131 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_31c6b1b3 線程已啟動
2025-02-01 09:15:10.131 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_31c6b1b3 開始消費隊列 back_testing
2025-02-01 09:15:15.119 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f957c4f 收到消息，開始解析
2025-02-01 09:15:18.196 [INFO] [python_ana_process_manager] id=UUID('2a7cf56e-1d0c-4af2-a188-ace4fb8b62e9') created_at=datetime.datetime(2025, 2, 1, 9, 15, 0, 2118) updated_at=datetime.datetime(2025, 2, 1, 9, 15, 0, 2118) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:15:18.198 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f957c4f 解析後消息為: id=UUID('2a7cf56e-1d0c-4af2-a188-ace4fb8b62e9') created_at=datetime.datetime(2025, 2, 1, 9, 15, 0, 2118) updated_at=datetime.datetime(2025, 2, 1, 9, 15, 0, 2118) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:15:20.303 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:15:23.091 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:15:32.234 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:15:32.684 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:15:32.823 [INFO] [python_ana_process_manager] Current Spark memory usage: 725.68MB
2025-02-01 09:15:32.824 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:15:32.974 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:15:34.716 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:15:35.001 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:15:36.675 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4f957c4f 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:16:00.087 [INFO] taskid : 411d0978-5b60-492d-9fb3-243955329082, task name : full_backtest publish msg to processer
2025-02-01 09:16:00.042 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f957c4f 收到消息，開始解析
2025-02-01 09:16:00.045 [INFO] [python_ana_process_manager] id=UUID('411d0978-5b60-492d-9fb3-243955329082') created_at=datetime.datetime(2025, 2, 1, 9, 16, 0, 2227) updated_at=datetime.datetime(2025, 2, 1, 9, 16, 0, 2227) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:16:00.047 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f957c4f 解析後消息為: id=UUID('411d0978-5b60-492d-9fb3-243955329082') created_at=datetime.datetime(2025, 2, 1, 9, 16, 0, 2227) updated_at=datetime.datetime(2025, 2, 1, 9, 16, 0, 2227) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:16:00.190 [INFO] [python_ana_process_manager] Current Spark memory usage: 696.97MB
2025-02-01 09:16:00.191 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:16:00.333 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:16:03.246 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:16:03.379 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:16:05.605 [INFO] [python_ana_process_manager] Current Spark memory usage: 763.50MB
2025-02-01 09:16:05.605 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:16:05.757 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:16:06.526 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:16:06.767 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:16:06.806 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4f957c4f 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:17:00.008 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f957c4f 收到消息，開始解析
2025-02-01 09:17:00.012 [INFO] [python_ana_process_manager] id=UUID('497b75b9-88ce-4d49-ac8c-0602924e145c') created_at=datetime.datetime(2025, 2, 1, 9, 17, 0, 2388) updated_at=datetime.datetime(2025, 2, 1, 9, 17, 0, 2388) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:17:00.013 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_4f957c4f 解析後消息為: id=UUID('497b75b9-88ce-4d49-ac8c-0602924e145c') created_at=datetime.datetime(2025, 2, 1, 9, 17, 0, 2388) updated_at=datetime.datetime(2025, 2, 1, 9, 17, 0, 2388) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:17:00.154 [INFO] [python_ana_process_manager] Current Spark memory usage: 725.34MB
2025-02-01 09:17:00.155 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:17:00.294 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:17:02.799 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:17:03.331 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:17:19.091 [INFO] [python_ana_process_manager] Current Spark memory usage: 730.62MB
2025-02-01 09:17:19.092 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:17:19.231 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:17:20.037 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:17:20.263 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:17:20.301 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_4f957c4f 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:17:54.515 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 4
2025-02-01 09:17:59.513 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_d45ab96b 線程已啟動
2025-02-01 09:17:59.514 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_d45ab96b 開始消費隊列 full_backtest
2025-02-01 09:17:59.515 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_fc09b481 線程已啟動
2025-02-01 09:17:59.515 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_fc09b481 開始消費隊列 pre_process_stock_data
2025-02-01 09:17:59.517 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_6245590b 線程已啟動
2025-02-01 09:17:59.517 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_6245590b 開始消費隊列 back_testing
2025-02-01 09:18:04.505 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_d45ab96b 收到消息，開始解析
2025-02-01 09:18:04.509 [INFO] [python_ana_process_manager] id=UUID('08da778d-a366-438d-8d5c-5cc1a96edcc4') created_at=datetime.datetime(2025, 2, 1, 9, 18, 0, 2918) updated_at=datetime.datetime(2025, 2, 1, 9, 18, 0, 2918) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:18:04.510 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_d45ab96b 解析後消息為: id=UUID('08da778d-a366-438d-8d5c-5cc1a96edcc4') created_at=datetime.datetime(2025, 2, 1, 9, 18, 0, 2918) updated_at=datetime.datetime(2025, 2, 1, 9, 18, 0, 2918) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:18:06.564 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:18:09.315 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:18:18.156 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:18:18.449 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:18:22.039 [INFO] [python_ana_process_manager] Current Spark memory usage: 593.74MB
2025-02-01 09:18:22.040 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:18:22.191 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:18:23.918 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:18:24.203 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:18:24.244 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_d45ab96b 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:19:00.010 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_d45ab96b 收到消息，開始解析
2025-02-01 09:19:00.012 [INFO] [python_ana_process_manager] id=UUID('905f4cbd-2fa9-40e4-8afd-7384db717554') created_at=datetime.datetime(2025, 2, 1, 9, 19, 0, 2745) updated_at=datetime.datetime(2025, 2, 1, 9, 19, 0, 2745) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:19:00.015 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_d45ab96b 解析後消息為: id=UUID('905f4cbd-2fa9-40e4-8afd-7384db717554') created_at=datetime.datetime(2025, 2, 1, 9, 19, 0, 2745) updated_at=datetime.datetime(2025, 2, 1, 9, 19, 0, 2745) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 13, 31, 281996, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:19:00.979 [INFO] [python_ana_process_manager] Current Spark memory usage: 542.16MB
2025-02-01 09:19:00.979 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:19:01.136 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:19:03.954 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:19:04.179 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:19:12.178 [INFO] [python_ana_process_manager] Current Spark memory usage: 707.86MB
2025-02-01 09:19:12.180 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:19:12.320 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:19:13.134 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:19:13.332 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:19:13.372 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_d45ab96b 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:24:58.519 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-01 09:25:03.521 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_038a14a2 線程已啟動
2025-02-01 09:25:03.522 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_038a14a2 開始消費隊列 full_backtest
2025-02-01 09:25:03.524 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_7afd9127 線程已啟動
2025-02-01 09:25:03.524 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_7afd9127 開始消費隊列 pre_process_stock_data
2025-02-01 09:25:03.526 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_1923bddd 線程已啟動
2025-02-01 09:25:03.526 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_1923bddd 開始消費隊列 back_testing
2025-02-01 09:26:00.066 [INFO] taskid : a7d62fc4-0107-4b3e-ad92-a8b2193140b2, task name : full_backtest publish msg to processer
2025-02-01 09:26:00.024 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_038a14a2 收到消息，開始解析
2025-02-01 09:26:00.028 [INFO] [python_ana_process_manager] id=UUID('a7d62fc4-0107-4b3e-ad92-a8b2193140b2') created_at=datetime.datetime(2025, 2, 1, 9, 26, 0, 16068) updated_at=datetime.datetime(2025, 2, 1, 9, 26, 0, 16068) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:26:00.030 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_038a14a2 解析後消息為: id=UUID('a7d62fc4-0107-4b3e-ad92-a8b2193140b2') created_at=datetime.datetime(2025, 2, 1, 9, 26, 0, 16068) updated_at=datetime.datetime(2025, 2, 1, 9, 26, 0, 16068) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:26:02.341 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:26:05.251 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:26:14.466 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:26:14.843 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:26:20.864 [INFO] [python_ana_process_manager] Current Spark memory usage: 511.46MB
2025-02-01 09:26:20.864 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:26:21.021 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:26:22.708 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:26:23.050 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:26:23.091 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_038a14a2 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:27:00.053 [INFO] taskid : 5939a0c1-6a06-4bf0-8eb7-6818876d4227, task name : full_backtest publish msg to processer
2025-02-01 09:27:00.007 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_038a14a2 收到消息，開始解析
2025-02-01 09:27:00.010 [INFO] [python_ana_process_manager] id=UUID('5939a0c1-6a06-4bf0-8eb7-6818876d4227') created_at=datetime.datetime(2025, 2, 1, 9, 27, 0, 1263) updated_at=datetime.datetime(2025, 2, 1, 9, 27, 0, 1263) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:27:00.011 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_038a14a2 解析後消息為: id=UUID('5939a0c1-6a06-4bf0-8eb7-6818876d4227') created_at=datetime.datetime(2025, 2, 1, 9, 27, 0, 1263) updated_at=datetime.datetime(2025, 2, 1, 9, 27, 0, 1263) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:27:01.221 [INFO] [python_ana_process_manager] Current Spark memory usage: 547.74MB
2025-02-01 09:27:01.222 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:27:01.378 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:27:04.350 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:27:04.434 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:27:09.633 [INFO] [python_ana_process_manager] Current Spark memory usage: 743.43MB
2025-02-01 09:27:09.634 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:27:09.780 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:27:10.649 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:27:10.779 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:27:10.819 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_038a14a2 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:28:00.061 [INFO] taskid : 0cb43bc1-74f1-4836-8382-075cb8905784, task name : full_backtest publish msg to processer
2025-02-01 09:28:00.013 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_038a14a2 收到消息，開始解析
2025-02-01 09:28:00.016 [INFO] [python_ana_process_manager] id=UUID('0cb43bc1-74f1-4836-8382-075cb8905784') created_at=datetime.datetime(2025, 2, 1, 9, 28, 0, 1161) updated_at=datetime.datetime(2025, 2, 1, 9, 28, 0, 1161) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:28:00.018 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_038a14a2 解析後消息為: id=UUID('0cb43bc1-74f1-4836-8382-075cb8905784') created_at=datetime.datetime(2025, 2, 1, 9, 28, 0, 1161) updated_at=datetime.datetime(2025, 2, 1, 9, 28, 0, 1161) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 25, 0, 947716, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:28:01.762 [INFO] [python_ana_process_manager] Current Spark memory usage: 890.85MB
2025-02-01 09:28:01.763 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:28:01.914 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:28:04.646 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:28:04.971 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:28:13.155 [INFO] [python_ana_process_manager] Current Spark memory usage: 884.26MB
2025-02-01 09:28:13.171 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:28:13.340 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:28:14.128 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:28:14.378 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:31:00.270 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-01 09:31:05.264 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_ea55814c 線程已啟動
2025-02-01 09:31:05.265 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_ea55814c 開始消費隊列 full_backtest
2025-02-01 09:31:05.267 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_ba8407e6 線程已啟動
2025-02-01 09:31:05.267 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_ba8407e6 開始消費隊列 pre_process_stock_data
2025-02-01 09:31:05.268 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_d4552a31 線程已啟動
2025-02-01 09:31:05.268 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_d4552a31 開始消費隊列 back_testing
2025-02-01 09:32:00.063 [INFO] taskid : 0c4cb2bf-5fa3-461f-b259-ba6aaeb3059c, task name : full_backtest publish msg to processer
2025-02-01 09:32:00.016 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_ea55814c 收到消息，開始解析
2025-02-01 09:32:00.019 [INFO] [python_ana_process_manager] id=UUID('0c4cb2bf-5fa3-461f-b259-ba6aaeb3059c') created_at=datetime.datetime(2025, 2, 1, 9, 32, 0, 11200) updated_at=datetime.datetime(2025, 2, 1, 9, 32, 0, 11200) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:32:00.021 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_ea55814c 解析後消息為: id=UUID('0c4cb2bf-5fa3-461f-b259-ba6aaeb3059c') created_at=datetime.datetime(2025, 2, 1, 9, 32, 0, 11200) updated_at=datetime.datetime(2025, 2, 1, 9, 32, 0, 11200) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:32:02.051 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:32:04.781 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:32:13.562 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:32:13.864 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:32:17.383 [INFO] [python_ana_process_manager] Current Spark memory usage: 676.02MB
2025-02-01 09:32:17.383 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:32:17.530 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:32:19.185 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:32:19.576 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:32:41.717 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_ea55814c 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:33:00.050 [INFO] taskid : 42ba2760-92a8-4a42-a30e-09d1349866d1, task name : full_backtest publish msg to processer
2025-02-01 09:33:00.006 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_ea55814c 收到消息，開始解析
2025-02-01 09:33:00.009 [INFO] [python_ana_process_manager] id=UUID('42ba2760-92a8-4a42-a30e-09d1349866d1') created_at=datetime.datetime(2025, 2, 1, 9, 33, 0, 1744) updated_at=datetime.datetime(2025, 2, 1, 9, 33, 0, 1744) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:33:00.011 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_ea55814c 解析後消息為: id=UUID('42ba2760-92a8-4a42-a30e-09d1349866d1') created_at=datetime.datetime(2025, 2, 1, 9, 33, 0, 1744) updated_at=datetime.datetime(2025, 2, 1, 9, 33, 0, 1744) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:33:01.292 [INFO] [python_ana_process_manager] Current Spark memory usage: 622.04MB
2025-02-01 09:33:01.292 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:33:01.442 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:33:04.292 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:33:04.487 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:33:07.445 [INFO] [python_ana_process_manager] Current Spark memory usage: 663.47MB
2025-02-01 09:33:07.446 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:33:07.590 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:33:08.355 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:33:08.617 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:33:46.213 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_ea55814c 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:34:00.058 [INFO] taskid : e1e498a5-aa78-4b4d-a335-00b6673baaff, task name : full_backtest publish msg to processer
2025-02-01 09:36:41.432 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-01 09:36:46.413 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_c946a7db 線程已啟動
2025-02-01 09:36:46.414 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_c946a7db 開始消費隊列 full_backtest
2025-02-01 09:36:46.416 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_c1aa6cca 線程已啟動
2025-02-01 09:36:46.416 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_c1aa6cca 開始消費隊列 pre_process_stock_data
2025-02-01 09:36:46.417 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_6014e3c0 線程已啟動
2025-02-01 09:36:46.418 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_6014e3c0 開始消費隊列 back_testing
2025-02-01 09:36:51.417 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_c946a7db 收到消息，開始解析
2025-02-01 09:36:51.420 [INFO] [python_ana_process_manager] id=UUID('e1e498a5-aa78-4b4d-a335-00b6673baaff') created_at=datetime.datetime(2025, 2, 1, 9, 34, 0, 2118) updated_at=datetime.datetime(2025, 2, 1, 9, 34, 4, 407628) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:36:51.422 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_c946a7db 解析後消息為: id=UUID('e1e498a5-aa78-4b4d-a335-00b6673baaff') created_at=datetime.datetime(2025, 2, 1, 9, 34, 0, 2118) updated_at=datetime.datetime(2025, 2, 1, 9, 34, 4, 407628) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:36:53.078 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:36:55.822 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:37:04.518 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:37:04.907 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:37:06.196 [INFO] [python_ana_process_manager] Current Spark memory usage: 592.20MB
2025-02-01 09:37:06.197 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:37:06.346 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:37:07.948 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:37:08.388 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:38:28.937 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_c946a7db 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:38:28.948 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_c946a7db 收到消息，開始解析
2025-02-01 09:38:28.950 [INFO] [python_ana_process_manager] id=UUID('a03c274f-138a-4b95-b149-4484e7956f10') created_at=datetime.datetime(2025, 2, 1, 9, 35, 0, 2046) updated_at=datetime.datetime(2025, 2, 1, 9, 35, 0, 2046) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:38:28.952 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_c946a7db 解析後消息為: id=UUID('a03c274f-138a-4b95-b149-4484e7956f10') created_at=datetime.datetime(2025, 2, 1, 9, 35, 0, 2046) updated_at=datetime.datetime(2025, 2, 1, 9, 35, 0, 2046) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 10, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 31, 35, 684012, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-10-31', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:38:30.473 [INFO] [python_ana_process_manager] Current Spark memory usage: 563.99MB
2025-02-01 09:38:30.475 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:38:30.624 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:38:33.450 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:38:33.682 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:38:39.974 [INFO] [python_ana_process_manager] Current Spark memory usage: 687.88MB
2025-02-01 09:38:39.975 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:38:40.126 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:38:41.029 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:38:41.158 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:39:52.930 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_c946a7db 任務失敗: Cannot set a DataFrame with multiple columns to the single column TP
2025-02-01 09:42:00.071 [INFO] taskid : 392dac44-e5a5-4520-8815-382c0c9f93df, task name : full_backtest publish msg to processer
2025-02-01 09:42:34.960 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-01 09:42:39.958 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_83529565 線程已啟動
2025-02-01 09:42:39.959 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_83529565 開始消費隊列 full_backtest
2025-02-01 09:42:39.960 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bd47e4c2 線程已啟動
2025-02-01 09:42:39.960 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bd47e4c2 開始消費隊列 pre_process_stock_data
2025-02-01 09:42:39.962 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_472f35a1 線程已啟動
2025-02-01 09:42:39.962 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_472f35a1 開始消費隊列 back_testing
2025-02-01 09:42:44.956 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:42:44.959 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_83529565 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:42:44.960 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:42:44.961 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_83529565 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:42:44.963 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:42:44.966 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_83529565 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:42:44.968 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:42:44.969 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_83529565 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:42:44.971 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:42:44.973 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_83529565 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:42:44.974 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:42:44.976 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_83529565 任務失敗: Full Backtest 任務執行階段失敗: task event不存在
2025-02-01 09:43:00.049 [INFO] taskid : f6aede97-5838-48ee-897a-91557626e11a, task name : full_backtest publish msg to processer
2025-02-01 09:42:44.978 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:42:44.979 [INFO] [python_ana_process_manager] id=UUID('392dac44-e5a5-4520-8815-382c0c9f93df') created_at=datetime.datetime(2025, 2, 1, 9, 42, 0, 10319) updated_at=datetime.datetime(2025, 2, 1, 9, 42, 0, 10319) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:42:44.981 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 解析後消息為: id=UUID('392dac44-e5a5-4520-8815-382c0c9f93df') created_at=datetime.datetime(2025, 2, 1, 9, 42, 0, 10319) updated_at=datetime.datetime(2025, 2, 1, 9, 42, 0, 10319) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-01', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:42:46.858 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:42:49.676 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:42:58.596 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:42:58.787 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:43:00.355 [INFO] [python_ana_process_manager] Current Spark memory usage: 698.59MB
2025-02-01 09:43:00.356 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:43:00.512 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:43:02.347 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:43:02.559 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:43:18.622 [INFO] [python_ana_process_manager] 提交任務 4fd34cf5-c622-4068-829c-b67b1b6668ff: _muti_process_run_test
2025-02-01 09:44:00.047 [INFO] taskid : 89e21df5-d4a9-49cb-8962-33a17d6cb988, task name : full_backtest publish msg to processer
2025-02-01 09:43:18.633 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:43:18.635 [INFO] [python_ana_process_manager] id=UUID('f6aede97-5838-48ee-897a-91557626e11a') created_at=datetime.datetime(2025, 2, 1, 9, 43, 0, 2414) updated_at=datetime.datetime(2025, 2, 1, 9, 43, 0, 2414) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:43:18.638 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 解析後消息為: id=UUID('f6aede97-5838-48ee-897a-91557626e11a') created_at=datetime.datetime(2025, 2, 1, 9, 43, 0, 2414) updated_at=datetime.datetime(2025, 2, 1, 9, 43, 0, 2414) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-01', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:43:20.439 [INFO] [python_ana_process_manager] Current Spark memory usage: 766.30MB
2025-02-01 09:43:20.440 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:43:20.598 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:43:23.550 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:43:23.649 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:43:25.117 [INFO] [python_ana_process_manager] Current Spark memory usage: 848.40MB
2025-02-01 09:43:25.119 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:43:25.277 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:43:26.129 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:43:26.281 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:44:46.408 [INFO] [python_ana_process_manager] 任務 4fd34cf5-c622-4068-829c-b67b1b6668ff 完成
2025-02-01 09:44:46.409 [INFO] [python_ana_process_manager] 任務 4fd34cf5-c622-4068-829c-b67b1b6668ff 完成，執行時間: 87.79秒
2025-02-01 09:44:47.324 [INFO] [python_ana_process_manager] 提交任務 d524cea3-2d4d-4e99-b6a8-165f009302d2: _muti_process_run_test
2025-02-01 09:44:47.335 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:44:47.338 [INFO] [python_ana_process_manager] id=UUID('89e21df5-d4a9-49cb-8962-33a17d6cb988') created_at=datetime.datetime(2025, 2, 1, 9, 44, 0, 3052) updated_at=datetime.datetime(2025, 2, 1, 9, 44, 0, 3052) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:44:47.340 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 解析後消息為: id=UUID('89e21df5-d4a9-49cb-8962-33a17d6cb988') created_at=datetime.datetime(2025, 2, 1, 9, 44, 0, 3052) updated_at=datetime.datetime(2025, 2, 1, 9, 44, 0, 3052) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-01', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:44:49.134 [INFO] [python_ana_process_manager] 任務 d524cea3-2d4d-4e99-b6a8-165f009302d2 完成
2025-02-01 09:44:49.144 [INFO] [python_ana_process_manager] Current Spark memory usage: 786.04MB
2025-02-01 09:44:49.145 [INFO] [python_ana_process_manager] 任務 d524cea3-2d4d-4e99-b6a8-165f009302d2 完成，執行時間: 1.81秒
2025-02-01 09:44:49.147 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:44:49.347 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:44:52.006 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:44:52.373 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:44:53.554 [INFO] [python_ana_process_manager] Current Spark memory usage: 845.49MB
2025-02-01 09:44:53.555 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:44:53.703 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:44:54.458 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:44:54.714 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:44:54.752 [INFO] [python_ana_process_manager] 提交任務 f4f9f465-decc-4608-ba0e-83dd7c6bd59b: _muti_process_run_test
2025-02-01 09:44:56.213 [INFO] [python_ana_process_manager] 任務 f4f9f465-decc-4608-ba0e-83dd7c6bd59b 完成
2025-02-01 09:44:56.213 [INFO] [python_ana_process_manager] 任務 f4f9f465-decc-4608-ba0e-83dd7c6bd59b 完成，執行時間: 1.46秒
2025-02-01 09:45:00.006 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:45:00.008 [INFO] [python_ana_process_manager] id=UUID('9866ce90-dfc7-46b2-8507-96ef92e55b1c') created_at=datetime.datetime(2025, 2, 1, 9, 45, 0, 2432) updated_at=datetime.datetime(2025, 2, 1, 9, 45, 0, 2432) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:45:00.010 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 解析後消息為: id=UUID('9866ce90-dfc7-46b2-8507-96ef92e55b1c') created_at=datetime.datetime(2025, 2, 1, 9, 45, 0, 2432) updated_at=datetime.datetime(2025, 2, 1, 9, 45, 0, 2432) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-01', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:45:01.121 [INFO] [python_ana_process_manager] Current Spark memory usage: 800.29MB
2025-02-01 09:45:01.121 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:45:01.257 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:45:03.614 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:45:03.790 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:45:05.002 [INFO] [python_ana_process_manager] Current Spark memory usage: 814.28MB
2025-02-01 09:45:05.003 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:45:05.144 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:45:05.855 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:45:06.175 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:45:06.208 [INFO] [python_ana_process_manager] 提交任務 65858335-f446-4c1a-9ecd-98a92a391f04: _muti_process_run_test
2025-02-01 09:45:06.214 [INFO] [python_ana_process_manager] 任務 65858335-f446-4c1a-9ecd-98a92a391f04 完成
2025-02-01 09:45:06.216 [INFO] [python_ana_process_manager] 任務 65858335-f446-4c1a-9ecd-98a92a391f04 完成，執行時間: 0.01秒
2025-02-01 09:46:00.004 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:46:00.006 [INFO] [python_ana_process_manager] id=UUID('836c2c9e-08f1-4344-93ce-518656db0255') created_at=datetime.datetime(2025, 2, 1, 9, 46, 0, 1243) updated_at=datetime.datetime(2025, 2, 1, 9, 46, 0, 1243) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:46:00.008 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 解析後消息為: id=UUID('836c2c9e-08f1-4344-93ce-518656db0255') created_at=datetime.datetime(2025, 2, 1, 9, 46, 0, 1243) updated_at=datetime.datetime(2025, 2, 1, 9, 46, 0, 1243) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-01', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:46:01.236 [INFO] [python_ana_process_manager] Current Spark memory usage: 853.98MB
2025-02-01 09:46:01.237 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:46:01.375 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:46:03.702 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:46:03.904 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:46:05.493 [INFO] [python_ana_process_manager] Current Spark memory usage: 826.82MB
2025-02-01 09:46:05.494 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:46:05.634 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:46:06.367 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:46:06.660 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:46:06.701 [INFO] [python_ana_process_manager] 提交任務 d25084cc-7fc1-41cc-9633-d4f3d290fc6e: _muti_process_run_test
2025-02-01 09:46:06.705 [INFO] [python_ana_process_manager] 任務 d25084cc-7fc1-41cc-9633-d4f3d290fc6e 完成
2025-02-01 09:46:06.706 [INFO] [python_ana_process_manager] 任務 d25084cc-7fc1-41cc-9633-d4f3d290fc6e 完成，執行時間: 0.01秒
2025-02-01 09:47:00.005 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:47:00.008 [INFO] [python_ana_process_manager] id=UUID('aa140492-f421-46d7-8b83-8a90876e6094') created_at=datetime.datetime(2025, 2, 1, 9, 47, 0, 1212) updated_at=datetime.datetime(2025, 2, 1, 9, 47, 0, 1212) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:47:00.009 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 解析後消息為: id=UUID('aa140492-f421-46d7-8b83-8a90876e6094') created_at=datetime.datetime(2025, 2, 1, 9, 47, 0, 1212) updated_at=datetime.datetime(2025, 2, 1, 9, 47, 0, 1212) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-01', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:47:01.107 [INFO] [python_ana_process_manager] Current Spark memory usage: 824.90MB
2025-02-01 09:47:01.107 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:47:01.245 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:47:03.582 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:47:03.761 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:47:04.961 [INFO] [python_ana_process_manager] Current Spark memory usage: 920.89MB
2025-02-01 09:47:04.962 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:47:05.100 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:47:05.933 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:47:06.162 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:49:14.638 [INFO] [python_ana_process_manager] 提交任務 3d01795a-d16c-4334-83f7-53495d791948: _muti_process_run_test
2025-02-01 09:49:14.648 [INFO] [python_ana_process_manager] 任務 3d01795a-d16c-4334-83f7-53495d791948 完成
2025-02-01 09:49:14.649 [INFO] [python_ana_process_manager] 任務 3d01795a-d16c-4334-83f7-53495d791948 完成，執行時間: 0.01秒
2025-02-01 09:49:14.652 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:49:14.655 [INFO] [python_ana_process_manager] id=UUID('869a6635-9e0a-4ec5-80a7-d74dd60e3db6') created_at=datetime.datetime(2025, 2, 1, 9, 48, 0, 1662) updated_at=datetime.datetime(2025, 2, 1, 9, 48, 0, 1662) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:49:14.657 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 解析後消息為: id=UUID('869a6635-9e0a-4ec5-80a7-d74dd60e3db6') created_at=datetime.datetime(2025, 2, 1, 9, 48, 0, 1662) updated_at=datetime.datetime(2025, 2, 1, 9, 48, 0, 1662) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-01', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:49:15.851 [INFO] [python_ana_process_manager] Current Spark memory usage: 933.87MB
2025-02-01 09:49:15.852 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:49:15.990 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:49:18.358 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:49:18.535 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:49:19.972 [INFO] [python_ana_process_manager] Current Spark memory usage: 1015.00MB
2025-02-01 09:49:19.973 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:49:20.107 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:49:20.787 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:49:21.111 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:49:24.739 [INFO] [python_ana_process_manager] 提交任務 3ca49ebd-3fda-408a-b698-1209f4f0481e: _muti_process_run_test
2025-02-01 09:49:24.746 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 收到消息，開始解析
2025-02-01 09:49:24.749 [INFO] [python_ana_process_manager] id=UUID('93afe5f7-bf34-4c10-952a-71874a2d5fd4') created_at=datetime.datetime(2025, 2, 1, 9, 49, 0, 1220) updated_at=datetime.datetime(2025, 2, 1, 9, 49, 0, 1220) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-01 09:49:24.751 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_83529565 解析後消息為: id=UUID('93afe5f7-bf34-4c10-952a-71874a2d5fd4') created_at=datetime.datetime(2025, 2, 1, 9, 49, 0, 1220) updated_at=datetime.datetime(2025, 2, 1, 9, 49, 0, 1220) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 1, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 1, 31, 17, 41, 55, 481480, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-01', 'end_time': '2025-01-31'}, 準備開始fullbacktest處理任務
2025-02-01 09:49:24.751 [INFO] [python_ana_process_manager] 任務 3ca49ebd-3fda-408a-b698-1209f4f0481e 完成
2025-02-01 09:49:24.752 [INFO] [python_ana_process_manager] 任務 3ca49ebd-3fda-408a-b698-1209f4f0481e 完成，執行時間: 0.01秒
2025-02-01 09:49:26.019 [INFO] [python_ana_process_manager] Current Spark memory usage: 943.61MB
2025-02-01 09:49:26.019 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:49:26.155 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-01 09:49:28.329 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:49:28.677 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:49:29.921 [INFO] [python_ana_process_manager] Current Spark memory usage: 1005.09MB
2025-02-01 09:49:29.922 [INFO] [python_ana_process_manager] Starting session creating
2025-02-01 09:49:30.050 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-01 09:49:30.759 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-01 09:49:31.057 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-01 09:50:25.549 [INFO] [python_ana_process_manager] 提交任務 11565309-e194-494c-838c-b56cf68aa24f: _muti_process_run_test
2025-02-03 07:54:39.507 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 1
2025-02-03 07:54:44.535 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_746c84ad 開始消費隊列 full_backtest
2025-02-03 07:54:44.535 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_746c84ad 線程已啟動
2025-02-03 07:54:44.536 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_463c5121 開始消費隊列 pre_process_stock_data
2025-02-03 07:54:44.537 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_463c5121 線程已啟動
2025-02-03 07:54:44.538 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_f8ec1461 開始消費隊列 back_testing
2025-02-03 07:54:44.538 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_f8ec1461 線程已啟動
2025-02-03 07:54:50.598 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_746c84ad
2025-02-03 07:54:50.598 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_746c84ad 正在停止
2025-02-03 07:54:50.599 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_746c84ad 已完全停止
2025-02-03 07:54:50.599 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_463c5121
2025-02-03 07:54:50.599 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_463c5121 正在停止
2025-02-03 07:54:50.600 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_463c5121 已完全停止
2025-02-03 07:54:50.600 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_f8ec1461
2025-02-03 07:54:50.600 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_f8ec1461 正在停止
2025-02-03 07:54:50.601 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_f8ec1461 已完全停止
2025-02-03 07:55:27.062 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 1
2025-02-03 07:55:32.051 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_faf24530 開始消費隊列 full_backtest
2025-02-03 07:55:32.051 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_faf24530 線程已啟動
2025-02-03 07:55:32.053 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_2c5fe109 開始消費隊列 pre_process_stock_data
2025-02-03 07:55:32.053 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_2c5fe109 線程已啟動
2025-02-03 07:55:32.054 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_392a4a1f 開始消費隊列 back_testing
2025-02-03 07:55:32.054 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_392a4a1f 線程已啟動
2025-02-03 07:57:00.047 [INFO] task : c6bc0c4c-790d-40ff-a084-a1b4ec4ab11d start download raw data stage
2025-02-03 07:57:00.050 [INFO] 執行 Sync Taiwan Stock Service, date : 20250201, code : 2317
2025-02-03 07:57:00.191 [ERROR] task : c6bc0c4c-790d-40ff-a084-a1b4ec4ab11d failed at download raw data stage
2025-02-03 08:06:00.015 [INFO] task : ebdfa930-4a6a-4329-828a-416fa2a356ad start download raw data stage
2025-02-03 08:06:00.017 [INFO] 執行 Sync Taiwan Stock Service, date : 20250201, code : 2317
2025-02-03 08:06:00.206 [INFO] taskid : ebdfa930-4a6a-4329-828a-416fa2a356ad, task name : full_backtest publish msg to processer
2025-02-03 08:06:00.160 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_faf24530 收到消息，開始解析
2025-02-03 08:06:00.166 [INFO] [python_ana_process_manager] id=UUID('ebdfa930-4a6a-4329-828a-416fa2a356ad') created_at=datetime.datetime(2025, 2, 3, 8, 6, 0, 12582) updated_at=datetime.datetime(2025, 2, 3, 8, 6, 0, 12582) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 5, 11, 908140, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 5, 11, 908140, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:06:00.168 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_faf24530 解析後消息為: id=UUID('ebdfa930-4a6a-4329-828a-416fa2a356ad') created_at=datetime.datetime(2025, 2, 3, 8, 6, 0, 12582) updated_at=datetime.datetime(2025, 2, 3, 8, 6, 0, 12582) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 5, 11, 908140, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 5, 11, 908140, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:06:02.001 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:06:11.582 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:06:21.456 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:06:21.667 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:06:22.991 [INFO] [python_ana_process_manager] Current Spark memory usage: 666.31MB
2025-02-03 08:06:22.992 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:06:23.133 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:06:26.223 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:06:26.728 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:06:26.739 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_faf24530 任務失敗: GuruTester.is_input_validated() takes 2 positional arguments but 3 were given
2025-02-03 08:07:00.038 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_faf24530 收到消息，開始解析
2025-02-03 08:07:00.040 [INFO] [python_ana_process_manager] id=UUID('afd06f94-fee2-4900-95c6-951d185bf463') created_at=datetime.datetime(2025, 2, 3, 8, 7, 0, 3190) updated_at=datetime.datetime(2025, 2, 3, 8, 7, 0, 3190) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 5, 11, 908140, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 5, 11, 908140, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:07:00.041 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_faf24530 解析後消息為: id=UUID('afd06f94-fee2-4900-95c6-951d185bf463') created_at=datetime.datetime(2025, 2, 3, 8, 7, 0, 3190) updated_at=datetime.datetime(2025, 2, 3, 8, 7, 0, 3190) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 5, 11, 908140, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 5, 11, 908140, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:07:01.288 [INFO] [python_ana_process_manager] Current Spark memory usage: 719.01MB
2025-02-03 08:07:01.288 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:07:01.421 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:07:04.043 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:07:04.477 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:07:05.711 [INFO] [python_ana_process_manager] Current Spark memory usage: 800.57MB
2025-02-03 08:07:05.712 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:07:05.850 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:07:06.535 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:07:06.852 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:07:06.857 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_faf24530 任務失敗: GuruTester.is_input_validated() takes 2 positional arguments but 3 were given
2025-02-03 08:08:00.278 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_faf24530
2025-02-03 08:08:00.278 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_faf24530 正在停止
2025-02-03 08:08:00.279 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_faf24530 已完全停止
2025-02-03 08:08:00.279 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_2c5fe109
2025-02-03 08:08:00.280 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_2c5fe109 正在停止
2025-02-03 08:08:00.280 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_2c5fe109 已完全停止
2025-02-03 08:08:00.280 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_392a4a1f
2025-02-03 08:08:00.280 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_392a4a1f 正在停止
2025-02-03 08:08:00.281 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_392a4a1f 已完全停止
2025-02-03 08:08:21.974 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 2
2025-02-03 08:08:26.980 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_846769b7 開始消費隊列 full_backtest
2025-02-03 08:08:26.980 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_846769b7 線程已啟動
2025-02-03 08:08:26.981 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_91138441 開始消費隊列 pre_process_stock_data
2025-02-03 08:08:26.981 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_91138441 線程已啟動
2025-02-03 08:08:26.981 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a70e7108 開始消費隊列 back_testing
2025-02-03 08:08:26.981 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a70e7108 線程已啟動
2025-02-03 08:10:00.017 [INFO] task : d686e59c-b001-4ae0-8ff9-936b50e9f7f9 start download raw data stage
2025-02-03 08:10:00.019 [INFO] 執行 Sync Taiwan Stock Service, date : 20250201, code : 2317
2025-02-03 08:10:00.227 [INFO] taskid : d686e59c-b001-4ae0-8ff9-936b50e9f7f9, task name : full_backtest publish msg to processer
2025-02-03 08:10:00.183 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_846769b7 收到消息，開始解析
2025-02-03 08:10:00.185 [INFO] [python_ana_process_manager] id=UUID('d686e59c-b001-4ae0-8ff9-936b50e9f7f9') created_at=datetime.datetime(2025, 2, 3, 8, 10, 0, 14326) updated_at=datetime.datetime(2025, 2, 3, 8, 10, 0, 14326) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:10:00.186 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_846769b7 解析後消息為: id=UUID('d686e59c-b001-4ae0-8ff9-936b50e9f7f9') created_at=datetime.datetime(2025, 2, 3, 8, 10, 0, 14326) updated_at=datetime.datetime(2025, 2, 3, 8, 10, 0, 14326) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:10:01.839 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:10:04.553 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:10:13.675 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:10:14.194 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:10:15.157 [INFO] [python_ana_process_manager] Current Spark memory usage: 723.01MB
2025-02-03 08:10:15.157 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:10:15.298 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:10:16.647 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:10:16.819 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:10:16.824 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_846769b7 任務失敗: 'StrategyParms' object has no attribute 'data_models'
2025-02-03 08:11:16.646 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-03 08:11:21.679 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_42d3e29e 開始消費隊列 full_backtest
2025-02-03 08:11:21.679 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_42d3e29e 線程已啟動
2025-02-03 08:11:21.680 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_ecb32ca2 開始消費隊列 pre_process_stock_data
2025-02-03 08:11:21.680 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_ecb32ca2 線程已啟動
2025-02-03 08:11:21.681 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_2e12880c 開始消費隊列 back_testing
2025-02-03 08:11:21.681 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_2e12880c 線程已啟動
2025-02-03 08:11:26.652 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_42d3e29e 收到消息，開始解析
2025-02-03 08:11:26.655 [INFO] [python_ana_process_manager] id=UUID('0cba3576-844e-4819-b179-fa5cb186fbd9') created_at=datetime.datetime(2025, 2, 3, 8, 11, 0, 2322) updated_at=datetime.datetime(2025, 2, 3, 8, 11, 6, 694579) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Full Backtest 任務執行階段失敗: Channel is closing.' sink_params=None set_params=None
2025-02-03 08:11:26.656 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_42d3e29e 解析後消息為: id=UUID('0cba3576-844e-4819-b179-fa5cb186fbd9') created_at=datetime.datetime(2025, 2, 3, 8, 11, 0, 2322) updated_at=datetime.datetime(2025, 2, 3, 8, 11, 6, 694579) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Full Backtest 任務執行階段失敗: Channel is closing.' sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:11:28.645 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:11:31.467 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:11:40.441 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:11:40.556 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:11:41.703 [INFO] [python_ana_process_manager] Current Spark memory usage: 738.71MB
2025-02-03 08:11:41.703 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:12:01.831 [ERROR] [python_ana_process_manager] Failed to create SparkSession: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext
2025-02-03 08:12:01.832 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_42d3e29e 任務失敗: 讀取數據時發生錯誤: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext code='2317' candle='d1' start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)) end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))
2025-02-03 08:12:17.495 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-03 08:12:22.468 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_450f4d15 開始消費隊列 full_backtest
2025-02-03 08:12:22.468 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_450f4d15 線程已啟動
2025-02-03 08:12:22.469 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bf938429 開始消費隊列 pre_process_stock_data
2025-02-03 08:12:22.469 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bf938429 線程已啟動
2025-02-03 08:12:22.470 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_992bde19 開始消費隊列 back_testing
2025-02-03 08:12:22.470 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_992bde19 線程已啟動
2025-02-03 08:12:22.471 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_450f4d15 收到消息，開始解析
2025-02-03 08:12:22.474 [INFO] [python_ana_process_manager] id=UUID('1c692251-2c1a-4d8a-bbaf-1754fbbeace4') created_at=datetime.datetime(2025, 2, 3, 8, 12, 0, 2848) updated_at=datetime.datetime(2025, 2, 3, 8, 12, 5, 124037) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Full Backtest 任務執行階段失敗: Channel is closing.' sink_params=None set_params=None
2025-02-03 08:12:22.475 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_450f4d15 解析後消息為: id=UUID('1c692251-2c1a-4d8a-bbaf-1754fbbeace4') created_at=datetime.datetime(2025, 2, 3, 8, 12, 0, 2848) updated_at=datetime.datetime(2025, 2, 3, 8, 12, 5, 124037) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Full Backtest 任務執行階段失敗: Channel is closing.' sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:12:24.035 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:12:26.760 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:12:35.503 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:12:35.870 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:12:37.088 [INFO] [python_ana_process_manager] Current Spark memory usage: 736.54MB
2025-02-03 08:12:37.088 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:12:37.239 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:12:38.607 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:12:38.757 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:12:38.797 [INFO] [python_ana_process_manager] 提交任務 2f930257-bb4e-436c-be13-ce0c0eac93b8: _muti_process_run_test
2025-02-03 08:12:39.691 [INFO] [python_ana_process_manager] 任務 2f930257-bb4e-436c-be13-ce0c0eac93b8 完成
2025-02-03 08:12:39.692 [INFO] [python_ana_process_manager] 任務 2f930257-bb4e-436c-be13-ce0c0eac93b8 完成，執行時間: 0.89秒
2025-02-03 08:13:00.038 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_450f4d15 收到消息，開始解析
2025-02-03 08:13:00.040 [INFO] [python_ana_process_manager] id=UUID('eef8efc2-c169-43d9-9e48-ec484030429c') created_at=datetime.datetime(2025, 2, 3, 8, 13, 0, 2383) updated_at=datetime.datetime(2025, 2, 3, 8, 13, 0, 2383) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:13:00.041 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_450f4d15 解析後消息為: id=UUID('eef8efc2-c169-43d9-9e48-ec484030429c') created_at=datetime.datetime(2025, 2, 3, 8, 13, 0, 2383) updated_at=datetime.datetime(2025, 2, 3, 8, 13, 0, 2383) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:13:01.162 [INFO] [python_ana_process_manager] Current Spark memory usage: 702.81MB
2025-02-03 08:13:01.162 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:13:01.294 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:13:04.111 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:13:04.341 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:13:05.487 [INFO] [python_ana_process_manager] Current Spark memory usage: 718.93MB
2025-02-03 08:13:05.487 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:13:05.620 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:13:06.296 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:13:06.630 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:13:06.651 [INFO] [python_ana_process_manager] 提交任務 0580da4c-f85c-4609-879a-fa1211afd4c9: _muti_process_run_test
2025-02-03 08:13:07.533 [INFO] [python_ana_process_manager] 任務 0580da4c-f85c-4609-879a-fa1211afd4c9 完成
2025-02-03 08:13:07.533 [INFO] [python_ana_process_manager] 任務 0580da4c-f85c-4609-879a-fa1211afd4c9 完成，執行時間: 0.88秒
2025-02-03 08:13:19.100 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_450f4d15
2025-02-03 08:13:19.100 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_450f4d15 正在停止
2025-02-03 08:13:19.101 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_450f4d15 已完全停止
2025-02-03 08:13:19.101 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bf938429
2025-02-03 08:13:19.102 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bf938429 正在停止
2025-02-03 08:13:19.102 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_bf938429 已完全停止
2025-02-03 08:13:19.102 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_992bde19
2025-02-03 08:13:19.103 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_992bde19 正在停止
2025-02-03 08:13:19.103 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_992bde19 已完全停止
2025-02-03 08:13:49.608 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-03 08:13:54.607 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_264419dc 線程已啟動
2025-02-03 08:13:54.608 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_264419dc 開始消費隊列 full_backtest
2025-02-03 08:13:54.610 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4f159800 線程已啟動
2025-02-03 08:13:54.610 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4f159800 開始消費隊列 pre_process_stock_data
2025-02-03 08:13:54.611 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_6e06169d 線程已啟動
2025-02-03 08:13:54.611 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_6e06169d 開始消費隊列 back_testing
2025-02-03 08:16:04.045 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-03 08:16:09.045 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_0eba186b 線程已啟動
2025-02-03 08:16:09.045 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_0eba186b 開始消費隊列 full_backtest
2025-02-03 08:16:09.046 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_04a27754 線程已啟動
2025-02-03 08:16:09.047 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_04a27754 開始消費隊列 pre_process_stock_data
2025-02-03 08:16:09.048 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_f45f7f79 線程已啟動
2025-02-03 08:16:09.048 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_f45f7f79 開始消費隊列 back_testing
2025-02-03 08:17:36.116 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-03 08:17:41.130 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_a14c8763 線程已啟動
2025-02-03 08:17:41.131 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_a14c8763 開始消費隊列 full_backtest
2025-02-03 08:17:41.132 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_fca0712f 線程已啟動
2025-02-03 08:17:41.132 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_fca0712f 開始消費隊列 pre_process_stock_data
2025-02-03 08:17:41.133 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a626afc9 線程已啟動
2025-02-03 08:17:41.134 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a626afc9 開始消費隊列 back_testing
2025-02-03 08:17:46.124 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_a14c8763 收到消息，開始解析
2025-02-03 08:17:46.128 [INFO] [python_ana_process_manager] id=UUID('4f4b73fb-2bfa-4484-ba6f-6858dba3fc38') created_at=datetime.datetime(2025, 2, 3, 8, 14, 0, 1750) updated_at=datetime.datetime(2025, 2, 3, 8, 16, 27, 554496) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:17:46.130 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_a14c8763 解析後消息為: id=UUID('4f4b73fb-2bfa-4484-ba6f-6858dba3fc38') created_at=datetime.datetime(2025, 2, 3, 8, 14, 0, 1750) updated_at=datetime.datetime(2025, 2, 3, 8, 16, 27, 554496) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:17:47.846 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:17:50.613 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:17:59.672 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:18:00.234 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:18:01.327 [INFO] [python_ana_process_manager] Current Spark memory usage: 776.36MB
2025-02-03 08:18:01.328 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:18:01.493 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:18:03.222 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:18:03.515 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:19:11.803 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-03 08:19:16.794 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_68cdf37f 線程已啟動
2025-02-03 08:19:16.795 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_68cdf37f 開始消費隊列 full_backtest
2025-02-03 08:19:16.796 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4c3b0b8a 線程已啟動
2025-02-03 08:19:16.796 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4c3b0b8a 開始消費隊列 pre_process_stock_data
2025-02-03 08:19:16.797 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_b1515d4e 線程已啟動
2025-02-03 08:19:16.798 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_b1515d4e 開始消費隊列 back_testing
2025-02-03 08:19:21.786 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 收到消息，開始解析
2025-02-03 08:19:21.789 [INFO] [python_ana_process_manager] id=UUID('07eed67e-07f7-4825-9d35-c2726d4a8be6') created_at=datetime.datetime(2025, 2, 3, 8, 15, 0, 1250) updated_at=datetime.datetime(2025, 2, 3, 8, 18, 50, 202817) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Full Backtest 任務執行階段失敗: Channel is closing.' sink_params=None set_params=None
2025-02-03 08:19:21.791 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 解析後消息為: id=UUID('07eed67e-07f7-4825-9d35-c2726d4a8be6') created_at=datetime.datetime(2025, 2, 3, 8, 15, 0, 1250) updated_at=datetime.datetime(2025, 2, 3, 8, 18, 50, 202817) status=<TaskEventStatus.TaskStatusFailed: 'failed'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='backtesting' schedule_id=None schedule_name=None start_time=None end_time=None error_message='Full Backtest 任務執行階段失敗: Channel is closing.' sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:19:23.407 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:19:26.145 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:19:35.313 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:19:35.733 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:19:36.935 [INFO] [python_ana_process_manager] Current Spark memory usage: 789.09MB
2025-02-03 08:19:36.936 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:19:37.104 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:19:38.771 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:19:39.172 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:19:42.884 [INFO] [python_ana_process_manager] 提交任務 08c04ba5-bc99-495b-9cb5-89ccd6ea2efe: _muti_process_run_test
2025-02-03 08:19:42.897 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 收到消息，開始解析
2025-02-03 08:19:42.899 [INFO] [python_ana_process_manager] id=UUID('be247c4a-646e-4714-a7c7-991408a32531') created_at=datetime.datetime(2025, 2, 3, 8, 16, 0, 1811) updated_at=datetime.datetime(2025, 2, 3, 8, 16, 0, 1811) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:19:42.901 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 解析後消息為: id=UUID('be247c4a-646e-4714-a7c7-991408a32531') created_at=datetime.datetime(2025, 2, 3, 8, 16, 0, 1811) updated_at=datetime.datetime(2025, 2, 3, 8, 16, 0, 1811) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:19:44.501 [INFO] [python_ana_process_manager] Current Spark memory usage: 730.46MB
2025-02-03 08:19:44.502 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:19:44.668 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:19:47.544 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:19:47.706 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:19:49.240 [INFO] [python_ana_process_manager] Current Spark memory usage: 819.18MB
2025-02-03 08:19:49.240 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:19:49.391 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:19:50.237 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:19:50.398 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:19:50.432 [INFO] [python_ana_process_manager] 提交任務 d4b25f75-e00a-4020-855d-440cdf447951: _muti_process_run_test
2025-02-03 08:19:50.438 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 收到消息，開始解析
2025-02-03 08:19:50.441 [INFO] [python_ana_process_manager] id=UUID('2e787b6e-6fa1-47d4-b08c-8b4af27df669') created_at=datetime.datetime(2025, 2, 3, 8, 17, 0, 2387) updated_at=datetime.datetime(2025, 2, 3, 8, 17, 0, 2387) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:19:50.442 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 解析後消息為: id=UUID('2e787b6e-6fa1-47d4-b08c-8b4af27df669') created_at=datetime.datetime(2025, 2, 3, 8, 17, 0, 2387) updated_at=datetime.datetime(2025, 2, 3, 8, 17, 0, 2387) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:19:51.894 [INFO] [python_ana_process_manager] Current Spark memory usage: 785.86MB
2025-02-03 08:19:51.895 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:19:52.049 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:19:54.747 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:19:55.095 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:19:56.330 [INFO] [python_ana_process_manager] Current Spark memory usage: 834.30MB
2025-02-03 08:19:56.331 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:19:56.478 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:19:57.247 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:19:57.480 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:19:57.513 [INFO] [python_ana_process_manager] 提交任務 9ca90b37-3ce9-4775-a424-9b4be3ce8057: _muti_process_run_test
2025-02-03 08:19:57.518 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 收到消息，開始解析
2025-02-03 08:19:57.520 [INFO] [python_ana_process_manager] id=UUID('401a039e-c1f1-403b-b301-747f5f469e84') created_at=datetime.datetime(2025, 2, 3, 8, 18, 0, 1880) updated_at=datetime.datetime(2025, 2, 3, 8, 18, 0, 1880) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:19:57.522 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 解析後消息為: id=UUID('401a039e-c1f1-403b-b301-747f5f469e84') created_at=datetime.datetime(2025, 2, 3, 8, 18, 0, 1880) updated_at=datetime.datetime(2025, 2, 3, 8, 18, 0, 1880) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:19:58.988 [INFO] [python_ana_process_manager] Current Spark memory usage: 858.80MB
2025-02-03 08:19:58.989 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:19:59.138 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:20:01.624 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:20:02.171 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:20:03.454 [INFO] [python_ana_process_manager] Current Spark memory usage: 904.05MB
2025-02-03 08:20:03.455 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:20:03.592 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:20:04.305 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:20:04.614 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:20:04.645 [INFO] [python_ana_process_manager] 提交任務 e7775e50-d4e8-489f-9aa5-84eb169f6078: _muti_process_run_test
2025-02-03 08:20:04.653 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 收到消息，開始解析
2025-02-03 08:20:04.655 [INFO] [python_ana_process_manager] id=UUID('aed63ea3-6a18-4fbd-a53c-c7091e22f5b6') created_at=datetime.datetime(2025, 2, 3, 8, 19, 0, 2097) updated_at=datetime.datetime(2025, 2, 3, 8, 19, 0, 2097) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:20:04.657 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 解析後消息為: id=UUID('aed63ea3-6a18-4fbd-a53c-c7091e22f5b6') created_at=datetime.datetime(2025, 2, 3, 8, 19, 0, 2097) updated_at=datetime.datetime(2025, 2, 3, 8, 19, 0, 2097) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:20:05.824 [INFO] [python_ana_process_manager] Current Spark memory usage: 831.50MB
2025-02-03 08:20:05.825 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:20:05.960 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:20:08.158 [INFO] [python_ana_process_manager] 任務 08c04ba5-bc99-495b-9cb5-89ccd6ea2efe 完成
2025-02-03 08:20:08.159 [INFO] [python_ana_process_manager] 任務 08c04ba5-bc99-495b-9cb5-89ccd6ea2efe 完成，執行時間: 25.27秒
2025-02-03 08:20:08.166 [INFO] [python_ana_process_manager] 任務 e7775e50-d4e8-489f-9aa5-84eb169f6078 完成
2025-02-03 08:20:08.167 [INFO] [python_ana_process_manager] 任務 e7775e50-d4e8-489f-9aa5-84eb169f6078 完成，執行時間: 3.52秒
2025-02-03 08:20:08.430 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:20:09.003 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:20:10.304 [INFO] [python_ana_process_manager] Current Spark memory usage: 866.07MB
2025-02-03 08:20:10.305 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:20:10.440 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:20:11.245 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:20:11.445 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:20:11.479 [INFO] [python_ana_process_manager] 提交任務 bcf1a0ad-210a-4be9-9c12-e377b5fe2856: _muti_process_run_test
2025-02-03 08:20:11.483 [INFO] [python_ana_process_manager] 任務 bcf1a0ad-210a-4be9-9c12-e377b5fe2856 完成
2025-02-03 08:20:11.484 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 收到消息，開始解析
2025-02-03 08:20:11.485 [INFO] [python_ana_process_manager] 任務 bcf1a0ad-210a-4be9-9c12-e377b5fe2856 完成，執行時間: 0.00秒
2025-02-03 08:20:11.486 [INFO] [python_ana_process_manager] id=UUID('1a835c98-58ad-47a5-b60e-7c7e37f14a70') created_at=datetime.datetime(2025, 2, 3, 8, 20, 0, 2158) updated_at=datetime.datetime(2025, 2, 3, 8, 20, 0, 2158) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:20:11.488 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 解析後消息為: id=UUID('1a835c98-58ad-47a5-b60e-7c7e37f14a70') created_at=datetime.datetime(2025, 2, 3, 8, 20, 0, 2158) updated_at=datetime.datetime(2025, 2, 3, 8, 20, 0, 2158) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:20:12.699 [INFO] [python_ana_process_manager] Current Spark memory usage: 952.02MB
2025-02-03 08:20:12.699 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:20:12.835 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:20:14.008 [INFO] [python_ana_process_manager] 任務 d4b25f75-e00a-4020-855d-440cdf447951 完成
2025-02-03 08:20:14.009 [INFO] [python_ana_process_manager] 任務 d4b25f75-e00a-4020-855d-440cdf447951 完成，執行時間: 23.58秒
2025-02-03 08:20:15.208 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:20:15.378 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:20:15.678 [INFO] [python_ana_process_manager] 任務 9ca90b37-3ce9-4775-a424-9b4be3ce8057 完成
2025-02-03 08:20:15.705 [INFO] [python_ana_process_manager] 任務 9ca90b37-3ce9-4775-a424-9b4be3ce8057 完成，執行時間: 18.17秒
2025-02-03 08:20:16.725 [INFO] [python_ana_process_manager] Current Spark memory usage: 921.20MB
2025-02-03 08:20:16.726 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:20:16.864 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:20:17.636 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:20:17.894 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:20:17.925 [INFO] [python_ana_process_manager] 提交任務 bc5ea4e1-4c8a-4faa-8be0-174bb4f180ee: _muti_process_run_test
2025-02-03 08:20:17.930 [INFO] [python_ana_process_manager] 任務 bc5ea4e1-4c8a-4faa-8be0-174bb4f180ee 完成
2025-02-03 08:20:17.931 [INFO] [python_ana_process_manager] 任務 bc5ea4e1-4c8a-4faa-8be0-174bb4f180ee 完成，執行時間: 0.01秒
2025-02-03 08:21:00.031 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 收到消息，開始解析
2025-02-03 08:21:00.033 [INFO] [python_ana_process_manager] id=UUID('032399cb-74fc-4ce1-adf5-dd2a41f3962a') created_at=datetime.datetime(2025, 2, 3, 8, 21, 0, 2723) updated_at=datetime.datetime(2025, 2, 3, 8, 21, 0, 2723) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:21:00.035 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_68cdf37f 解析後消息為: id=UUID('032399cb-74fc-4ce1-adf5-dd2a41f3962a') created_at=datetime.datetime(2025, 2, 3, 8, 21, 0, 2723) updated_at=datetime.datetime(2025, 2, 3, 8, 21, 0, 2723) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:21:01.179 [INFO] [python_ana_process_manager] Current Spark memory usage: 886.22MB
2025-02-03 08:21:01.180 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:21:01.315 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:21:03.613 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:21:03.833 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:21:04.974 [INFO] [python_ana_process_manager] Current Spark memory usage: 961.99MB
2025-02-03 08:21:04.974 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:21:05.111 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:21:05.853 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:21:06.127 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:21:06.160 [INFO] [python_ana_process_manager] 提交任務 6fdc5c51-d7ec-47af-979c-8dabd44ffc50: _muti_process_run_test
2025-02-03 08:21:06.165 [INFO] [python_ana_process_manager] 任務 6fdc5c51-d7ec-47af-979c-8dabd44ffc50 完成
2025-02-03 08:21:06.166 [INFO] [python_ana_process_manager] 任務 6fdc5c51-d7ec-47af-979c-8dabd44ffc50 完成，執行時間: 0.00秒
2025-02-03 08:21:14.917 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_68cdf37f
2025-02-03 08:21:14.918 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_68cdf37f 正在停止
2025-02-03 08:21:14.919 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_68cdf37f 已完全停止
2025-02-03 08:21:14.919 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4c3b0b8a
2025-02-03 08:21:14.920 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4c3b0b8a 正在停止
2025-02-03 08:21:14.920 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4c3b0b8a 已完全停止
2025-02-03 08:21:14.920 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_b1515d4e
2025-02-03 08:21:14.921 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_b1515d4e 正在停止
2025-02-03 08:21:14.921 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_b1515d4e 已完全停止
2025-02-03 08:22:11.130 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-03 08:22:16.119 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_2d437d16 線程已啟動
2025-02-03 08:22:16.119 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_2d437d16 開始消費隊列 full_backtest
2025-02-03 08:22:16.121 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_e1ad1ac1 線程已啟動
2025-02-03 08:22:16.121 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_e1ad1ac1 開始消費隊列 pre_process_stock_data
2025-02-03 08:22:16.122 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_df621cff 線程已啟動
2025-02-03 08:22:16.122 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_df621cff 開始消費隊列 back_testing
2025-02-03 08:22:21.115 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_2d437d16 收到消息，開始解析
2025-02-03 08:22:21.118 [INFO] [python_ana_process_manager] id=UUID('088bc996-7052-4a8b-a861-fa507d0db68e') created_at=datetime.datetime(2025, 2, 3, 8, 22, 0, 2783) updated_at=datetime.datetime(2025, 2, 3, 8, 22, 0, 2783) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:22:21.120 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_2d437d16 解析後消息為: id=UUID('088bc996-7052-4a8b-a861-fa507d0db68e') created_at=datetime.datetime(2025, 2, 3, 8, 22, 0, 2783) updated_at=datetime.datetime(2025, 2, 3, 8, 22, 0, 2783) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:22:23.336 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:22:26.110 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:22:35.808 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:22:36.202 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:22:38.257 [INFO] [python_ana_process_manager] Current Spark memory usage: 697.50MB
2025-02-03 08:22:38.258 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:22:38.426 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:22:40.316 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:22:40.464 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:22:40.508 [INFO] [python_ana_process_manager] 提交任務 4fdc721a-6d3a-4874-99ec-07502f57e948: _muti_process_run_test
2025-02-03 08:22:59.575 [INFO] [python_ana_process_manager] 任務 4fdc721a-6d3a-4874-99ec-07502f57e948 完成
2025-02-03 08:22:59.576 [INFO] [python_ana_process_manager] 任務 4fdc721a-6d3a-4874-99ec-07502f57e948 完成，執行時間: 19.07秒
2025-02-03 08:23:00.032 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_2d437d16 收到消息，開始解析
2025-02-03 08:23:00.035 [INFO] [python_ana_process_manager] id=UUID('9599ede1-044f-4b29-8b46-d9aa29d6296f') created_at=datetime.datetime(2025, 2, 3, 8, 23, 0, 2406) updated_at=datetime.datetime(2025, 2, 3, 8, 23, 0, 2406) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:23:00.037 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_2d437d16 解析後消息為: id=UUID('9599ede1-044f-4b29-8b46-d9aa29d6296f') created_at=datetime.datetime(2025, 2, 3, 8, 23, 0, 2406) updated_at=datetime.datetime(2025, 2, 3, 8, 23, 0, 2406) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:23:01.455 [INFO] [python_ana_process_manager] Current Spark memory usage: 670.00MB
2025-02-03 08:23:01.455 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:23:01.608 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:23:04.536 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:23:04.671 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:23:06.046 [INFO] [python_ana_process_manager] Current Spark memory usage: 734.24MB
2025-02-03 08:23:06.047 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:23:06.193 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:23:07.008 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:23:07.208 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:23:07.244 [INFO] [python_ana_process_manager] 提交任務 718b3d07-f43a-4743-abc0-6dd7e9769fb4: _muti_process_run_test
2025-02-03 08:23:09.771 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_2d437d16
2025-02-03 08:23:09.772 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_2d437d16 正在停止
2025-02-03 08:23:09.773 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_2d437d16 已完全停止
2025-02-03 08:23:09.773 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_e1ad1ac1
2025-02-03 08:23:09.774 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_e1ad1ac1 正在停止
2025-02-03 08:23:09.774 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_e1ad1ac1 已完全停止
2025-02-03 08:23:09.774 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_df621cff
2025-02-03 08:23:09.775 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_df621cff 正在停止
2025-02-03 08:23:09.775 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_df621cff 已完全停止
2025-02-03 08:25:12.101 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-03 08:25:17.093 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_7cf4d89c 開始消費隊列 full_backtest
2025-02-03 08:25:17.093 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_7cf4d89c 線程已啟動
2025-02-03 08:25:17.094 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_720c6766 開始消費隊列 pre_process_stock_data
2025-02-03 08:25:17.094 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_720c6766 線程已啟動
2025-02-03 08:25:17.095 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_d42b543d 開始消費隊列 back_testing
2025-02-03 08:25:17.095 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_d42b543d 線程已啟動
2025-02-03 08:25:17.095 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_7cf4d89c 收到消息，開始解析
2025-02-03 08:25:17.098 [INFO] [python_ana_process_manager] id=UUID('f30dbf44-431d-4706-b1aa-f6b7fc7361d7') created_at=datetime.datetime(2025, 2, 3, 8, 24, 0, 1697) updated_at=datetime.datetime(2025, 2, 3, 8, 24, 0, 1697) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:25:17.099 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_7cf4d89c 解析後消息為: id=UUID('f30dbf44-431d-4706-b1aa-f6b7fc7361d7') created_at=datetime.datetime(2025, 2, 3, 8, 24, 0, 1697) updated_at=datetime.datetime(2025, 2, 3, 8, 24, 0, 1697) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:25:18.627 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:25:21.355 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:25:30.551 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:25:30.963 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:25:31.908 [INFO] [python_ana_process_manager] Current Spark memory usage: 730.43MB
2025-02-03 08:25:31.908 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:25:32.048 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:25:33.370 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:25:33.561 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:25:33.581 [INFO] [python_ana_process_manager] 提交任務 150f264d-9933-4dea-99a1-9573b9514d34: _muti_process_run_test
2025-02-03 08:25:33.587 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_7cf4d89c 收到消息，開始解析
2025-02-03 08:25:33.588 [INFO] [python_ana_process_manager] id=UUID('6ab40a14-6df0-4dbf-a50b-d3df26ce6f6b') created_at=datetime.datetime(2025, 2, 3, 8, 25, 0, 1884) updated_at=datetime.datetime(2025, 2, 3, 8, 25, 0, 1884) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:25:33.590 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_7cf4d89c 解析後消息為: id=UUID('6ab40a14-6df0-4dbf-a50b-d3df26ce6f6b') created_at=datetime.datetime(2025, 2, 3, 8, 25, 0, 1884) updated_at=datetime.datetime(2025, 2, 3, 8, 25, 0, 1884) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:25:34.560 [INFO] [python_ana_process_manager] 任務 150f264d-9933-4dea-99a1-9573b9514d34 完成
2025-02-03 08:25:34.590 [INFO] [python_ana_process_manager] 任務 150f264d-9933-4dea-99a1-9573b9514d34 完成，執行時間: 0.98秒
2025-02-03 08:25:34.734 [INFO] [python_ana_process_manager] Current Spark memory usage: 662.79MB
2025-02-03 08:25:34.734 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:25:34.867 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:25:37.763 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:25:37.903 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:25:38.827 [INFO] [python_ana_process_manager] Current Spark memory usage: 801.88MB
2025-02-03 08:25:38.828 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:25:38.959 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:25:39.609 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:25:39.971 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:25:39.994 [INFO] [python_ana_process_manager] 提交任務 11192a28-0be8-40bd-8a07-8baee92987f9: _muti_process_run_test
2025-02-03 08:25:40.867 [INFO] [python_ana_process_manager] 任務 11192a28-0be8-40bd-8a07-8baee92987f9 完成
2025-02-03 08:25:40.867 [INFO] [python_ana_process_manager] 任務 11192a28-0be8-40bd-8a07-8baee92987f9 完成，執行時間: 0.87秒
2025-02-03 08:26:00.035 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_7cf4d89c 收到消息，開始解析
2025-02-03 08:26:00.037 [INFO] [python_ana_process_manager] id=UUID('a79a3429-8ba6-449d-971c-54b8214e4ea3') created_at=datetime.datetime(2025, 2, 3, 8, 26, 0, 3028) updated_at=datetime.datetime(2025, 2, 3, 8, 26, 0, 3028) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:26:00.038 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_7cf4d89c 解析後消息為: id=UUID('a79a3429-8ba6-449d-971c-54b8214e4ea3') created_at=datetime.datetime(2025, 2, 3, 8, 26, 0, 3028) updated_at=datetime.datetime(2025, 2, 3, 8, 26, 0, 3028) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:26:01.228 [INFO] [python_ana_process_manager] Current Spark memory usage: 760.46MB
2025-02-03 08:26:01.229 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:26:01.389 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:26:04.122 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:26:04.447 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:26:05.653 [INFO] [python_ana_process_manager] Current Spark memory usage: 776.25MB
2025-02-03 08:26:05.653 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:26:05.782 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:26:06.459 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:26:06.797 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:26:06.819 [INFO] [python_ana_process_manager] 提交任務 5e563d94-df4d-419a-b4b5-28f1d316397c: _muti_process_run_test
2025-02-03 08:26:07.724 [INFO] [python_ana_process_manager] 任務 5e563d94-df4d-419a-b4b5-28f1d316397c 完成
2025-02-03 08:26:07.724 [INFO] [python_ana_process_manager] 任務 5e563d94-df4d-419a-b4b5-28f1d316397c 完成，執行時間: 0.91秒
2025-02-03 08:26:41.938 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_7cf4d89c
2025-02-03 08:26:41.939 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_7cf4d89c 正在停止
2025-02-03 08:26:41.939 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_7cf4d89c 已完全停止
2025-02-03 08:26:41.940 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_720c6766
2025-02-03 08:26:41.940 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_720c6766 正在停止
2025-02-03 08:26:41.940 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_720c6766 已完全停止
2025-02-03 08:26:41.941 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_d42b543d
2025-02-03 08:26:41.941 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_d42b543d 正在停止
2025-02-03 08:26:41.941 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_d42b543d 已完全停止
2025-02-03 08:33:16.132 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-03 08:33:21.145 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 開始消費隊列 full_backtest
2025-02-03 08:33:21.146 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 線程已啟動
2025-02-03 08:33:21.147 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4175c611 開始消費隊列 pre_process_stock_data
2025-02-03 08:33:21.147 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_4175c611 線程已啟動
2025-02-03 08:33:21.148 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_de5fef40 開始消費隊列 back_testing
2025-02-03 08:33:21.148 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_de5fef40 線程已啟動
2025-02-03 08:33:21.164 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 收到消息，開始解析
2025-02-03 08:33:21.167 [INFO] [python_ana_process_manager] id=UUID('e632971e-1d92-4049-94ce-45c8ed0de3c2') created_at=datetime.datetime(2025, 2, 3, 8, 27, 0, 2761) updated_at=datetime.datetime(2025, 2, 3, 8, 27, 0, 2761) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:33:21.168 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 解析後消息為: id=UUID('e632971e-1d92-4049-94ce-45c8ed0de3c2') created_at=datetime.datetime(2025, 2, 3, 8, 27, 0, 2761) updated_at=datetime.datetime(2025, 2, 3, 8, 27, 0, 2761) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:33:22.681 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:33:25.434 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:33:34.605 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:33:35.018 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:33:36.091 [INFO] [python_ana_process_manager] Current Spark memory usage: 743.21MB
2025-02-03 08:33:36.092 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:33:36.261 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:33:37.810 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:33:38.300 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:33:38.324 [INFO] [python_ana_process_manager] 提交任務 1ac110c4-6413-426f-a527-ff1ef33c0d26: _muti_process_run_test
2025-02-03 08:33:38.329 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 收到消息，開始解析
2025-02-03 08:33:38.331 [INFO] [python_ana_process_manager] id=UUID('be9f6830-9516-4f4d-b97d-807222bc6365') created_at=datetime.datetime(2025, 2, 3, 8, 28, 0, 1995) updated_at=datetime.datetime(2025, 2, 3, 8, 28, 0, 1995) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:33:38.332 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 解析後消息為: id=UUID('be9f6830-9516-4f4d-b97d-807222bc6365') created_at=datetime.datetime(2025, 2, 3, 8, 28, 0, 1995) updated_at=datetime.datetime(2025, 2, 3, 8, 28, 0, 1995) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:33:39.376 [INFO] [python_ana_process_manager] 任務 1ac110c4-6413-426f-a527-ff1ef33c0d26 完成
2025-02-03 08:33:39.408 [INFO] [python_ana_process_manager] 任務 1ac110c4-6413-426f-a527-ff1ef33c0d26 完成，執行時間: 1.05秒
2025-02-03 08:33:39.581 [INFO] [python_ana_process_manager] Current Spark memory usage: 714.91MB
2025-02-03 08:33:39.582 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:33:39.730 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:33:42.567 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:33:42.771 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:33:43.816 [INFO] [python_ana_process_manager] Current Spark memory usage: 735.01MB
2025-02-03 08:33:43.816 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:33:43.950 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:33:44.603 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:33:44.961 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:33:44.983 [INFO] [python_ana_process_manager] 提交任務 59163dbb-e1b2-46df-8c51-86b15b87d44d: _muti_process_run_test
2025-02-03 08:33:44.987 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 收到消息，開始解析
2025-02-03 08:33:44.989 [INFO] [python_ana_process_manager] id=UUID('7e8c7478-1cd3-440f-9ac2-3e6b88f0db7d') created_at=datetime.datetime(2025, 2, 3, 8, 29, 0, 1794) updated_at=datetime.datetime(2025, 2, 3, 8, 29, 0, 1794) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:33:44.991 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 解析後消息為: id=UUID('7e8c7478-1cd3-440f-9ac2-3e6b88f0db7d') created_at=datetime.datetime(2025, 2, 3, 8, 29, 0, 1794) updated_at=datetime.datetime(2025, 2, 3, 8, 29, 0, 1794) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:33:46.038 [INFO] [python_ana_process_manager] 任務 59163dbb-e1b2-46df-8c51-86b15b87d44d 完成
2025-02-03 08:33:46.067 [INFO] [python_ana_process_manager] 任務 59163dbb-e1b2-46df-8c51-86b15b87d44d 完成，執行時間: 1.06秒
2025-02-03 08:33:46.198 [INFO] [python_ana_process_manager] Current Spark memory usage: 779.79MB
2025-02-03 08:33:46.199 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:33:46.342 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:33:48.887 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:33:49.417 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:33:50.747 [INFO] [python_ana_process_manager] Current Spark memory usage: 801.41MB
2025-02-03 08:33:50.748 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:33:50.896 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:33:51.613 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:33:51.906 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:33:51.929 [INFO] [python_ana_process_manager] 提交任務 1e0a8806-be03-46d1-9724-9486e8319183: _muti_process_run_test
2025-02-03 08:33:51.934 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 收到消息，開始解析
2025-02-03 08:33:51.936 [INFO] [python_ana_process_manager] id=UUID('8843c8d7-3f65-4833-849f-33237564c2ef') created_at=datetime.datetime(2025, 2, 3, 8, 30, 0, 1954) updated_at=datetime.datetime(2025, 2, 3, 8, 30, 0, 1954) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:33:51.938 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 解析後消息為: id=UUID('8843c8d7-3f65-4833-849f-33237564c2ef') created_at=datetime.datetime(2025, 2, 3, 8, 30, 0, 1954) updated_at=datetime.datetime(2025, 2, 3, 8, 30, 0, 1954) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:33:53.030 [INFO] [python_ana_process_manager] 任務 1e0a8806-be03-46d1-9724-9486e8319183 完成
2025-02-03 08:33:53.092 [INFO] [python_ana_process_manager] 任務 1e0a8806-be03-46d1-9724-9486e8319183 完成，執行時間: 1.10秒
2025-02-03 08:33:53.586 [INFO] [python_ana_process_manager] Current Spark memory usage: 802.07MB
2025-02-03 08:33:53.588 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:33:53.730 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:33:56.012 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:33:56.278 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:33:57.812 [INFO] [python_ana_process_manager] Current Spark memory usage: 1042.80MB
2025-02-03 08:33:57.813 [INFO] [python_ana_process_manager] Starting restart spark
2025-02-03 08:33:57.813 [INFO] [python_ana_process_manager] 清理Python資源
2025-02-03 08:34:00.373 [INFO] [python_ana_process_manager] Restart completed
2025-02-03 08:34:00.373 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:34:03.179 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:34:08.213 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:34:08.710 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:34:08.732 [INFO] [python_ana_process_manager] 提交任務 2a02e056-7542-4595-a825-073989f60874: _muti_process_run_test
2025-02-03 08:34:08.735 [INFO] [python_ana_process_manager] 任務 2a02e056-7542-4595-a825-073989f60874 完成
2025-02-03 08:34:08.735 [INFO] [python_ana_process_manager] 任務 2a02e056-7542-4595-a825-073989f60874 完成，執行時間: 0.00秒
2025-02-03 08:34:08.741 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 收到消息，開始解析
2025-02-03 08:34:08.743 [INFO] [python_ana_process_manager] id=UUID('73ce7bec-1936-4e8b-bccd-432f2935fbaf') created_at=datetime.datetime(2025, 2, 3, 8, 31, 0, 2391) updated_at=datetime.datetime(2025, 2, 3, 8, 31, 0, 2391) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:34:08.744 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 解析後消息為: id=UUID('73ce7bec-1936-4e8b-bccd-432f2935fbaf') created_at=datetime.datetime(2025, 2, 3, 8, 31, 0, 2391) updated_at=datetime.datetime(2025, 2, 3, 8, 31, 0, 2391) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:34:09.727 [INFO] [python_ana_process_manager] Current Spark memory usage: 513.57MB
2025-02-03 08:34:09.728 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:34:09.894 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:34:15.562 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:34:16.006 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:34:16.952 [INFO] [python_ana_process_manager] Current Spark memory usage: 760.43MB
2025-02-03 08:34:16.952 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:34:17.080 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:34:17.787 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:34:18.091 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:34:18.113 [INFO] [python_ana_process_manager] 提交任務 fb1bddb4-dc7c-4e8c-9244-9f8e4299b31f: _muti_process_run_test
2025-02-03 08:34:18.116 [INFO] [python_ana_process_manager] 任務 fb1bddb4-dc7c-4e8c-9244-9f8e4299b31f 完成
2025-02-03 08:34:18.116 [INFO] [python_ana_process_manager] 任務 fb1bddb4-dc7c-4e8c-9244-9f8e4299b31f 完成，執行時間: 0.00秒
2025-02-03 08:34:18.120 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 收到消息，開始解析
2025-02-03 08:34:18.121 [INFO] [python_ana_process_manager] id=UUID('2522c3e6-54f3-406a-a09c-250484165e18') created_at=datetime.datetime(2025, 2, 3, 8, 32, 0, 1764) updated_at=datetime.datetime(2025, 2, 3, 8, 32, 0, 1764) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:34:18.123 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 解析後消息為: id=UUID('2522c3e6-54f3-406a-a09c-250484165e18') created_at=datetime.datetime(2025, 2, 3, 8, 32, 0, 1764) updated_at=datetime.datetime(2025, 2, 3, 8, 32, 0, 1764) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:34:19.013 [INFO] [python_ana_process_manager] Current Spark memory usage: 823.43MB
2025-02-03 08:34:19.013 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:34:19.139 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:34:21.941 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:34:22.179 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:34:23.071 [INFO] [python_ana_process_manager] Current Spark memory usage: 837.89MB
2025-02-03 08:34:23.072 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:34:23.196 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:34:23.816 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:34:24.219 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:34:24.240 [INFO] [python_ana_process_manager] 提交任務 bddc2c1a-6a2a-4b11-9d96-716404b388cf: _muti_process_run_test
2025-02-03 08:34:24.242 [INFO] [python_ana_process_manager] 任務 bddc2c1a-6a2a-4b11-9d96-716404b388cf 完成
2025-02-03 08:34:24.243 [INFO] [python_ana_process_manager] 任務 bddc2c1a-6a2a-4b11-9d96-716404b388cf 完成，執行時間: 0.00秒
2025-02-03 08:34:24.246 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 收到消息，開始解析
2025-02-03 08:34:24.248 [INFO] [python_ana_process_manager] id=UUID('cf7716b7-b6b5-438d-8209-59c93027129c') created_at=datetime.datetime(2025, 2, 3, 8, 33, 0, 2490) updated_at=datetime.datetime(2025, 2, 3, 8, 33, 0, 2490) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:34:24.250 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 解析後消息為: id=UUID('cf7716b7-b6b5-438d-8209-59c93027129c') created_at=datetime.datetime(2025, 2, 3, 8, 33, 0, 2490) updated_at=datetime.datetime(2025, 2, 3, 8, 33, 0, 2490) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:34:25.142 [INFO] [python_ana_process_manager] Current Spark memory usage: 859.34MB
2025-02-03 08:34:25.143 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:34:25.267 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:34:27.809 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:34:28.310 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:34:29.192 [INFO] [python_ana_process_manager] Current Spark memory usage: 864.20MB
2025-02-03 08:34:29.192 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:34:29.315 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:34:29.910 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:34:30.343 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:34:30.365 [INFO] [python_ana_process_manager] 提交任務 b43b3160-de6b-461f-9c10-df2b53bd1384: _muti_process_run_test
2025-02-03 08:34:30.368 [INFO] [python_ana_process_manager] 任務 b43b3160-de6b-461f-9c10-df2b53bd1384 完成
2025-02-03 08:34:30.368 [INFO] [python_ana_process_manager] 任務 b43b3160-de6b-461f-9c10-df2b53bd1384 完成，執行時間: 0.00秒
2025-02-03 08:34:30.372 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 收到消息，開始解析
2025-02-03 08:34:30.375 [INFO] [python_ana_process_manager] id=UUID('7aeb7d97-6048-4512-9682-bbf662592a46') created_at=datetime.datetime(2025, 2, 3, 8, 34, 0, 2501) updated_at=datetime.datetime(2025, 2, 3, 8, 34, 0, 2501) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:34:30.376 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_8bd8d3bc 解析後消息為: id=UUID('7aeb7d97-6048-4512-9682-bbf662592a46') created_at=datetime.datetime(2025, 2, 3, 8, 34, 0, 2501) updated_at=datetime.datetime(2025, 2, 3, 8, 34, 0, 2501) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 9, 29, 948227, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:34:31.258 [INFO] [python_ana_process_manager] Current Spark memory usage: 878.61MB
2025-02-03 08:34:31.259 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:34:31.387 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:34:33.821 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:34:33.925 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:34:34.809 [INFO] [python_ana_process_manager] Current Spark memory usage: 889.25MB
2025-02-03 08:34:34.810 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:34:34.926 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:34:35.484 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:34:35.939 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:34:35.961 [INFO] [python_ana_process_manager] 提交任務 54d4dd5d-65d3-4a7e-8861-f0913a175643: _muti_process_run_test
2025-02-03 08:34:35.963 [INFO] [python_ana_process_manager] 任務 54d4dd5d-65d3-4a7e-8861-f0913a175643 完成
2025-02-03 08:34:35.964 [INFO] [python_ana_process_manager] 任務 54d4dd5d-65d3-4a7e-8861-f0913a175643 完成，執行時間: 0.00秒
2025-02-03 08:45:01.928 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 2
2025-02-03 08:45:26.809 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 2
2025-02-03 08:45:31.809 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_d67994f5 開始消費隊列 full_backtest
2025-02-03 08:45:31.809 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_d67994f5 線程已啟動
2025-02-03 08:45:31.810 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_00ff1a88 開始消費隊列 pre_process_stock_data
2025-02-03 08:45:31.811 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_00ff1a88 線程已啟動
2025-02-03 08:45:31.811 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a11dd3d5 開始消費隊列 back_testing
2025-02-03 08:45:31.811 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a11dd3d5 線程已啟動
2025-02-03 08:46:41.235 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_full_backtest_d67994f5
2025-02-03 08:46:41.235 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_d67994f5 正在停止
2025-02-03 08:46:41.236 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_d67994f5 已完全停止
2025-02-03 08:46:41.236 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_pre_process_stock_data_00ff1a88
2025-02-03 08:46:41.236 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_00ff1a88 正在停止
2025-02-03 08:46:41.237 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_00ff1a88 已完全停止
2025-02-03 08:46:41.237 [INFO] [python_ana_process_manager] 正在停止消費者 pkg.rabbitmq.consumer_back_testing_a11dd3d5
2025-02-03 08:46:41.237 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a11dd3d5 正在停止
2025-02-03 08:46:41.238 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a11dd3d5 已完全停止
2025-02-03 08:47:00.015 [INFO] task : bfcc6060-20f2-4a52-803f-61b6038a577e start download raw data stage
2025-02-03 08:47:00.017 [INFO] 執行 Sync Taiwan Stock Service, date : 20250201, code : 2317
2025-02-03 08:47:00.195 [INFO] taskid : bfcc6060-20f2-4a52-803f-61b6038a577e, task name : full_backtest publish msg to processer
2025-02-03 08:47:21.007 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 2
2025-02-03 08:47:26.009 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_3ea8bef8 線程已啟動
2025-02-03 08:47:26.010 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_3ea8bef8 開始消費隊列 full_backtest
2025-02-03 08:47:26.011 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_88314780 線程已啟動
2025-02-03 08:47:26.011 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_88314780 開始消費隊列 pre_process_stock_data
2025-02-03 08:47:26.013 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_9ebdbe92 線程已啟動
2025-02-03 08:47:26.013 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_9ebdbe92 開始消費隊列 back_testing
2025-02-03 08:47:30.981 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_3ea8bef8 收到消息，開始解析
2025-02-03 08:47:30.984 [INFO] [python_ana_process_manager] id=UUID('bfcc6060-20f2-4a52-803f-61b6038a577e') created_at=datetime.datetime(2025, 2, 3, 8, 47, 0, 11924) updated_at=datetime.datetime(2025, 2, 3, 8, 47, 0, 11924) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:47:30.985 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_3ea8bef8 解析後消息為: id=UUID('bfcc6060-20f2-4a52-803f-61b6038a577e') created_at=datetime.datetime(2025, 2, 3, 8, 47, 0, 11924) updated_at=datetime.datetime(2025, 2, 3, 8, 47, 0, 11924) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:47:32.471 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:47:35.085 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:47:43.712 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:47:44.167 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:47:45.266 [INFO] [python_ana_process_manager] Current Spark memory usage: 638.03MB
2025-02-03 08:47:45.267 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:47:45.415 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:47:47.114 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:47:47.454 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:47:47.490 [INFO] [python_ana_process_manager] 提交任務 9bebb433-cd3b-412b-825c-c70a0e40da1f: _muti_process_run_test
2025-02-03 08:47:48.925 [INFO] [python_ana_process_manager] 任務 9bebb433-cd3b-412b-825c-c70a0e40da1f 完成
2025-02-03 08:47:48.926 [INFO] [python_ana_process_manager] 任務 9bebb433-cd3b-412b-825c-c70a0e40da1f 完成，執行時間: 1.44秒
2025-02-03 08:48:00.034 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_3ea8bef8 收到消息，開始解析
2025-02-03 08:48:00.037 [INFO] [python_ana_process_manager] id=UUID('952b8abd-0107-4703-a827-9aa83ff87765') created_at=datetime.datetime(2025, 2, 3, 8, 48, 0, 1858) updated_at=datetime.datetime(2025, 2, 3, 8, 48, 0, 1858) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:48:00.038 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_3ea8bef8 解析後消息為: id=UUID('952b8abd-0107-4703-a827-9aa83ff87765') created_at=datetime.datetime(2025, 2, 3, 8, 48, 0, 1858) updated_at=datetime.datetime(2025, 2, 3, 8, 48, 0, 1858) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:48:01.116 [INFO] [python_ana_process_manager] Current Spark memory usage: 647.24MB
2025-02-03 08:48:01.117 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:48:01.254 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:48:04.117 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:48:04.307 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:48:05.485 [INFO] [python_ana_process_manager] Current Spark memory usage: 853.26MB
2025-02-03 08:48:05.486 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:48:05.631 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:48:06.434 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:48:06.649 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:48:06.685 [INFO] [python_ana_process_manager] 提交任務 beb6eade-aef7-4964-8e8a-f5e736b4e4a4: _muti_process_run_test
2025-02-03 08:48:08.162 [INFO] [python_ana_process_manager] 任務 beb6eade-aef7-4964-8e8a-f5e736b4e4a4 完成
2025-02-03 08:48:08.163 [INFO] [python_ana_process_manager] 任務 beb6eade-aef7-4964-8e8a-f5e736b4e4a4 完成，執行時間: 1.48秒
2025-02-03 08:49:00.036 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_3ea8bef8 收到消息，開始解析
2025-02-03 08:49:00.038 [INFO] [python_ana_process_manager] id=UUID('1988fd38-4c24-42bf-a773-f2ff47bbfcdc') created_at=datetime.datetime(2025, 2, 3, 8, 49, 0, 1443) updated_at=datetime.datetime(2025, 2, 3, 8, 49, 0, 1443) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:49:00.040 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_3ea8bef8 解析後消息為: id=UUID('1988fd38-4c24-42bf-a773-f2ff47bbfcdc') created_at=datetime.datetime(2025, 2, 3, 8, 49, 0, 1443) updated_at=datetime.datetime(2025, 2, 3, 8, 49, 0, 1443) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:49:01.134 [INFO] [python_ana_process_manager] Current Spark memory usage: 828.48MB
2025-02-03 08:49:01.134 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:49:01.268 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:49:03.804 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:49:04.300 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:49:05.469 [INFO] [python_ana_process_manager] Current Spark memory usage: 853.80MB
2025-02-03 08:49:05.470 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:49:05.606 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:49:06.374 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:49:06.639 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:49:06.669 [INFO] [python_ana_process_manager] 提交任務 db805e81-9ff5-4790-967f-0a0c999632f0: _muti_process_run_test
2025-02-03 08:49:06.677 [INFO] [python_ana_process_manager] 任務 db805e81-9ff5-4790-967f-0a0c999632f0 完成
2025-02-03 08:49:06.678 [INFO] [python_ana_process_manager] 任務 db805e81-9ff5-4790-967f-0a0c999632f0 完成，執行時間: 0.01秒
2025-02-03 08:50:00.032 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_3ea8bef8 收到消息，開始解析
2025-02-03 08:50:00.035 [INFO] [python_ana_process_manager] id=UUID('22bfc081-9d82-4197-bfd7-f438a972b5ff') created_at=datetime.datetime(2025, 2, 3, 8, 50, 0, 1685) updated_at=datetime.datetime(2025, 2, 3, 8, 50, 0, 1685) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:50:00.036 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_3ea8bef8 解析後消息為: id=UUID('22bfc081-9d82-4197-bfd7-f438a972b5ff') created_at=datetime.datetime(2025, 2, 3, 8, 50, 0, 1685) updated_at=datetime.datetime(2025, 2, 3, 8, 50, 0, 1685) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:50:01.236 [INFO] [python_ana_process_manager] Current Spark memory usage: 835.08MB
2025-02-03 08:50:01.237 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:50:01.370 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:50:03.869 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:50:04.411 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:50:05.585 [INFO] [python_ana_process_manager] Current Spark memory usage: 920.20MB
2025-02-03 08:50:05.585 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:50:05.724 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:50:06.494 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:50:06.725 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:50:06.758 [INFO] [python_ana_process_manager] 提交任務 feef2fd7-ff03-4c5d-9310-8d90df2c2c6d: _muti_process_run_test
2025-02-03 08:50:06.763 [INFO] [python_ana_process_manager] 任務 feef2fd7-ff03-4c5d-9310-8d90df2c2c6d 完成
2025-02-03 08:50:06.763 [INFO] [python_ana_process_manager] 任務 feef2fd7-ff03-4c5d-9310-8d90df2c2c6d 完成，執行時間: 0.01秒
2025-02-03 08:51:08.109 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 3
2025-02-03 08:51:13.110 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_aedfadb0 開始消費隊列 full_backtest
2025-02-03 08:51:13.111 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_aedfadb0 線程已啟動
2025-02-03 08:51:13.112 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_fe6bac4e 開始消費隊列 pre_process_stock_data
2025-02-03 08:51:13.112 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_fe6bac4e 線程已啟動
2025-02-03 08:51:13.112 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_4ea46cb0 開始消費隊列 back_testing
2025-02-03 08:51:13.112 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_4ea46cb0 線程已啟動
2025-02-03 08:51:18.099 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 收到消息，開始解析
2025-02-03 08:51:18.101 [INFO] [python_ana_process_manager] id=UUID('df61a2f4-703c-459f-9bae-5af5baac6c42') created_at=datetime.datetime(2025, 2, 3, 8, 51, 0, 2352) updated_at=datetime.datetime(2025, 2, 3, 8, 51, 0, 2352) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:51:18.102 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 解析後消息為: id=UUID('df61a2f4-703c-459f-9bae-5af5baac6c42') created_at=datetime.datetime(2025, 2, 3, 8, 51, 0, 2352) updated_at=datetime.datetime(2025, 2, 3, 8, 51, 0, 2352) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:51:20.115 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:51:22.847 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:51:32.072 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:51:32.464 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:51:33.306 [INFO] [python_ana_process_manager] Current Spark memory usage: 734.31MB
2025-02-03 08:51:33.307 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:51:33.448 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:51:34.813 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:51:34.973 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:51:34.997 [INFO] [python_ana_process_manager] 提交任務 d5122cf4-c223-4131-b0f7-1a398dea4d59: _muti_process_run_test
2025-02-03 08:51:35.830 [INFO] [python_ana_process_manager] 任務 d5122cf4-c223-4131-b0f7-1a398dea4d59 完成
2025-02-03 08:51:35.831 [INFO] [python_ana_process_manager] 任務 d5122cf4-c223-4131-b0f7-1a398dea4d59 完成，執行時間: 0.83秒
2025-02-03 08:52:00.033 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 收到消息，開始解析
2025-02-03 08:52:00.034 [INFO] [python_ana_process_manager] id=UUID('1a2c73b4-06ba-4e32-9896-ca3eac01e1d7') created_at=datetime.datetime(2025, 2, 3, 8, 52, 0, 2745) updated_at=datetime.datetime(2025, 2, 3, 8, 52, 0, 2745) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:52:00.036 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 解析後消息為: id=UUID('1a2c73b4-06ba-4e32-9896-ca3eac01e1d7') created_at=datetime.datetime(2025, 2, 3, 8, 52, 0, 2745) updated_at=datetime.datetime(2025, 2, 3, 8, 52, 0, 2745) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:52:00.964 [INFO] [python_ana_process_manager] Current Spark memory usage: 698.32MB
2025-02-03 08:52:00.964 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:52:01.095 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:52:03.724 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:52:04.163 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:52:05.004 [INFO] [python_ana_process_manager] Current Spark memory usage: 804.37MB
2025-02-03 08:52:05.004 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:52:05.139 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:52:05.787 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:52:06.152 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:52:06.173 [INFO] [python_ana_process_manager] 提交任務 804d7fb7-e97c-468f-8e3e-f1c3cb9de584: _muti_process_run_test
2025-02-03 08:52:07.032 [INFO] [python_ana_process_manager] 任務 804d7fb7-e97c-468f-8e3e-f1c3cb9de584 完成
2025-02-03 08:52:07.032 [INFO] [python_ana_process_manager] 任務 804d7fb7-e97c-468f-8e3e-f1c3cb9de584 完成，執行時間: 0.86秒
2025-02-03 08:53:00.035 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 收到消息，開始解析
2025-02-03 08:53:00.037 [INFO] [python_ana_process_manager] id=UUID('236fc026-f06b-4359-845c-e62f1f7f35e0') created_at=datetime.datetime(2025, 2, 3, 8, 53, 0, 2959) updated_at=datetime.datetime(2025, 2, 3, 8, 53, 0, 2959) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:53:00.038 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 解析後消息為: id=UUID('236fc026-f06b-4359-845c-e62f1f7f35e0') created_at=datetime.datetime(2025, 2, 3, 8, 53, 0, 2959) updated_at=datetime.datetime(2025, 2, 3, 8, 53, 0, 2959) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:53:00.881 [INFO] [python_ana_process_manager] Current Spark memory usage: 723.49MB
2025-02-03 08:53:00.882 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:53:01.026 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:53:03.514 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:53:04.065 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:53:05.160 [INFO] [python_ana_process_manager] Current Spark memory usage: 804.50MB
2025-02-03 08:53:05.160 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:53:05.282 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:53:05.884 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:53:06.293 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:53:06.313 [INFO] [python_ana_process_manager] 提交任務 20d7fa27-184b-45ac-8aa7-62d01df84d29: _muti_process_run_test
2025-02-03 08:53:07.160 [INFO] [python_ana_process_manager] 任務 20d7fa27-184b-45ac-8aa7-62d01df84d29 完成
2025-02-03 08:53:07.160 [INFO] [python_ana_process_manager] 任務 20d7fa27-184b-45ac-8aa7-62d01df84d29 完成，執行時間: 0.85秒
2025-02-03 08:54:00.032 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 收到消息，開始解析
2025-02-03 08:54:00.034 [INFO] [python_ana_process_manager] id=UUID('302d5dc8-a2f1-438d-a396-71e047e5d1f1') created_at=datetime.datetime(2025, 2, 3, 8, 54, 0, 2117) updated_at=datetime.datetime(2025, 2, 3, 8, 54, 0, 2117) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:54:00.034 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 解析後消息為: id=UUID('302d5dc8-a2f1-438d-a396-71e047e5d1f1') created_at=datetime.datetime(2025, 2, 3, 8, 54, 0, 2117) updated_at=datetime.datetime(2025, 2, 3, 8, 54, 0, 2117) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:54:01.185 [INFO] [python_ana_process_manager] Current Spark memory usage: 734.69MB
2025-02-03 08:54:01.186 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:54:01.324 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:54:03.814 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:54:04.386 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:54:05.743 [INFO] [python_ana_process_manager] Current Spark memory usage: 823.14MB
2025-02-03 08:54:05.744 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:54:05.875 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:54:06.536 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:54:06.910 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:54:06.936 [INFO] [python_ana_process_manager] 提交任務 fb903207-db04-47f8-b4a9-b2879d368aef: _muti_process_run_test
2025-02-03 08:54:06.939 [INFO] [python_ana_process_manager] 任務 fb903207-db04-47f8-b4a9-b2879d368aef 完成
2025-02-03 08:54:06.940 [INFO] [python_ana_process_manager] 任務 fb903207-db04-47f8-b4a9-b2879d368aef 完成，執行時間: 0.00秒
2025-02-03 08:55:00.034 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 收到消息，開始解析
2025-02-03 08:55:00.036 [INFO] [python_ana_process_manager] id=UUID('7540766d-bee6-44cc-9701-b540b6106e87') created_at=datetime.datetime(2025, 2, 3, 8, 55, 0, 1371) updated_at=datetime.datetime(2025, 2, 3, 8, 55, 0, 1371) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:55:00.037 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 解析後消息為: id=UUID('7540766d-bee6-44cc-9701-b540b6106e87') created_at=datetime.datetime(2025, 2, 3, 8, 55, 0, 1371) updated_at=datetime.datetime(2025, 2, 3, 8, 55, 0, 1371) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=120, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 46, 14, 417381, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:55:01.201 [INFO] [python_ana_process_manager] Current Spark memory usage: 819.18MB
2025-02-03 08:55:01.201 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:55:01.328 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:55:03.554 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:55:03.876 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:55:04.999 [INFO] [python_ana_process_manager] Current Spark memory usage: 942.86MB
2025-02-03 08:55:04.999 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:55:05.125 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:55:05.764 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:55:06.159 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:55:06.180 [INFO] [python_ana_process_manager] 提交任務 1e5e507e-3915-42c2-8d7f-d6dd3afe119a: _muti_process_run_test
2025-02-03 08:55:06.184 [INFO] [python_ana_process_manager] 任務 1e5e507e-3915-42c2-8d7f-d6dd3afe119a 完成
2025-02-03 08:55:06.185 [INFO] [python_ana_process_manager] 任務 1e5e507e-3915-42c2-8d7f-d6dd3afe119a 完成，執行時間: 0.00秒
2025-02-03 08:57:00.016 [INFO] task : bc9f629a-c0d2-49f3-a099-6806aebdfd06 start download raw data stage
2025-02-03 08:57:00.018 [INFO] 執行 Sync Taiwan Stock Service, date : 20250201, code : 2317
2025-02-03 08:57:00.214 [INFO] taskid : bc9f629a-c0d2-49f3-a099-6806aebdfd06, task name : full_backtest publish msg to processer
2025-02-03 08:57:00.165 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 收到消息，開始解析
2025-02-03 08:57:00.167 [INFO] [python_ana_process_manager] id=UUID('bc9f629a-c0d2-49f3-a099-6806aebdfd06') created_at=datetime.datetime(2025, 2, 3, 8, 57, 0, 12941) updated_at=datetime.datetime(2025, 2, 3, 8, 57, 0, 12941) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=60, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 56, 18, 845712, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 56, 18, 845712, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:57:00.168 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 解析後消息為: id=UUID('bc9f629a-c0d2-49f3-a099-6806aebdfd06') created_at=datetime.datetime(2025, 2, 3, 8, 57, 0, 12941) updated_at=datetime.datetime(2025, 2, 3, 8, 57, 0, 12941) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=60, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 56, 18, 845712, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 56, 18, 845712, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:57:00.979 [INFO] [python_ana_process_manager] Current Spark memory usage: 928.66MB
2025-02-03 08:57:00.980 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:57:01.099 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:57:03.139 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:57:03.648 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:57:04.466 [INFO] [python_ana_process_manager] Current Spark memory usage: 994.25MB
2025-02-03 08:57:04.466 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:57:04.581 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:57:05.108 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:57:05.607 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:57:05.629 [INFO] [python_ana_process_manager] 提交任務 13e24fa1-208d-4a0f-b014-777f344c2ca9: _muti_process_run_test
2025-02-03 08:57:07.109 [INFO] [python_ana_process_manager] 任務 13e24fa1-208d-4a0f-b014-777f344c2ca9 完成
2025-02-03 08:57:07.110 [INFO] [python_ana_process_manager] 任務 13e24fa1-208d-4a0f-b014-777f344c2ca9 完成，執行時間: 1.48秒
2025-02-03 08:57:07.107 [INFO] [python_ana_trader] 任務 13e24fa1-208d-4a0f-b014-777f344c2ca9 完成，執行時間: 1.48秒
2025-02-03 08:58:00.038 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 收到消息，開始解析
2025-02-03 08:58:00.040 [INFO] [python_ana_process_manager] id=UUID('be3a35a7-6d9e-4f28-9411-08589d364db2') created_at=datetime.datetime(2025, 2, 3, 8, 58, 0, 3006) updated_at=datetime.datetime(2025, 2, 3, 8, 58, 0, 3006) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=60, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 56, 18, 845712, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 56, 18, 845712, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-03 08:58:00.041 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_aedfadb0 解析後消息為: id=UUID('be3a35a7-6d9e-4f28-9411-08589d364db2') created_at=datetime.datetime(2025, 2, 3, 8, 58, 0, 3006) updated_at=datetime.datetime(2025, 2, 3, 8, 58, 0, 3006) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=14, n_ema=60, rsi_limit=50, macd_slow=26, macd_fast=12, macd_signal=9) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2024, 7, 2, 16, 56, 18, 845712, tzinfo=TzInfo(+08:00)), end_time=datetime.datetime(2025, 2, 2, 16, 56, 18, 845712, tzinfo=TzInfo(+08:00))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='download_raw_data' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2024-07-02', 'end_time': '2025-02-02'}, 準備開始fullbacktest處理任務
2025-02-03 08:58:01.134 [INFO] [python_ana_process_manager] Current Spark memory usage: 941.71MB
2025-02-03 08:58:01.135 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:58:01.258 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-03 08:58:03.343 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:58:03.816 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:58:04.799 [INFO] [python_ana_process_manager] Current Spark memory usage: 1011.05MB
2025-02-03 08:58:04.800 [INFO] [python_ana_process_manager] Starting session creating
2025-02-03 08:58:04.935 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_parquet_loader
2025-02-03 08:58:05.642 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-03 08:58:05.943 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-03 08:58:05.966 [INFO] [python_ana_process_manager] 提交任務 938df345-c1dd-45fb-9c51-d8b5cf18ae90: _muti_process_run_test
2025-02-03 08:58:10.802 [INFO] [python_ana_process_manager] 任務 938df345-c1dd-45fb-9c51-d8b5cf18ae90 完成
2025-02-03 08:58:10.802 [INFO] [python_ana_process_manager] 任務 938df345-c1dd-45fb-9c51-d8b5cf18ae90 完成，執行時間: 4.84秒
2025-02-03 08:58:10.800 [INFO] [python_ana_trader] 任務 938df345-c1dd-45fb-9c51-d8b5cf18ae90 完成，執行時間: 4.83秒
2025-02-05 05:34:39.122 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 1
2025-02-05 05:34:44.116 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_fcc19391 開始消費隊列 full_backtest
2025-02-05 05:34:44.116 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_fcc19391 線程已啟動
2025-02-05 05:34:44.117 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_85bf9b5a 開始消費隊列 pre_process_stock_data
2025-02-05 05:34:44.117 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_85bf9b5a 線程已啟動
2025-02-05 05:34:44.118 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a00cc50c 開始消費隊列 back_testing
2025-02-05 05:34:44.118 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_a00cc50c 線程已啟動
2025-02-05 08:20:00.073 [INFO] taskid : 4a980120-6cff-4906-bc9b-7f90448af588, task name : full_backtest publish msg to processer
2025-02-05 08:20:00.041 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 收到消息，開始解析
2025-02-05 08:20:00.076 [INFO] [python_ana_process_manager] id=UUID('4a980120-6cff-4906-bc9b-7f90448af588') created_at=datetime.datetime(2025, 2, 5, 8, 20, 0, 4097) updated_at=datetime.datetime(2025, 2, 5, 8, 20, 0, 4097) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-05 08:20:00.081 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 解析後消息為: id=UUID('4a980120-6cff-4906-bc9b-7f90448af588') created_at=datetime.datetime(2025, 2, 5, 8, 20, 0, 4097) updated_at=datetime.datetime(2025, 2, 5, 8, 20, 0, 4097) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-02-05', 'end_time': '2024-08-05'}, 準備開始fullbacktest處理任務
2025-02-05 08:20:01.955 [INFO] [python_ana_process_manager] Starting session creating
2025-02-05 08:20:12.530 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-05 08:20:15.672 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-05 08:20:15.992 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-05 08:20:15.992 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_fcc19391 任務失敗: Failed to load data: empty data set
2025-02-05 08:21:01.470 [INFO] taskid : c90f9e76-3a50-447a-867a-a79f879d471b, task name : full_backtest publish msg to processer
2025-02-05 08:21:01.530 [INFO] taskid : dcdede5d-8c76-4483-8cdc-3835506375e4, task name : full_backtest publish msg to processer
2025-02-05 08:21:01.412 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 收到消息，開始解析
2025-02-05 08:21:01.414 [INFO] [python_ana_process_manager] id=UUID('c90f9e76-3a50-447a-867a-a79f879d471b') created_at=datetime.datetime(2025, 2, 5, 8, 21, 1, 407640) updated_at=datetime.datetime(2025, 2, 5, 8, 21, 1, 407640) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-05 08:21:01.415 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 解析後消息為: id=UUID('c90f9e76-3a50-447a-867a-a79f879d471b') created_at=datetime.datetime(2025, 2, 5, 8, 21, 1, 407640) updated_at=datetime.datetime(2025, 2, 5, 8, 21, 1, 407640) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-02-05', 'end_time': '2024-08-05'}, 準備開始fullbacktest處理任務
2025-02-05 08:21:01.471 [INFO] [python_ana_process_manager] Current Spark memory usage: 369.00MB
2025-02-05 08:21:01.472 [INFO] [python_ana_process_manager] Starting session creating
2025-02-05 08:21:01.622 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-05 08:21:01.779 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-05 08:21:02.125 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-05 08:21:02.125 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_fcc19391 任務失敗: Failed to load data: empty data set
2025-02-05 08:21:02.130 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 收到消息，開始解析
2025-02-05 08:21:02.131 [INFO] [python_ana_process_manager] id=UUID('dcdede5d-8c76-4483-8cdc-3835506375e4') created_at=datetime.datetime(2025, 2, 5, 8, 21, 1, 417377) updated_at=datetime.datetime(2025, 2, 5, 8, 21, 1, 417377) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-05 08:21:02.133 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 解析後消息為: id=UUID('dcdede5d-8c76-4483-8cdc-3835506375e4') created_at=datetime.datetime(2025, 2, 5, 8, 21, 1, 417377) updated_at=datetime.datetime(2025, 2, 5, 8, 21, 1, 417377) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-02-05', 'end_time': '2024-08-05'}, 準備開始fullbacktest處理任務
2025-02-05 08:21:02.190 [INFO] [python_ana_process_manager] Current Spark memory usage: 390.63MB
2025-02-05 08:21:02.190 [INFO] [python_ana_process_manager] Starting session creating
2025-02-05 08:21:02.340 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-05 08:21:02.484 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-05 08:21:02.830 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-05 08:21:02.830 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_fcc19391 任務失敗: Failed to load data: empty data set
2025-02-05 08:22:00.007 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 收到消息，開始解析
2025-02-05 08:22:00.009 [INFO] [python_ana_process_manager] id=UUID('25eb4115-c9cf-4513-b8e6-cac162b4f756') created_at=datetime.datetime(2025, 2, 5, 8, 22, 0, 3296) updated_at=datetime.datetime(2025, 2, 5, 8, 22, 0, 3296) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-05 08:22:00.010 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 解析後消息為: id=UUID('25eb4115-c9cf-4513-b8e6-cac162b4f756') created_at=datetime.datetime(2025, 2, 5, 8, 22, 0, 3296) updated_at=datetime.datetime(2025, 2, 5, 8, 22, 0, 3296) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-02-05', 'end_time': '2024-08-05'}, 準備開始fullbacktest處理任務
2025-02-05 08:22:00.055 [INFO] [python_ana_process_manager] Current Spark memory usage: 412.41MB
2025-02-05 08:22:00.056 [INFO] [python_ana_process_manager] Starting session creating
2025-02-05 08:22:00.202 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-05 08:22:00.341 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-05 08:22:00.701 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-05 08:22:00.701 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_fcc19391 任務失敗: Failed to load data: empty data set
2025-02-05 08:22:00.706 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 收到消息，開始解析
2025-02-05 08:22:00.708 [INFO] [python_ana_process_manager] id=UUID('a7660df9-228e-4471-8fc5-48a9cf157358') created_at=datetime.datetime(2025, 2, 5, 8, 22, 0, 3238) updated_at=datetime.datetime(2025, 2, 5, 8, 22, 0, 3238) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-05 08:22:00.710 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 解析後消息為: id=UUID('a7660df9-228e-4471-8fc5-48a9cf157358') created_at=datetime.datetime(2025, 2, 5, 8, 22, 0, 3238) updated_at=datetime.datetime(2025, 2, 5, 8, 22, 0, 3238) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 19, 41, 852512, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-02-05', 'end_time': '2024-08-05'}, 準備開始fullbacktest處理任務
2025-02-05 08:22:00.790 [INFO] [python_ana_process_manager] Current Spark memory usage: 458.83MB
2025-02-05 08:22:00.791 [INFO] [python_ana_process_manager] Starting session creating
2025-02-05 08:22:00.935 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-05 08:22:01.075 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-05 08:22:01.433 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-05 08:22:01.433 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_fcc19391 任務失敗: Failed to load data: empty data set
2025-02-05 08:23:00.005 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 收到消息，開始解析
2025-02-05 08:23:00.007 [INFO] [python_ana_process_manager] id=UUID('84401d21-4d19-4b81-8fe0-67136d0a6b1f') created_at=datetime.datetime(2025, 2, 5, 8, 23, 0, 2978) updated_at=datetime.datetime(2025, 2, 5, 8, 23, 0, 2978) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-05 08:23:00.008 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_fcc19391 解析後消息為: id=UUID('84401d21-4d19-4b81-8fe0-67136d0a6b1f') created_at=datetime.datetime(2025, 2, 5, 8, 23, 0, 2978) updated_at=datetime.datetime(2025, 2, 5, 8, 23, 0, 2978) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='string' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='string' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 5, 8, 20, 10, 634745, tzinfo=TzInfo(UTC))) tpsl_name='string' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-02-05', 'end_time': '2024-08-05'}, 準備開始fullbacktest處理任務
2025-02-05 08:23:00.054 [INFO] [python_ana_process_manager] Current Spark memory usage: 441.21MB
2025-02-05 08:23:00.055 [INFO] [python_ana_process_manager] Starting session creating
2025-02-05 08:23:00.197 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-05 08:23:00.340 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-05 08:23:00.694 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-05 08:23:00.694 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_fcc19391 任務失敗: Failed to load data: empty data set
2025-02-05 08:38:01.342 [INFO] taskid : b3a2aa33-f312-4bb3-a438-a8bf924583a7, task name : full_backtest publish msg to processer
2025-02-05 08:39:01.280 [INFO] taskid : caf06897-476c-43e0-a4be-1fe1dea2b3e1, task name : full_backtest publish msg to processer
2025-02-07 06:51:20.471 [INFO] [python_ana_process_manager] 進程池初始化完成，進程數: 4
2025-02-07 06:51:25.460 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_31a6c791 開始消費隊列 full_backtest
2025-02-07 06:51:25.461 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_31a6c791 線程已啟動
2025-02-07 06:51:25.462 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_2cd735c0 開始消費隊列 pre_process_stock_data
2025-02-07 06:51:25.462 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_pre_process_stock_data_2cd735c0 線程已啟動
2025-02-07 06:51:25.463 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_c2e53ece 開始消費隊列 back_testing
2025-02-07 06:51:25.463 [INFO] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_back_testing_c2e53ece 線程已啟動
2025-02-07 06:51:56.234 [INFO] [create backtest scheduler] successed
2025-02-07 06:52:00.066 [INFO] taskid : b9778123-d62e-4ed6-ba23-e2b19b516518, task name : full_backtest publish msg to processer
2025-02-07 06:52:00.022 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_31a6c791 收到消息，開始解析
2025-02-07 06:52:00.030 [INFO] [python_ana_process_manager] id=UUID('b9778123-d62e-4ed6-ba23-e2b19b516518') created_at=datetime.datetime(2025, 2, 7, 6, 52, 0, 2713) updated_at=datetime.datetime(2025, 2, 7, 6, 52, 0, 2713) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 7, 6, 51, 56, 207395, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 7, 6, 51, 56, 207395, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-07 06:52:00.032 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_31a6c791 解析後消息為: id=UUID('b9778123-d62e-4ed6-ba23-e2b19b516518') created_at=datetime.datetime(2025, 2, 7, 6, 52, 0, 2713) updated_at=datetime.datetime(2025, 2, 7, 6, 52, 0, 2713) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 7, 6, 51, 56, 207395, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 7, 6, 51, 56, 207395, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-02-07', 'end_time': '2024-08-07'}, 準備開始fullbacktest處理任務
2025-02-07 06:52:01.498 [INFO] [python_ana_process_manager] Starting session creating
2025-02-07 06:52:11.190 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-07 06:52:14.150 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-07 06:52:14.670 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-07 06:52:14.670 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_31a6c791 任務失敗: Failed to load data: empty data set
2025-02-07 06:52:54.220 [INFO] [list all backtest scheduler] successed
2025-02-07 06:53:00.006 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_31a6c791 收到消息，開始解析
2025-02-07 06:53:00.008 [INFO] [python_ana_process_manager] id=UUID('ed9743e7-673c-4520-9106-24e5128f12f6') created_at=datetime.datetime(2025, 2, 7, 6, 53, 0, 1991) updated_at=datetime.datetime(2025, 2, 7, 6, 53, 0, 1991) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 7, 6, 51, 56, 207395, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 7, 6, 51, 56, 207395, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=None set_params=None
2025-02-07 06:53:00.010 [INFO] [python_ana_process_manager] Consumer pkg.rabbitmq.consumer_full_backtest_31a6c791 解析後消息為: id=UUID('ed9743e7-673c-4520-9106-24e5128f12f6') created_at=datetime.datetime(2025, 2, 7, 6, 53, 0, 1991) updated_at=datetime.datetime(2025, 2, 7, 6, 53, 0, 1991) status=<TaskEventStatus.TaskStatusRunning: 'running'> tester_name='default' tester_params=TesterParams(n_rsi=0, n_ema=0, rsi_limit=0, macd_slow=0, macd_fast=0, macd_signal=0) data_provider_name='default' source_meta_data=SourceMetaData(code='2317', candle='d1', start_time=datetime.datetime(2025, 2, 7, 6, 51, 56, 207395, tzinfo=TzInfo(UTC)), end_time=datetime.datetime(2024, 8, 7, 6, 51, 56, 207395, tzinfo=TzInfo(UTC))) tpsl_name='default' tpsl_params=TPSLParms(profit_factor=0.3, loss_factor=-0.2) saver_params=SaverParams(saver_name='minio', saver_base_path=None) trigger_type=<TriggerType.TriggerTypeManual: 'manual'> triggered_by='todo' event_name='full_backtest' event_stage='preprocessing' schedule_id=None schedule_name=None start_time=None end_time=None error_message=None sink_params=SinkParams(location=<SinkLocationType.MINIO: 'minio'>, path=None, minio_config=None) set_params={'code': '2317', 'candle': 'd1', 'start_time': '2025-02-07', 'end_time': '2024-08-07'}, 準備開始fullbacktest處理任務
2025-02-07 06:53:01.069 [INFO] [python_ana_process_manager] Current Spark memory usage: 364.98MB
2025-02-07 06:53:01.069 [INFO] [python_ana_process_manager] Starting session creating
2025-02-07 06:53:01.240 [INFO] [python_ana_process_manager] Ending Created new SparkSession: spark_preprocess
2025-02-07 06:53:01.411 [INFO] [python_ana_process_manager] Starting session cleanup
2025-02-07 06:53:01.729 [INFO] [python_ana_process_manager] ending session cleanup
2025-02-07 06:53:01.730 [ERROR] [python_ana_process_manager] 消費者 pkg.rabbitmq.consumer_full_backtest_31a6c791 任務失敗: Failed to load data: empty data set
2025-02-07 07:00:22.428 [INFO] [list all backtest scheduler] successed
2025-02-07 07:05:15.117 [ERROR] [stop backtest scheduler service] successsed
2025-02-07 07:05:23.827 [INFO] [set backtest scheduler] successed
2025-02-07 07:05:34.220 [INFO] [list all backtest scheduler] successed
2025-02-07 07:05:45.310 [INFO] [set backtest scheduler] successed
2025-02-07 07:48:03.881 [ERROR] [set backtest scheduler] backtest schduler config id:2 not exists
2025-02-07 07:49:08.169 [ERROR] [stop backtest scheduler service] successsed
2025-02-07 07:49:12.557 [ERROR] [set backtest scheduler] backtest schduler config id:2 not exists
2025-02-07 07:51:04.988 [ERROR] [stop backtest scheduler service] successsed
2025-02-07 07:51:10.422 [ERROR] [set backtest scheduler] backtest schduler config id:2 not exists
2025-02-07 07:52:44.272 [ERROR] [stop backtest scheduler service] successsed
2025-02-07 07:52:48.451 [ERROR] [set backtest scheduler] backtest schduler config id:2 not exists
2025-02-07 07:55:18.645 [ERROR] [stop backtest scheduler service] successsed
2025-02-07 07:55:23.332 [ERROR] [set backtest scheduler] backtest schduler config id:2 not exists
2025-02-07 07:57:43.944 [ERROR] [stop backtest scheduler service] successsed
2025-02-07 07:57:50.699 [ERROR] [set backtest scheduler] backtest schduler config id:2 not exists
2025-02-07 08:13:00.266 [ERROR] [stop backtest scheduler service] successsed
2025-02-07 08:13:04.834 [ERROR] [set backtest scheduler] backtest schduler config id:2 not exists
2025-02-07 08:14:01.788 [ERROR] [stop backtest scheduler service] successsed
2025-02-07 08:14:25.831 [ERROR] [set backtest scheduler] backtest schduler config id:2 not exists
2025-02-07 08:14:30.580 [ERROR] [stop backtest scheduler service] successsed
2025-02-08 11:11:00.213 [ERROR] [stop backtest scheduler service] ERROR: relation "backtest_scheduler_task" does not exist (SQLSTATE 42P01)
2025-02-08 11:14:32.195 [ERROR] [stop backtest scheduler service] successsed
